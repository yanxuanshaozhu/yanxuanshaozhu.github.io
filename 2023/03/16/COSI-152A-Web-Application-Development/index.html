<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yanxuanshaozhu.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="尚硅谷 Node.js 教程">
<meta property="og:type" content="article">
<meta property="og:title" content="COSI 152A Web Application Development">
<meta property="og:url" content="https://yanxuanshaozhu.github.io/2023/03/16/COSI-152A-Web-Application-Development/index.html">
<meta property="og:site_name" content="My Blog">
<meta property="og:description" content="尚硅谷 Node.js 教程">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-03-16T16:50:08.000Z">
<meta property="article:modified_time" content="2023-04-17T18:00:18.000Z">
<meta property="article:author" content="Yanxuanshaozhu">
<meta property="article:tag" content="Node.js">
<meta property="article:tag" content="Web Development">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://yanxuanshaozhu.github.io/2023/03/16/COSI-152A-Web-Application-Development/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>COSI 152A Web Application Development | My Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">My Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-portfolio">

    <a href="/portfolio/" rel="section"><i class="fas fa-wallet fa-fw"></i>Portfolio</a>

  </li>
        <li class="menu-item menu-item-memories">

    <a href="/memories/" rel="section"><i class="fas fa-camera fa-fw"></i>Memories</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://yanxuanshaozhu.github.io/2023/03/16/COSI-152A-Web-Application-Development/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Yanxuanshaozhu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          COSI 152A Web Application Development
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-03-16 12:50:08" itemprop="dateCreated datePublished" datetime="2023-03-16T12:50:08-04:00">2023-03-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-04-17 14:00:18" itemprop="dateModified" datetime="2023-04-17T14:00:18-04:00">2023-04-17</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computer-Science/" itemprop="url" rel="index"><span itemprop="name">Computer Science</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>49k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>44 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="尚硅谷-node.js-教程">尚硅谷 Node.js 教程</h1>
<span id="more"></span>
<h2 id="the-fs-module">The <code>fs</code> module</h2>
<ol type="1">
<li>Write content to a file asynchronously <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line">fs.writeFile(<span class="string">&quot;./file1.txt&quot;</span>, <span class="string">&quot;writeContent&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Write Succeeded&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Write content to a file synchronously <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line">fs.writeFileSync(<span class="string">&quot;./file1.txt&quot;</span>, <span class="string">&quot;writeContent&quot;</span>);</span><br></pre></td></tr></table></figure></li>
<li>Append content to a file <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// This is equivalent to fs.writeFile(&#x27;./file1.txt&#x27;, &#x27;\nappendContent&#x27;, &#x27;a&#x27;, (res) =&gt; &#123;...&#125;);</span></span><br><span class="line">fs.appendFile(<span class="string">&quot;./file1.txt&quot;</span>, <span class="string">&quot;\nappendContent&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Error occured&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Append succeeded&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// This is equivalent to fs.writeFileSync(&#x27;./file1.txt&#x27;, &#x27;\nappendContent&#x27;, &#123;options: &#x27;a&#x27;&#125;);</span></span><br><span class="line">fs.appendFileSync(<span class="string">&quot;./file.txt&quot;</span>, <span class="string">&quot;\nappendContent&quot;</span>);</span><br></pre></td></tr></table></figure></li>
<li>Write content stream to a file <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ws = fs.createWriteStream(<span class="string">&quot;./file1.txt&quot;</span>);</span><br><span class="line">ws.write(<span class="string">&quot;writeContent1\n&quot;</span>);</span><br><span class="line">ws.write(<span class="string">&quot;writeContent2\n&quot;</span>);</span><br><span class="line">ws.close();</span><br></pre></td></tr></table></figure></li>
<li>Read content from a file asynchronously <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">&quot;./file1.txt&quot;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Error occured&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// data is a buffer, need toString method to print its content</span></span><br><span class="line">  <span class="built_in">console</span>.log(data.toString());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Read content from a file synchronously <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> data = fs.readFileSync(<span class="string">&quot;./file1.txt&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(data.toString());</span><br></pre></td></tr></table></figure></li>
<li>Read content stream from a file <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rs = fs.createReadStream(<span class="string">&quot;./file1.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">rs.on(<span class="string">&quot;data&quot;</span>, <span class="function">(<span class="params">chunk</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// default chunk size is 65kb</span></span><br><span class="line">  <span class="built_in">console</span>.log(chunk);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">rs.on(<span class="string">&quot;end&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Read finished&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Reanme a file <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line">fs.rename(<span class="string">&quot;./fromPath.txt&quot;</span>, <span class="string">&quot;./toPath.txt&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Rename finished&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Delete a file <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line">fs.unlink(<span class="string">&quot;./file1.txt&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;File deleted&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">fs.unlinkSync(<span class="string">&quot;./file11.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">fs.rm(<span class="string">&quot;./file2.txt&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;File deleted&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">fs.rmSync(<span class="string">&quot;./file22.txt&quot;</span>);</span><br></pre></td></tr></table></figure></li>
<li>Directory operations <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create a directory</span></span><br><span class="line">fs.mkdir(<span class="string">&quot;./dir1&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Directory created&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Recursively create directory</span></span><br><span class="line">fs.mkdir(<span class="string">&quot;./a/b/c&quot;</span>, &#123; <span class="attr">recursive</span>: <span class="literal">true</span> &#125;, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Directory created&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Notice fs.rmdir is deprecated, use fs.rm instead</span></span><br><span class="line"><span class="comment">// Delete an empty directory</span></span><br><span class="line">fs.rmdir(<span class="string">&quot;./dir/b/c&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Directory created&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Recursively delete a directory</span></span><br><span class="line">fs.rmdir(<span class="string">&quot;./dir/b/c&quot;</span>, &#123; <span class="attr">recursive</span>: <span class="literal">true</span> &#125;, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Directory created&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Check resource status <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line">fs.stat(<span class="string">&quot;./fil1.txt&quot;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line">  <span class="comment">// Is target a file</span></span><br><span class="line">  <span class="built_in">console</span>.log(data.isFile());</span><br><span class="line">  <span class="comment">// Is target a directory</span></span><br><span class="line">  <span class="built_in">console</span>.log(data.isDirectory());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>The relative path that <code>fs</code> module uses is not relative
to the path of the node.js file, it is actually relative to the command
line path (the path where you enter the <code>node xxx.js</code>
command). Inorder to fix this bug, you can use absolute path. A trick to
get the absolute path is to use the <code>__dirname</code> variable to
get the absolute path of current folder, so <code>__dirname</code> +
<code>/xxx.js</code> is the absolute path of <code>xxx.js</code>
file</li>
</ol>
<h2 id="the-path-module">The <code>path</code> module</h2>
<ol type="1">
<li>Get formal absolute path with correct delimiter <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// This one works as a valid path, but it is not reabably correct</span></span><br><span class="line"><span class="keyword">const</span> wrongAbsPath = __dirname + <span class="string">&quot;/index.html&quot;</span>;</span><br><span class="line"><span class="comment">// This absolute path has the correct ddelimiters</span></span><br><span class="line"><span class="keyword">const</span> corrAbsPath = path.resolve(__dirname, <span class="string">`./index.html`</span>);</span><br></pre></td></tr></table></figure></li>
<li>Get system separator: <code>path.sep</code></li>
<li>Get the absolute path of the current directory:
<code>__dirname</code></li>
<li>Get the absolute path of the current file:
<code>__filename</code></li>
<li>Get a JSON of the absolute path:
<code>path.parse(pathURL)</code></li>
<li>Get the basic file name: <code>path.basename(pathURL)</code></li>
<li>Get the directory name: <code>path.basename(pathURL)</code></li>
<li>Get the file extension name:
<code>path.basename(pathURL)</code></li>
</ol>
<h2 id="http">HTTP</h2>
<ol type="1">
<li>HTTP request
<ul>
<li>Format: request line + request header lines + request body</li>
<li>Request line: method + URL + HTTP version</li>
<li>Request header: key-value pairs for metadata</li>
<li>Request body: can contain any data</li>
</ul></li>
<li>HTTP response
<ul>
<li>Format: response line + response header lines + response body</li>
<li>Response line: HTTP version + status code + reason phrase</li>
<li>Response header: key-value pairs for metadata</li>
<li>Response body: can contain different types of data</li>
</ul></li>
</ol>
<h2 id="the-http-nodule">The <code>http</code> nodule</h2>
<ol type="1">
<li>Create a simple http server <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// The callback is invoked the the server receives a request</span></span><br><span class="line"><span class="keyword">const</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Display content in utf-8, so some contents like Chinese can be</span></span><br><span class="line">  <span class="comment">// displayed correctly</span></span><br><span class="line">  res.setHeader(<span class="string">&quot;content-type&quot;</span>, <span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">  res.end(<span class="string">&quot;Server response here我们&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// The callback is invoked when the server starts</span></span><br><span class="line">server.listen(<span class="number">9000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Server Started&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Default port for HTTP is 80, default port for HTTPS is 443</li>
<li>Get request method <code>req.method</code></li>
<li>Get URL: <code>req.url</code>, for <code>localhost:9000/test</code>,
this returns <code>/test</code></li>
<li>Get request HTTP version: <code>req.httpVersion</code></li>
<li>Get request header: <code>req.headers</code>, return an object with
all keys in lowercase</li>
<li>Get request body <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> body = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  req.on(<span class="string">&quot;data&quot;</span>, <span class="function">(<span class="params">chunk</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// body += chunk also works, the chunk buffer will be automatically</span></span><br><span class="line">    <span class="comment">// converted to string</span></span><br><span class="line">    body += chunk.toString();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  req.on(<span class="string">&quot;end&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(body);</span><br><span class="line">    res.end(<span class="string">&quot;Server response here&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">9000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Server started&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Get request URL and query string with the <code>url</code> module
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">&quot;url&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// The second argument converts the query from string to object</span></span><br><span class="line">  <span class="keyword">const</span> res = url.parse(req.url, <span class="literal">true</span>);</span><br><span class="line">  <span class="keyword">const</span> pathname = res.pathname;</span><br><span class="line">  <span class="built_in">console</span>.log(pathname);</span><br><span class="line">  <span class="keyword">const</span> value = res.query.key;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">  res.end(<span class="string">&quot;Server response here&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">9000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Server started&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Another way to get query value without use of <code>url</code>
module <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> url = <span class="keyword">new</span> URL(req.url, <span class="string">&quot;http://localhost&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> value = url.searchParams.get(key);</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">9000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Server started&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Set response status code: <code>res.statusCode = xxx</code></li>
<li>Set response status message:
<code>res.statusMessage = xxx</code></li>
<li>Set response header: <code>res.setHeader(key, value)</code>,
multiple values with one key:
<code>res.setHeader(key, [values])</code></li>
<li>Set response body: <code>res.write(content); res.end();</code></li>
<li>Notice <code>let docs = document.getElementsByTagName(name)</code>
returns a <code>HTMLCollection</code> and cannot use
<code>forEach</code> directly, you need to use
<code>Array.from(docs).forEach()</code>
<code>let docs = document.querySelectorAll(name)</code> returns a
<code>NodeList</code> and can use <code>forEach</code> directly</li>
<li>Respond to different file types <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> url = req.url;</span><br><span class="line">  <span class="keyword">if</span> (url === <span class="string">&quot;/&quot;</span>) &#123;</span><br><span class="line">    res.setHeader(<span class="string">&quot;content-type&quot;</span>, <span class="string">&quot;text/html;charset-utf-8;&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> html = fs.readFileSync(__dirname + <span class="string">&quot;/response.html&quot;</span>);</span><br><span class="line">    res.end(html);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (url.includes(<span class="string">&quot;.css&quot;</span>)) &#123;</span><br><span class="line">    <span class="keyword">const</span> css = fs.readFileSync(__dirname + <span class="string">&quot;/style.css&quot;</span>);</span><br><span class="line">    res.end(css);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (url.includes(<span class="string">&quot;.js&quot;</span>)) &#123;</span><br><span class="line">    <span class="keyword">const</span> script = fs.readFileSync(__dirname + <span class="string">&quot;/script.js&quot;</span>);</span><br><span class="line">    res.end(script);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.statusCode = <span class="number">404</span>;</span><br><span class="line">    res.end(<span class="string">&quot;&lt;h1&gt; 404 Not Found.&lt;/h1&gt;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">9000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Server started&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Absolute Path and Relative path
<ul>
<li>Absolute path</li>
<li><code>https://www.google.com</code> directly send request to the
url, used with external links</li>
<li><code>//test.com/web</code> combine URL with current portocol and
then send request, example <code>http://test.com/web</code></li>
<li><code>/test.com/web</code> combine URL with current portocol, server
name, port number and then send request, example
<code>http://localhost:9000/test.com/web</code></li>
<li>Relative path: do calculation first, then send request. You should
use absolute path instead of relative path when possible</li>
</ul></li>
<li>Set MIME(Multipurpose Internet Mail Extensions) type
<ul>
<li>Use file extension to get MIME type <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pathname = url.parse(req.url, <span class="literal">true</span>);</span><br><span class="line"><span class="keyword">const</span> filePath = __dirname + pathname;</span><br><span class="line"><span class="comment">// remote . in the extension name</span></span><br><span class="line"><span class="keyword">const</span> ext = path.extname(filePath).slice(<span class="number">1</span>);</span><br></pre></td></tr></table></figure></li>
<li>Use a map from extension name to MIME types <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> type = mappng[ext];</span><br><span class="line"><span class="keyword">if</span> (type) &#123;</span><br><span class="line">  <span class="comment">// if content type is valid</span></span><br><span class="line">  res.setHeader(<span class="string">&quot;content-type&quot;</span>, type);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">// used for unknown binary files</span></span><br><span class="line">  res.setHeader(<span class="string">&quot;content-type&quot;</span>, <span class="string">&quot;application/octet-stream&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Charset problem
<ul>
<li><code>res.setHeader('content-type', 'test/xxx;charset=utf-8');</code></li>
<li>In html, you can set <code>&lt;meta charset="UTF-8"&gt;</code>. But
response heder has high priority if the mata and response header have
different charsets</li>
<li>You do not need to charsets for stylesheets and scripts, they will
automatically be converted to the same charset as the HTML file by
browser</li>
<li>Handling process <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> type = mapping[ext];</span><br><span class="line"><span class="keyword">if</span> (ext === <span class="string">&quot;html&quot;</span>) &#123;</span><br><span class="line">  type += <span class="string">&quot;;charset=utf-8&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (type) &#123;</span><br><span class="line">  <span class="comment">// if content type is valid</span></span><br><span class="line">  res.setHeader(<span class="string">&quot;content-type&quot;</span>, type);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">// used for unknown binary files</span></span><br><span class="line">  res.setHeader(<span class="string">&quot;content-type&quot;</span>, <span class="string">&quot;application/octet-stream&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Error Handling <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Method not allowed</span></span><br><span class="line"><span class="keyword">if</span> (req.method !== <span class="string">&quot;GET&quot;</span>) &#123;</span><br><span class="line">  res.statusCode = <span class="number">405</span>;</span><br><span class="line">  res.end(<span class="string">&quot;&lt;h1&gt;405 Method Not allowed&lt;/h1&gt;&quot;</span>);</span><br><span class="line">  <span class="comment">// Should have return here</span></span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (err) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (err.code) &#123;</span><br><span class="line">    <span class="comment">// No file or directory</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;ENOENT&quot;</span>:</span><br><span class="line">      res.statusCode = <span class="number">404</span>;</span><br><span class="line">      res.end(<span class="string">&quot;&lt;h1&gt;Resource Not Found&lt;/h1&gt;&quot;</span>);</span><br><span class="line">    <span class="comment">// Operation not allowed</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;ETERM&quot;</span>:</span><br><span class="line">      res.statusCode = <span class="number">403</span>;</span><br><span class="line">      res.end(<span class="string">&quot;&lt;h1&gt;403 Forbidden&lt;/h1&gt;&quot;</span>);</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      res.statusCode = <span class="number">500</span>;</span><br><span class="line">      res.end(<span class="string">&quot;&lt;h1&gt;Server internal error&lt;/h1&gt;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="modularity">Modularity</h2>
<ol type="1">
<li>Export data <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123; a, b &#125;;</span><br><span class="line"><span class="built_in">exports</span>.a = a;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>requirex(xxx)</code> retrieves the <code>module.exports</code>
object in a module</li>
<li>Initially, <code>exports = module.exports = &#123;&#125;</code></li>
<li>Use relative path for user-made module, extension for js file and
json file can be omitted</li>
<li><code>require(directory)</code>
<ol type="1">
<li>Checks the <code>package.json</code>, finds the <code>main</code>
property, and import the corresponding value file</li>
<li>If <code>main</code> property or <code>package.json</code> does not
exist, tries to import <code>index.js</code> and
<code>index.json</code></li>
<li>Raises an error</li>
</ol></li>
<li>Node.js is compatible with CommonJS(<code>require</code> style) and
ECMAScript(<code>import</code> style)</li>
</ul></li>
<li>npm
<ul>
<li><code>npm -v</code>, <code>npm init -y</code>
<code>npm s &lt;name&gt;</code>(search package), you can also search
packages on <code>https://www.npmjs.com/</code>,
<code>npm i &lt;name&gt;@&lt;version&gt;</code>(install package for a
specific version), <code>npm r &lt;name&gt;</code>(remote package)
<code>pack-lock.json</code>(used to hold information about exact package
version number)</li>
<li>For NPM packages, simply write its name in the <code>require</code>
function, this will allow npm to search hierarchically for the package
upward until the root directory of the disk</li>
<li>Some packages are development
dependencies(<code>npm i -S &lt;name&gt;</code>), some packages are
production dependencies(<code>npm i -D &lt;name&gt;</code>)</li>
<li>Global installation: <code>npm i -g &lt;name&gt;</code>, global
uninstallation: <code>npm r -g &lt;name&gt;</code>]</li>
<li>Run scripts: <code>npm run &lt;script-name&gt;</code>, for scripts
with key <code>start</code>, you can simply use
<code>npm start</code></li>
</ul></li>
<li>yarn
<ul>
<li>yarn is a fast, secure and reliable node package manager,
<code>npm i -g yarn</code></li>
<li><code>yarn init -y</code>, <code>yarn add &lt;name&gt;</code>,
<code>yarn</code> (install add required dependencies),
<code>yarn &lt;script-name&gt;</code>,
<code>yarn global install &lt;name&gt;</code>(need to add the global
package folder to the path environment variable)</li>
<li><code>yarn.lock</code> is the lockfile for yarn-managed project</li>
<li>Only use npm or yark for a project, do not mix them together</li>
<li>Package managers
<ul>
<li><code>composer</code> for PHP, <code>pip</code> for Python,
<code>maven</code> for Java, <code>go mod</code> for go,
<code>npm/yarn</code> for JavaScript, <code>rubyGems</code> for
Ruby</li>
<li><code>yum</code> for Centos, <code>apt</code> for Ubuntu,
<code>homebrew</code> for MacOS, <code>chocolatey</code> for
Windows</li>
</ul></li>
</ul></li>
<li>nvm
<ul>
<li>Node Version Manager, used to switch Node.js version</li>
<li><code>nvm install x.x.x</code>, <code>nvm use x.x.x</code>,
<code>nvm uninstall x.x.x</code>, <code>nvm list</code></li>
</ul></li>
</ol>
<h2 id="express.js">Express.js</h2>
<ol type="1">
<li>An example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> port = <span class="number">9000</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">&quot;/&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.end(<span class="string">&quot;&lt;h1&gt; Hello Express.&lt;/h1&gt;&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">&quot;/:id&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> id = req.params[<span class="string">&quot;id&quot;</span>];</span><br><span class="line">  res.end(<span class="string">`&lt;h1&gt;Hello Page <span class="subst">$&#123;id&#125;</span>&lt;/h1&gt;`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(port, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Server started on port <span class="subst">$&#123;port&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Router: <code>router.method(url, callback)</code>, <code>all</code>,
<code>get</code>, <code>post</code>, ...</li>
<li>Request
<ul>
<li>Get some parameters:
<ul>
<li>Native parameters: <code>req.method</code>, <code>req.url</code>,
<code>req.httpVersion</code>, <code>req.headers</code></li>
<li>Express parameters: <code>req.path</code>, <code>req.query</code>,
<code>req.ip</code></li>
</ul></li>
<li>Get URL parameters: <code>req.params[key]</code> or
<code>req.params.key</code></li>
<li>Get Request Body using the <code>body-parser</code>
package(<code>npm i body-parser</code>) <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&quot;body-parser&quot;</span>);</span><br><span class="line">  </span><br><span class="line"><span class="comment">// Define body parse for application/x-www-form-urlencoded data</span></span><br><span class="line"><span class="keyword">const</span> urlencodedParser = bodyParser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">  </span><br><span class="line"><span class="comment">// Use router-level body parser</span></span><br><span class="line"><span class="comment">// After body-parser is executed, there will be a body attribute in the req object,</span></span><br><span class="line"><span class="comment">// then you can access data using req.body.key</span></span><br><span class="line">app.post(<span class="string">&quot;/login&quot;</span>, urlencodedParser, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(req.body);</span><br><span class="line">  res.end();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Response
<ul>
<li>Native parameters: <code>res.statusCode</code>,
<code>res.statusMessage</code>, <code>res.write()</code>,
<code>res.end()</code></li>
<li>Express method: <code>res.send()</code>, this method will
automatically set <code>content-type</code> in response headers</li>
<li><code>res.redirect(url)</code>,
<code>res.download(resourceAbsolutePath)</code>,
<code>res.json(jsonObject)</code>,
<code>res.sendFile(resourceAbsolutePath)</code> you need to set
<code>content-type</code> in header for some file types, otherwise files
like JSON will be downloaded instead of being displayed in the
brwoser</li>
</ul></li>
<li>Middleware
<ul>
<li>Application-level middleware: handle all requests
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> recordMiddleware = <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> &#123; url, ip &#125; = req;</span><br><span class="line">  fs.appendFileSync(</span><br><span class="line">    path.resolve(__dirname, <span class="string">&quot;./accesss.log&quot;</span>),</span><br><span class="line">    <span class="string">`Requested <span class="subst">$&#123;url&#125;</span> from <span class="subst">$&#123;ip&#125;</span> \n`</span></span><br><span class="line">  );</span><br><span class="line">  <span class="comment">// You need to call next function to continue to execute</span></span><br><span class="line">  next();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">app.use(recordMiddleware);</span><br></pre></td></tr></table></figure></li>
<li>Router-level middleware: handle requests to URLs specified by a
router. Can be used for user authentication <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> checkSecret = <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (url.query.secret === <span class="string">&quot;secret&quot;</span>) &#123;</span><br><span class="line">    <span class="comment">// If secret is corret, continue to execute</span></span><br><span class="line">    next();</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.send(<span class="string">&quot;&lt;h1&gt;Wrong secret &lt;/h1&gt;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// When requests is made to /admin, the middleware function is executed first</span></span><br><span class="line">app.get(<span class="string">&quot;/admin&quot;</span>, checkSecret, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.send(<span class="string">&quot;&lt;h1&gt;Admin Page&lt;/h1&gt;&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Built-in middleware for static resources <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.use(express.static(__dirname + <span class="string">&quot;/public&quot;</span>));</span><br></pre></td></tr></table></figure>
<ul>
<li>This middleware will search for <code>index.html</code> that is
directly located inside the public folder, and will use the html to
respond requests to <code>/</code></li>
<li>If you set router to handle requests to <code>/</code>, then it
depends the order that whether your router or the static resource
middleware is executed first</li>
<li>This static resource middleware has nothing to do with the absolute
path in the <code>res.sendFile(path)</code> function, you still need to
specify the absolute paht <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">&quot;/login&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> filePath = path.join(__dirname, <span class="string">&quot;./public/login.html&quot;</span>);</span><br><span class="line">  res.sendFile(filePath);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
<li>Anti-leech protection(防盗链)
<ul>
<li>Resources can only be accessed from the hosting website, and cannot
be accessed from other websites with a link to the original hosting
website</li>
<li>Idea: check the <code>referer</code> attribute in the request
header, only send response when referer is the same as the hosing
website <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> checkReferer = <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// get attribute from request header</span></span><br><span class="line">  <span class="keyword">let</span> referer = req.get(<span class="string">&quot;referer&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (referer) &#123;</span><br><span class="line">    <span class="keyword">let</span> url = <span class="keyword">new</span> URL(referer);</span><br><span class="line">    <span class="keyword">if</span> (url.hostname != <span class="string">&quot;127.0.0.1&quot;</span>) &#123;</span><br><span class="line">      res.statusCode = <span class="number">404</span>;</span><br><span class="line">      res.send(<span class="string">&quot;&lt;h1&gt;404 Not Found&lt;/h1&gt;&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  next();</span><br><span class="line">&#125;;</span><br><span class="line">  </span><br><span class="line">app.use(checkReferer);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Router modularity <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// in homerouter.js</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> router = express.Router();</span><br><span class="line"></span><br><span class="line">router.get(<span class="string">&quot;/home&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> loginPath = path.join(__dirname, <span class="string">&quot;./public/index.html&quot;</span>);</span><br><span class="line">  res.sendFile(loginPath);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.get(<span class="string">&quot;/login&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> loginPath = path.join(__dirname, <span class="string">&quot;./public/login.html&quot;</span>);</span><br><span class="line">  res.sendFile(loginPath);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router;</span><br></pre></td></tr></table></figure> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// in app.js</span></span><br><span class="line"><span class="keyword">const</span> homeRouter = <span class="built_in">require</span>(<span class="string">&quot;./06homerouter&quot;</span>);</span><br><span class="line"></span><br><span class="line">app.use(<span class="string">&quot;/&quot;</span>, homeRouter);</span><br></pre></td></tr></table></figure></li>
<li>EJS template
<ul>
<li>An example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ejs = <span class="built_in">require</span>(<span class="string">&quot;ejs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> country = <span class="string">&quot;United States&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> title = <span class="string">&quot;EJS example&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> template = fs.readFileSync(<span class="string">&quot;./07learn-ejs.ejs&quot;</span>).toString();</span><br><span class="line"><span class="keyword">let</span> result = ejs.render(template, &#123; <span class="attr">title</span>: title, <span class="attr">country</span>: country &#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(result);</span><br></pre></td></tr></table></figure></li>
<li>Control flow: notice that you can use <code>-%&gt;</code> instead of
<code>%&gt;</code> to trim empty lines in the control flow statements
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ejs = <span class="built_in">require</span>(<span class="string">&quot;ejs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arr = [<span class="string">&quot;name1&quot;</span>, <span class="string">&quot;name2&quot;</span>, <span class="string">&quot;name3&quot;</span>, <span class="string">&quot;name4&quot;</span>];</span><br><span class="line"><span class="keyword">const</span> title = <span class="string">&quot;EJS Loop&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> template = fs.readFileSync(<span class="string">&quot;./08ejs-loop.html&quot;</span>).toString();</span><br><span class="line"><span class="keyword">let</span> result = ejs.render(template, &#123; <span class="attr">arr</span>: arr, <span class="attr">title</span>: title &#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(result);</span><br></pre></td></tr></table></figure></li>
<li>Use EJS in express
<ul>
<li>Set template engine:
<code>app.set("view engine", "ejs");</code></li>
<li>Set templates location directory:
<code>app.set("views", path.resolve(__dirname, "./views"));</code>, the
template files should have extension <code>.ejs</code></li>
<li>Render EJS templates
<code>res.render("templatename", dataObject)</code></li>
<li>File hierarchy: for <code>view/auth/auth.js</code>, the render
method should be <code>res.render(auth/auth.js)</code></li>
</ul></li>
</ul></li>
<li>Express application generator
<ul>
<li>Installation: <code>npm i -g express-generator</code></li>
<li>Generate project: <code>express --view=ejs project</code>, or
<code>express -e project</code></li>
<li><strong>The template project uses two middlewares to let you access
body: <code>app.use(express.json());</code> for
<code>application/json</code>, and
<code>app.use(express.urlencoded(&#123; extended: false &#125;));</code> for
<code>application/x-www-form-urlencoded</code>, so you can use
<code>req.body</code> directly</strong></li>
<li>Express port settings
<ul>
<li>Use <code>process.env.PORT</code> or a default port in express
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// the normalizePort method checks if process.env.PORT is a valid number</span></span><br><span class="line"><span class="keyword">const</span> port = normalizePort(process.env.PORT || <span class="string">&#x27;8080&#x27;</span>);</span><br><span class="line">app.set(<span class="string">&#x27;port&#x27;</span>, port);</span><br></pre></td></tr></table></figure></li>
<li>Set environment variables: in Command Prompt:
<code>set PORT=5000</code>, in Power Shell: <code>$env:PORT=5000</code>,
in Bash/Mac <code>export PORT=5000</code></li>
</ul></li>
</ul></li>
<li>File Upload
<ul>
<li>Form attribute for file upload <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- The enctype is required for file upload --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/url&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;portrait&quot;</span>&gt;</span>Image<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;portrait&quot;</span> <span class="attr">name</span>=<span class="string">&quot;portrait&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>Notice the built-in express middleware cannot handle file upload
with <code>enctype=multipart/form-data</code>, you need external
packages to handle multipart like <code>multer</code> or
<code>formidable</code>
<ul>
<li>Logic: when a file is uploaded to the server, the file itself is
saved in the static resource directory on the server, its corresponding
new url is saved into database for future reference</li>
<li>An example using formidable <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> formidable = <span class="built_in">require</span>(<span class="string">&quot;formidable&quot;</span>);</span><br><span class="line"><span class="comment">// Other codes are omitted</span></span><br><span class="line">router.post(<span class="string">&quot;/register&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Create form object</span></span><br><span class="line">  <span class="keyword">const</span> form = formidable(&#123;</span><br><span class="line">    multiples: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// Let the file be uploaded into the following static resource directory</span></span><br><span class="line">    uploadDir: __dirname + <span class="string">&quot;/../public/files&quot;</span>,</span><br><span class="line">    <span class="comment">// Keep file extension</span></span><br><span class="line">    keepExtensions: <span class="literal">true</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  form.parse(req, <span class="function">(<span class="params">err, fields, files</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      next(err);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Get the new file url for future request, this url points to the file location in the static resource directory</span></span><br><span class="line">    <span class="keyword">let</span> url = <span class="string">&quot;/files/&quot;</span> + files.portrait.newFilename;</span><br><span class="line">    res.json(&#123; fields, <span class="attr">url</span>: url &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
<li>The lowdb module
<ul>
<li>A simple to use local JSON databse. Use native JavaScript API to
query. Written in TypeScript</li>
<li>Notice lowdb is now a pure ESM package(the ECMAScript style), in
order to use CommonJS style, use lowdb 1.0.0
<code>npm i lowdb@1.0.0</code></li>
<li>Some methods like <code>write()</code>, <code>push()</code>,
<code>assign()</code>, <code>remove()</code>, ...</li>
</ul></li>
</ol>
<h2 id="mongodb">MongoDB</h2>
<ol type="1">
<li>Introduction
<ul>
<li>database -&gt; collection -&gt; document</li>
<li><code>show dbs</code>, <code>use &lt;db&gt;</code>, <code>db</code>,
<code>db.createCollection(&lt;collection&gt;)</code>,
<code>db.dropDatabase()</code></li>
<li><code>show collections</code>,
<code>db.&lt;collection&gt;.drop</code>,
<code>db.&lt;collection&gt;.renameCollection(&lt;collection&gt;)</code></li>
<li><code>db.&lt;collection&gt;.insert(&lt;document&gt;)</code>,
<code>db.&lt;collection&gt;.find(&lt;condition&gt;)</code>,
<code>db.&lt;collection&gt;.updateOne/updateMany(&lt;condition&gt;, &#123;$set: &lt;new-value&gt;&#125;)</code>,
<code>db.&lt;collection&gt;.deleteOne/deleteMany(&lt;condition&gt;)</code></li>
<li>You can use mongo shell to connect to MongoDB: run
<code>mongosh</code> in cmd, and you will connect to the local MongoDb
database running at <code>localhost:27017</code></li>
</ul></li>
<li>The <code>mongoose</code> module
<ul>
<li>Installation: <code>npm i mongoose --save</code></li>
<li>In mongoose 7.x.x version, support for callback is removed (<a target="_blank" rel="noopener" href="https://github.com/Automattic/mongoose/blob/master/CHANGELOG.md">Reference:
7.0.0-rc0 / 2023-02-23 update</a>), so you need
<code>npm i mongoose@6.10.0</code> in order to use callbacks</li>
<li>An example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">&quot;mongoose&quot;</span>);</span><br><span class="line">      </span><br><span class="line"><span class="keyword">const</span> db = <span class="string">&quot;cosi152&quot;</span>;</span><br><span class="line">mongoose.connect(<span class="string">`mongodb://127.0.0.1:27017/<span class="subst">$&#123;db&#125;</span>`</span>);</span><br><span class="line">      </span><br><span class="line">mongoose.connection.once(<span class="string">&quot;open&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Connected to database&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">      </span><br><span class="line">mongoose.connection.on(<span class="string">&quot;error&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Error occured&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">      </span><br><span class="line">mongoose.connection.on(<span class="string">&quot;close&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Connection terminated&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">      </span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  mongoose.disconnect();</span><br><span class="line">&#125;, <span class="number">2000</span>);</span><br></pre></td></tr></table></figure></li>
<li>Insert document: <code>&lt;Model&gt;.create()</code>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mongoose.connection.on(<span class="string">&quot;open&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Connected to database&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> accountSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">    id: <span class="built_in">Number</span>,</span><br><span class="line">    name: <span class="built_in">String</span>,</span><br><span class="line">    age: <span class="built_in">Number</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">let</span> bookModel = mongoose.model(<span class="string">&quot;accounts&quot;</span>, accountSchema);</span><br><span class="line">  bookModel.create(&#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">name</span>: <span class="string">&quot;Wendy&quot;</span>, <span class="attr">age</span>: <span class="number">22</span> &#125;, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Schema datatype: <code>String</code>, <code>Number</code>,
<code>Boolean</code>, <code>Array</code>, <code>Date</code>,
<code>Buffer(can store binary files, but static resources are commonly stored on the server static resource directory instead)</code>,
<code>Mixed(mongoose.Schema.Types.Mixed)</code>,
<code>ObjectId(commonly used for foreign key)</code>,
<code>Decimal128</code></li>
<li>Mongoose field validation: <code>required: true</code>,
<code>default: &lt;value&gt;</code>,
<code>enum: [...&lt;values&gt;]</code>, <code>unique: true</code>(in
order for unique to have effect, you need to drop and then recreate the
collection)</li>
<li>Delete document:
<code>&lt;Model&gt;.deleteOne(&lt;condition&gt;, &lt;callback&gt;)</code>,
<code>&lt;Model&gt;.deleteMany()</code>, ... <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mongoose.connection.on(<span class="string">&quot;open&quot;</span>,  <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Databse connected to <span class="subst">$&#123;url&#125;</span>`</span>);</span><br><span class="line">  <span class="keyword">const</span> arr = <span class="keyword">await</span> BookModel.find();</span><br><span class="line">  BookModel.deleteOne(&#123; <span class="attr">_id</span>: <span class="string">&quot;6418b5cf5cbd30962f396157&quot;</span> &#125;, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Update document:
<code>&lt;Model&gt;.updateOne(&lt;condition&gt;, &lt;newValue&gt;, &lt;callback&gt;)</code>,
<code>&lt;Model&gt;.updateMany()</code>, ... <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mongoose.connection.on(<span class="string">&quot;open&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Connected to <span class="subst">$&#123;url&#125;</span>`</span>);</span><br><span class="line">  BookModel.updateOne(&#123;<span class="attr">_id</span>: <span class="string">&quot;6418b5cf5cbd30962f396158&quot;</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">&quot;HongLouMeng&quot;</span>&#125;, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Query
document:<code>&lt;Model&gt;.find(&lt;condition&gt;, &lt;callback&gt;)</code>,
<code>&lt;Model&gt;.findById(&lt;id&gt;, &lt;callback&gt;)</code>,
<code>&lt;Model&gt;.findOne(&lt;condition&gt;, &lt;callback&gt;)</code>,
... <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mongoose.connection.on(<span class="string">&quot;open&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Connected to <span class="subst">$&#123;url&#125;</span>`</span>);</span><br><span class="line">  BookModel.findOne(&#123;<span class="attr">_id</span>: <span class="string">&quot;6418b5cf5cbd30962f396158&quot;</span>&#125;, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line">  <span class="built_in">console</span>.log(data.length);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Conditions:
<ul>
<li>Operators: <code>$lt</code>, <code>$gt</code>, <code>$lte</code>,
<code>$gte</code>, <code>$ne</code>,
<code>&#123;price: &#123;$lt: 10&#125;&#125;</code></li>
<li>Logic operators: <code>$or</code>, <code>$and</code>,
<code>&#123; $and: [&#123; price: &#123; $lt: 20 &#125; &#125;, &#123; price: &#123; $gt: 10 &#125; &#125;] &#125;</code></li>
<li>Regular expression: <code>&#123;name: /123/&#125;</code>,
<code>&#123;name: new RegExp("123")&#125;</code> (can be used to match values
passed from variables)</li>
</ul></li>
<li>Customized query
<ul>
<li>Only return specific fields from queries:
<code>BookModel.find().select(field: 1).exec(callback)</code>, only
fields with value 1 in the select method will be returned</li>
<li>Sort results:
<code>BookModel.find().sort(price: 1).exec(callback)</code>,1 means
ascending, -1 means descending</li>
<li>Limit results with offsets:
<code>BookModel.find().sort(price: 0).skip(m).limit(n).exec(callback)</code>,
select n items with top m items skipped</li>
</ul></li>
<li>Modularized mongoose connection <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// config.js</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  dbhost: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">  dbport: <span class="number">27017</span>,</span><br><span class="line">  dbname: <span class="string">&quot;cosi152&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dbConnect.js</span></span><br><span class="line">        </span><br><span class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">&quot;mongoose&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;dbhost, dbport, dbname&#125; = <span class="built_in">require</span>(<span class="string">&quot;./config&quot;</span>);</span><br><span class="line">        </span><br><span class="line"><span class="keyword">const</span> dbConnect = <span class="function">(<span class="params">success, fail</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> db = <span class="string">&quot;cosi152&quot;</span>;</span><br><span class="line">  <span class="keyword">const</span> url = <span class="string">`mongodb://<span class="subst">$&#123;dbhost&#125;</span>:<span class="subst">$&#123;dbport&#125;</span>/<span class="subst">$&#123;db&#125;</span>`</span>;</span><br><span class="line">        </span><br><span class="line">  mongoose.connect(url);</span><br><span class="line">        </span><br><span class="line">  mongoose.connection.on(<span class="string">&quot;open&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Connected to <span class="subst">$&#123;url&#125;</span>`</span>);</span><br><span class="line">    success();</span><br><span class="line">  &#125;);</span><br><span class="line">  mongoose.connection.on(<span class="string">&quot;error&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Error occured&quot;</span>);</span><br><span class="line">    fail();</span><br><span class="line">  &#125;);</span><br><span class="line">  mongoose.connection.on(<span class="string">&quot;close&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Disconnected from <span class="subst">$&#123;url&#125;</span>`</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">        </span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    mongoose.disconnect();</span><br><span class="line">  &#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;;</span><br><span class="line">        </span><br><span class="line"><span class="built_in">module</span>.exports = dbConnect;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// usage.js</span></span><br><span class="line">        </span><br><span class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">&quot;mongoose&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> BookModel = <span class="built_in">require</span>(<span class="string">&quot;./book&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> dbConnect = <span class="built_in">require</span>(<span class="string">&quot;./db&quot;</span>);</span><br><span class="line">        </span><br><span class="line"><span class="keyword">const</span> success = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  BookModel.find(&#123; <span class="attr">price</span>: &#123; <span class="attr">$gt</span>: <span class="number">10</span> &#125; &#125;)</span><br><span class="line">    .select(&#123; <span class="attr">author</span>: <span class="number">1</span>, <span class="attr">price</span>: <span class="number">1</span> &#125;)</span><br><span class="line">    .sort(&#123; <span class="attr">price</span>: <span class="number">1</span> &#125;)</span><br><span class="line">    .limit(<span class="number">3</span>)</span><br><span class="line">    .exec(<span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">        </span><br><span class="line"><span class="keyword">const</span> fail = <span class="function">() =&gt;</span> &#123;&#125;;</span><br><span class="line">        </span><br><span class="line">dbConnect(success, fail);</span><br></pre></td></tr></table></figure> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// book.js</span></span><br><span class="line">        </span><br><span class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">&quot;mongoose&quot;</span>);</span><br><span class="line">        </span><br><span class="line"><span class="keyword">const</span> BookSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">  name: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    required: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  author: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    required: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  price: &#123;</span><br><span class="line">    type: <span class="built_in">Number</span>,</span><br><span class="line">    required: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  is_hot: &#123;</span><br><span class="line">    type: <span class="built_in">Boolean</span>,</span><br><span class="line">    required: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line">        </span><br><span class="line"><span class="keyword">const</span> BookModel = mongoose.model(<span class="string">&quot;novels&quot;</span>, BookSchema);</span><br><span class="line">        </span><br><span class="line"><span class="built_in">module</span>.exports = BookModel;</span><br></pre></td></tr></table></figure></li>
<li>Promise chain <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> movieModel(&#123; <span class="attr">title</span>: <span class="string">&quot;The Wandering Earth 2&quot;</span>, <span class="attr">director</span>: <span class="string">&quot;Fan Guo&quot;</span> &#125;)</span><br><span class="line">  .save()        <span class="comment">// save in the database, return saved document</span></span><br><span class="line">  .then(<span class="function"><span class="params">movie</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Saved movie: <span class="subst">$&#123;movie&#125;</span>`</span>);        <span class="comment">// print saved document</span></span><br><span class="line">    <span class="keyword">return</span> movieModel.findOne(&#123; <span class="attr">title</span>: movie.title &#125;);   <span class="comment">// find a document, return found document</span></span><br><span class="line">  &#125;)                             </span><br><span class="line">  .then(<span class="function"><span class="params">movie</span> =&gt;</span> &#123;                          </span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Found movie:, <span class="subst">$&#123;movie&#125;</span>`</span>);      <span class="comment">// print found document</span></span><br><span class="line">    <span class="keyword">return</span> movieModel.findOneAndUpdate(         <span class="comment">// find a document and update it</span></span><br><span class="line">      &#123; <span class="attr">title</span>: movie.title &#125;,</span><br><span class="line">      &#123; <span class="attr">director</span>: <span class="string">&quot;123&quot;</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">returnDocument</span>: <span class="string">&quot;after&quot;</span> &#125;               <span class="comment">// return updated document rather than the original one</span></span><br><span class="line">    );</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">movie</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Updated movie: ,<span class="subst">$&#123;movie&#125;</span>`</span>);    <span class="comment">// print updated document</span></span><br><span class="line">    <span class="keyword">return</span> movieModel.findOneAndDelete(&#123; <span class="attr">title</span>: movie.title &#125;); <span class="comment">// find a document and delete it, return deleted document</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">movie</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Delete movie: <span class="subst">$&#123;movie&#125;</span>`</span>);     <span class="comment">// print deleted document</span></span><br><span class="line">    <span class="keyword">return</span> movieModel.find();                  <span class="comment">// find all documents in the database</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">results</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Data in the database: <span class="subst">$&#123;results&#125;</span>`</span>);  <span class="comment">// print all documents in the database</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">error</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;Error:&quot;</span>, error));</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Graphical MongoDB Tools
<ul>
<li>Robo 3T</li>
<li>Navicat for MongoDB</li>
<li>MongoDB Atlas</li>
</ul></li>
<li>Convert string to Date: use the <code>moment</code> package
<ul>
<li><code>moment("2023-03-21")</code> convert string to object</li>
<li><code>moment("2023-03-21").toDate()</code> convert object to Date
object</li>
<li><code>moment(new Date()).format("YYYY-MM-DD")</code> convert date to
YYYY-MM-DD format</li>
</ul></li>
<li>Use alert to double confirm deletion <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> btns = <span class="built_in">document</span>.querySelectorAll(<span class="string">&quot;.myDelBtn&quot;</span>);</span><br><span class="line">btns.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">  item.addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// If user clicks yes, then return true, if the user clicks cancel, return false</span></span><br><span class="line">    <span class="keyword">if</span> (confirm(<span class="string">&quot;Do you really want to delete the item?&quot;</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      e.preventDefault();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>API
<ul>
<li>The interface connecting frot-end and back-end</li>
<li>The data interface usually transfers data using JSON</li>
<li>API = method + URL + request parameters + reponse</li>
</ul></li>
<li>RESTful API
<ul>
<li><p>Characteristics</p>
<ul>
<li>URL represent resource</li>
<li>Type of resource operation shoule be the same as request type</li>
<li>Response should contain proper status code</li>
</ul></li>
<li><p>An example</p>
<table>
<colgroup>
<col style="width: 24%">
<col style="width: 20%">
<col style="width: 11%">
<col style="width: 43%">
</colgroup>
<thead>
<tr>
<th style="text-align: left;">Operation</th>
<th style="text-align: left;">Request Method</th>
<th style="text-align: left;">URL</th>
<th style="text-align: left;">Returned Information</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Add a song</td>
<td style="text-align: left;">POST</td>
<td style="text-align: left;">/song</td>
<td style="text-align: left;">Return info of added song</td>
</tr>
<tr>
<td style="text-align: left;">Delete a song</td>
<td style="text-align: left;">DELETE</td>
<td style="text-align: left;">/song/id</td>
<td style="text-align: left;">Return empty document</td>
</tr>
<tr>
<td style="text-align: left;">Modify a song</td>
<td style="text-align: left;">PUT</td>
<td style="text-align: left;">/song/id</td>
<td style="text-align: left;">Return info of updated song</td>
</tr>
<tr>
<td style="text-align: left;">Modify a song</td>
<td style="text-align: left;">PATCH</td>
<td style="text-align: left;">/song/id</td>
<td style="text-align: left;">Return info of updated song</td>
</tr>
<tr>
<td style="text-align: left;">Get all songs</td>
<td style="text-align: left;">GET</td>
<td style="text-align: left;">/song</td>
<td style="text-align: left;">Return info array of all songs</td>
</tr>
<tr>
<td style="text-align: left;">GET a song</td>
<td style="text-align: left;">GET</td>
<td style="text-align: left;">/song/id</td>
<td style="text-align: left;">Return info of a specific song</td>
</tr>
</tbody>
</table></li>
<li><p>The <code>json-server</code> package</p>
<ul>
<li>Get a full fake REST API with zero coding for testing</li>
<li>Usage
<ul>
<li>Install package <code>npm i -g json-server</code></li>
<li>Create a json file called <code>db.json</code>, write your data
structure</li>
<li>Run <code>json-server --watch db.json</code> in command line in the
same directory as the <code>db.json</code> file</li>
<li>The server will start at <code>localhost:3000</code></li>
</ul></li>
</ul></li>
<li><p>API testing tools: apipost, postman</p></li>
<li><p>Add API for project</p>
<ul>
<li>Add an api router</li>
<li>Let the router return json format data</li>
<li>Common JSON format <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;code&quot;</span>: res.statusCode,</span><br><span class="line">    <span class="attr">&quot;msg&quot;</span>: res.statusMessage,</span><br><span class="line">    <span class="attr">&quot;data&quot;</span>: data</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
<li>Session Control
<ul>
<li>Common session control techniques: cookie, session, token</li>
<li>Cookie
<ul>
<li>data saved in browser, same hostname has same cookie, hostname
cookie is wrapped in request header inside <code>cookie</code>
attribute</li>
<li>Cookie is sent from server inside response header
<code>set-cookie</code> attribute, and the browser saved cookie
locally</li>
<li>Use cookie in express:
<ul>
<li><code>res.cookie(key, value)</code>, for multiple cookies, simply
call this method multiple times. Cookies set using the above method
expires when the browser is closed.</li>
<li><code>res.cookie(key, value, &#123;maxAge: &lt;milliseconds&gt;&#125;)</code>,
cookie set in this way only expires when reaches its max age. when you
use browser inspector, the maxAge is displayed in seconds</li>
<li><code>res.clearCookie(key)</code> removes cookie specified by the
key</li>
<li>User <code>cookie-parser</code> to get cookie from request
<ul>
<li>Install <code>npm i cookie-parser</code></li>
<li>An example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cookieParser = <span class="built_in">require</span>(<span class="string">&quot;cookie-parser&quot;</span>);</span><br><span class="line"></span><br><span class="line">app.user(cookieParser);</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Cookies that have not been signed</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;Cookies: &#x27;</span>, req.cookies);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Cookies that have been signed</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;Signed Cookies: &#x27;</span>, req.signedCookies);</span><br><span class="line">  res.json(req.cookies);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">8080</span>)</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
</ul></li>
<li>Session
<ul>
<li>Data saved on the server, can be used for user authentication: when
user tries to login, server compare credentials in the database. If the
info matches, server will create a session object with an unique session
id and save the session object on the server. Then the server will set
session id as cookie inside response header, so for later on user
logins, the server knows user identity</li>
<li>Use session in express and save session to MongoDB
<ul>
<li>Installation: <code>npm i express-session connect-mongo</code>,
express-session stores session in memory by default, we can use
connect-mongo to store the session object into MongoDB</li>
<li>App session configuration <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">app.use(</span><br><span class="line">  session(&#123;</span><br><span class="line">    <span class="comment">// the name of the cookie that server sets in its response</span></span><br><span class="line">    name: <span class="string">&quot;sid&quot;</span>,</span><br><span class="line">    <span class="comment">// the secret used to sign the session id cookie(generate hash session id), can be string or array of strings</span></span><br><span class="line">    secret: <span class="string">&quot;yanxuanshaozhu&quot;</span>,</span><br><span class="line">    <span class="comment">// whether each request should be made a session</span></span><br><span class="line">    saveUninitialized: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// force the session be saved back to the session store, so user credentials are valid</span></span><br><span class="line">    resave: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// save session to MongoDB, the collection name is sessions</span></span><br><span class="line">    store: MongoStore.create(&#123;</span><br><span class="line">      mongoUrl: <span class="string">&quot;mongodb://127.0.0.1:27017/cosi152&quot;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// set options for the cookie in the response</span></span><br><span class="line">    cookie: &#123;</span><br><span class="line">      <span class="comment">// if this is true, then client cannot access the session cookie in the response</span></span><br><span class="line">      httpOnly: <span class="literal">true</span>,</span><br><span class="line">      maxAge:<span class="number">1000</span> * <span class="number">60</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
<li>Let the server set session <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">router.post(<span class="string">&quot;/login&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> &#123; username, password &#125; = req.body;</span><br><span class="line">  userModel.findOne(</span><br><span class="line">    &#123; <span class="attr">username</span>: username, <span class="attr">password</span>: md5(password) &#125;,</span><br><span class="line">    (err, data) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        res.status(<span class="number">500</span>).send(<span class="string">&quot;Registration failed&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (!data) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.send(<span class="string">&quot;Login failed&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// User successfully logined, set session cookie in response</span></span><br><span class="line">      req.session.username = data.username;</span><br><span class="line">      req.session._id = data._id;</span><br><span class="line">      res.render(<span class="string">&quot;success&quot;</span>, &#123;</span><br><span class="line">        msg: <span class="string">&quot;Login success&quot;</span>,</span><br><span class="line">        url: <span class="string">&quot;/account&quot;</span>,</span><br><span class="line">        title: <span class="string">&quot;Success Page&quot;</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Use session to check login status middleware: <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!req.session.username) &#123;</span><br><span class="line">    res.redirect(<span class="string">&quot;/loign&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Do not forget to call next method to continue to execute other logics</span></span><br><span class="line">  next();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
</ul></li>
<li>Password encryption
<ul>
<li>Password should be encrypted before being stored inside the
database</li>
<li>Use <code>md5</code> moduel to do password hashing:
<code>npm i md5</code>,
<code>password = md5(req.body.password)</code></li>
</ul></li>
<li>Protect CSRF
<ul>
<li>Cross-Site Request Forgery (CSRF) is an attack that forces
authenticated users to submit a request to a Web application against
which they are currently authenticated</li>
<li>Example: in website B, it sends a get request to website A with a
cookie from website A, then user logging status can be changed on
website A</li>
<li>How to deal with this: Use <code>POST</code> request instead of
<code>GET</code> request</li>
</ul></li>
<li>token
<ul>
<li>Definition: a encrypted string sent from user to client to identify
client identity</li>
<li>tokent is commonly used in mobile apps for session controls</li>
<li>cookie is automatically included in request header, but a client
needs to manually include tokens inside the header of its requests</li>
<li>Advantage of token
<ul>
<li>Saved on client, so less pressure on the server</li>
<li>Can prevent CSRF</li>
<li>Tokens can be shared among services</li>
</ul></li>
</ul></li>
<li>JWT(JSON Web Token)
<ul>
<li>Enable secure claims between two parties as a JSON object</li>
<li>Use JWT in javascript: <code>npm i jsonwebtoken</code></li>
<li>Logic
<ul>
<li>When client side credentials match records stored in the database,
server will creat a token and send it to client</li>
<li>For later on requests, the token is included in the request and sent
to the server</li>
</ul></li>
</ul></li>
</ol>
<h1 id="尚硅谷其他教程">尚硅谷其他教程</h1>
<h2 id="ajax">AJAX</h2>
<ol type="1">
<li>AJAX Basics
<ul>
<li>Originally AJAX uses XML, now JSON is used more frequently</li>
<li>AJAX GET Example <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">let</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&quot;send&quot;</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">let</span> result = <span class="built_in">document</span>.getElementById(<span class="string">&quot;result&quot;</span>);</span></span><br><span class="line"><span class="javascript">  btn.addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// Create XHR object</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="javascript">    <span class="comment">// Specify request method and request URL</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// If you send get request with query string, modify the request URL</span></span></span><br><span class="line"><span class="javascript">    xhr.open(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;http://127.0.0.1:9000/server?id=1&amp;name=2&quot;</span>);</span></span><br><span class="line"><span class="javascript">    <span class="comment">// Send HTTP request</span></span></span><br><span class="line">    xhr.send();</span><br><span class="line"><span class="javascript">    <span class="comment">// xhr.readystate an integer value representing http request status</span></span></span><br><span class="line"><span class="javascript">    xhr.onreadystatechange = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// all data is returned from the server</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">if</span> (xhr.readyState === <span class="number">4</span>) &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.status &lt; <span class="number">300</span>) &#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(xhr.status);  <span class="comment">// response status</span></span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(xhr.statusText);  <span class="comment">// response status mesage</span></span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(xhr.getAllResponseHeaders); <span class="comment">// response header array</span></span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(xhr.response); <span class="comment">// response body</span></span></span><br><span class="line">          result.innerHTML = xhr.response;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>AJAX POST Example <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">let</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&quot;send&quot;</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">let</span> result = <span class="built_in">document</span>.getElementById(<span class="string">&quot;result&quot;</span>);</span></span><br><span class="line"><span class="javascript">  btn.addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="javascript">    xhr.open(<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;http://127.0.0.1:9000/server&quot;</span>);</span></span><br><span class="line"><span class="javascript">    xhr.setRequestHeader(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json&quot;</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> data =<span class="built_in">JSON</span>.stringify(&#123; <span class="attr">id</span>: <span class="string">&quot;id1&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;name1&quot;</span> &#125;);</span></span><br><span class="line">    xhr.send(data);</span><br><span class="line"><span class="javascript">    <span class="comment">// xhr.readystate an integer value representing http request status</span></span></span><br><span class="line"><span class="javascript">    xhr.onreadystatechange = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// all data is returned from the server</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">if</span> (xhr.readyState === <span class="number">4</span>) &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.status &lt; <span class="number">300</span>) &#123;</span></span><br><span class="line">          result.innerHTML = xhr.responseText;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>Use XHR to set request type:
<code>xhr.setRequestHeader("key", "value")</code></li>
<li>If response data is JSON string, how to deal with it
<ul>
<li>Manunally modify response:
<code>const data = JSON.parse(xhr.response); console.log(data.id);</code></li>
<li>Set response type, then response will be automatically converted to
JSON object:
<code>res.responseType = "json"; console.log(xhr.response.id);</code></li>
</ul></li>
<li>Timeout handling and error handling <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">xhr.timeout = <span class="number">2000</span>;  <span class="comment">// 2000 milliseconds</span></span><br><span class="line">xhr.ontimeout = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  alert(<span class="string">&quot;Request cancelled due to timeout&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">xhr.onerror = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  alert(<span class="string">&quot;Request cancelled due to error&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Cancel request before receiving response:
<code>xhr.abort()</code></li>
<li>Prevent resending the same request: <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> isSending = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">let</span> xhr = <span class="literal">null</span>;</span><br><span class="line"><span class="comment">// Cancel current request</span></span><br><span class="line"><span class="keyword">if</span> (isSending) &#123;</span><br><span class="line">  xhr.abort();</span><br><span class="line">&#125;</span><br><span class="line">xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line"><span class="comment">// Start sending request</span></span><br><span class="line">isSending = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">xhr.onreadystatechange = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">   <span class="keyword">if</span> (xhr.readyState === <span class="number">4</span>) &#123;</span><br><span class="line">      <span class="comment">// Response has been received</span></span><br><span class="line">      isSending = <span class="literal">false</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Use AJAX with jQuery
<ul>
<li>jQuery uses XMLHttpRequest in its implementation</li>
<li>Send GET Request Example:
<code>$.get(url, dataObject, successCallback(data), dataType)</code>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">  $(<span class="string">&quot;button&quot;</span>)</span></span><br><span class="line">    .eq(0)</span><br><span class="line"><span class="javascript">    .click(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">      $.get(</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://127.0.0.1:9000/serverjson&quot;</span>,</span></span><br><span class="line"><span class="javascript">        &#123; <span class="attr">id</span>: <span class="string">&quot;01&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;name1&quot;</span> &#125;,</span></span><br><span class="line">        (data) =&gt; &#123;</span><br><span class="line"><span class="javascript">          $(<span class="string">&quot;.container div&quot;</span>).html(<span class="string">`id: <span class="subst">$&#123;data.id&#125;</span>, name: <span class="subst">$&#123;data.name&#125;</span>`</span>);</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        <span class="string">&quot;json&quot;</span></span></span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>Send POST request example:
<code>$.post(url, dataObject, successCallback(data), dataType)</code>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">  $(<span class="string">&quot;button&quot;</span>)</span></span><br><span class="line">    .eq(1)</span><br><span class="line"><span class="javascript">    .click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      $.post(</span></span><br><span class="line"><span class="javascript">        <span class="string">&quot;http://127.0.0.1:9000/serverjson&quot;</span>,</span></span><br><span class="line"><span class="javascript">        &#123; <span class="attr">id</span>: <span class="string">&quot;01&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;name1&quot;</span> &#125;,</span></span><br><span class="line">        (data) =&gt; &#123;</span><br><span class="line"><span class="javascript">          $(<span class="string">&quot;.container div&quot;</span>).html(<span class="string">`id: <span class="subst">$&#123;data.id&#125;</span>, name: <span class="subst">$&#123;data.name&#125;</span>`</span>);</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        <span class="string">&quot;json&quot;</span></span></span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>Send request using <code>$.ajax(&#123;&#125;)</code> example
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">  $(<span class="string">&quot;button&quot;</span>)</span></span><br><span class="line">    .eq(2)</span><br><span class="line"><span class="javascript">    .click(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">      $.ajax(&#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// url</span></span></span><br><span class="line"><span class="javascript">        url: <span class="string">&quot;http://127.0.0.1:9000/serverjson&quot;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// data</span></span></span><br><span class="line"><span class="javascript">        data: &#123; <span class="attr">id</span>: <span class="string">&quot;01&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;name1&quot;</span> &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// request type</span></span></span><br><span class="line"><span class="javascript">        type: <span class="string">&quot;GET&quot;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// response dataType</span></span></span><br><span class="line"><span class="javascript">        dataType: <span class="string">&quot;json&quot;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// success callback</span></span></span><br><span class="line"><span class="javascript">        success: <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">          $(<span class="string">&quot;.container div&quot;</span>).html(<span class="string">`id: <span class="subst">$&#123;data.id&#125;</span>, name: <span class="subst">$&#123;data.name&#125;</span>`</span>);</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        <span class="comment">//timeout time</span></span></span><br><span class="line">        timeout: 2000,</span><br><span class="line"><span class="javascript">        <span class="comment">// error callback</span></span></span><br><span class="line"><span class="javascript">        error: <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">          alert(<span class="string">&quot;Error occured&quot;</span>);</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        <span class="comment">// request headers</span></span></span><br><span class="line">        headers: &#123;</span><br><span class="line"><span class="javascript">          <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span></span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Use AJAX with axios
<ul>
<li>axios uses XMLHttpRequest in its implementation</li>
<li>Use axios to send GET request:
<code>axios.get(url, &#123;configurations&#125;)</code> <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">  axios.defaults.baseURL = <span class="string">&quot;http://127.0.0.1:9000&quot;</span>;</span></span><br><span class="line"><span class="javascript">  <span class="built_in">document</span>.getElementById(<span class="string">&quot;btn1&quot;</span>).onclick = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line">    axios</span><br><span class="line"><span class="javascript">      .get(<span class="string">&quot;/serverjson&quot;</span>, &#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">//url parameters</span></span></span><br><span class="line">        params: &#123;</span><br><span class="line">          id: 1,</span><br><span class="line"><span class="javascript">          name: <span class="string">&quot;name1&quot;</span>,</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        <span class="comment">// request header</span></span></span><br><span class="line">        headers: &#123;</span><br><span class="line">          id: 2,</span><br><span class="line"><span class="javascript">          name: <span class="string">&quot;name2&quot;</span>,</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        responseType: <span class="string">&quot;json&quot;</span>,</span></span><br><span class="line">      &#125;)</span><br><span class="line"><span class="javascript">      .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;result&quot;</span></span></span><br><span class="line"><span class="javascript">        ).innerHTML = <span class="string">`id: <span class="subst">$&#123;res.data.id&#125;</span>, name: <span class="subst">$&#123;res.data.name&#125;</span>`</span>;</span></span><br><span class="line">      &#125;)</span><br><span class="line"><span class="javascript">      .catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(error);</span></span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>Use axios to send POST request:
<code>axios.post(url, dataObject, &#123;configurations&#125;)</code>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    axios.defaults.baseURL = <span class="string">&quot;http://127.0.0.1:9000&quot;</span>;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.getElementById(<span class="string">&quot;btn2&quot;</span>).onclick = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line">      axios.post(</span><br><span class="line"><span class="javascript">        <span class="string">&quot;/serverjson&quot;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// data</span></span></span><br><span class="line">        &#123;</span><br><span class="line">          id: 1,</span><br><span class="line"><span class="javascript">          name: <span class="string">&quot;name1&quot;</span>,</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">          <span class="comment">// url parameters</span></span></span><br><span class="line">          params: &#123;</span><br><span class="line">            id: 2,</span><br><span class="line"><span class="javascript">            name: <span class="string">&quot;name2&quot;</span>,</span></span><br><span class="line">          &#125;,</span><br><span class="line"><span class="javascript">          <span class="comment">// request headers</span></span></span><br><span class="line">          headers: &#123;</span><br><span class="line">            id: 1,</span><br><span class="line"><span class="javascript">            name: <span class="string">&quot;name1&quot;</span>,</span></span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">    &#125;;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>Use <code>axios</code> to send request: <code>axios(&#123;&#125;)</code>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  axios.defaults.baseURL = <span class="string">&quot;http://127.0.0.1:9000&quot;</span>;</span></span><br><span class="line"><span class="javascript">  <span class="built_in">document</span>.getElementById(<span class="string">&quot;btn3&quot;</span>).onclick = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line">    axios(&#123;</span><br><span class="line"><span class="javascript">      <span class="comment">// request method</span></span></span><br><span class="line"><span class="javascript">      method: <span class="string">&quot;GET&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// request url</span></span></span><br><span class="line"><span class="javascript">      url: <span class="string">&quot;/serverjson&quot;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// url parameters</span></span></span><br><span class="line">      params: &#123;</span><br><span class="line">        id: 1,</span><br><span class="line"><span class="javascript">        name: <span class="string">&quot;name1&quot;</span>,</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="comment">// request headers</span></span></span><br><span class="line">      headers: &#123;</span><br><span class="line">        id: 2,</span><br><span class="line"><span class="javascript">        name: <span class="string">&quot;name2&quot;</span>,</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="comment">// request body data</span></span></span><br><span class="line">      data: &#123;</span><br><span class="line">        id: 3,</span><br><span class="line"><span class="javascript">        name: <span class="string">&quot;name3&quot;</span>,</span></span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"><span class="javascript">      .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;result&quot;</span></span></span><br><span class="line"><span class="javascript">        ).innerHTML = <span class="string">`id: <span class="subst">$&#123;response.data.id&#125;</span>, name: <span class="subst">$&#123;response.data.name&#125;</span>`</span>;</span></span><br><span class="line">      &#125;)</span><br><span class="line"><span class="javascript">      .catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(error);</span></span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Use <code>fetch</code> api
<ul>
<li>Send get request <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">let</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&quot;send&quot;</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">let</span> result = <span class="built_in">document</span>.getElementById(<span class="string">&quot;result&quot;</span>);</span></span><br><span class="line"><span class="javascript">  btn.onclick = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">    fetch(<span class="string">&quot;http://149.28.62.112:3000/server?id=1&amp;name=name&quot;</span>, &#123;</span></span><br><span class="line"><span class="javascript">      method: <span class="string">&quot;GET&quot;</span>,</span></span><br><span class="line">    &#125;)</span><br><span class="line"><span class="javascript">      .then(<span class="function"><span class="params">response</span> =&gt;</span> response.json())</span></span><br><span class="line"><span class="javascript">      .then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        data = <span class="built_in">JSON</span>.parse(data);</span></span><br><span class="line"><span class="javascript">        result.innerHTML = <span class="string">`id: <span class="subst">$&#123;data.id&#125;</span>, name: <span class="subst">$&#123;data.name&#125;</span>`</span></span></span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Same origin policy
<ul>
<li>A browser security policy, portocol, hostname, port should be the
same</li>
<li>By default, ajax should obey the same-origin policy and cannot
access cross-origin resources</li>
<li>Solution 1: Use <code>jsonp</code>
<ul>
<li>Logic: the script tag is allowed to bypass CORS restrictions because
it was designed to enable developers to include JavaScript code from
external sources into their web pages</li>
<li>JSONP(JSON with Padding) is a technique for making cross-domain
requests that bypasses the same-origin policy restrictions implemented
by web browsers</li>
<li>Client: defined a function in the script, let the <code>src</code>
attribute of the script be the get request url. Server: return function
call on response data, the function is the one defined in the
Client</li>
<li>An jsonp example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// server</span></span><br><span class="line">router.get(<span class="string">&quot;/server-jsonp&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;received get request&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> data = &#123;</span><br><span class="line">    status: <span class="number">1</span>,</span><br><span class="line">    msg: <span class="string">&quot;User exists&quot;</span></span><br><span class="line">  &#125;;</span><br><span class="line">  res.send(<span class="string">`handle(<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(data)&#125;</span>)`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure> <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- client --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> input = <span class="built_in">document</span>.getElementById(<span class="string">&quot;name&quot;</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> p = <span class="built_in">document</span>.querySelector(<span class="string">&quot;p&quot;</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> handle = <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">      input.style.border = <span class="string">&quot;solid 2px red&quot;</span>;</span></span><br><span class="line">      p.innerHTML = data.msg;</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="javascript">    input.onblur = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">let</span> username = input.value;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(username);</span></span><br><span class="line"><span class="javascript">      <span class="comment">// Create a script and let it send get request</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">const</span> script = <span class="built_in">document</span>.createElement(<span class="string">&quot;script&quot;</span>);</span></span><br><span class="line"><span class="javascript">      script.src = <span class="string">&quot;http://149.28.62.112:3000/server-jsonp&quot;</span>;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">document</span>.body.appendChild(script);</span></span><br><span class="line">    &#125;;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Solution 2: configure CORS settings on the server side
<ul>
<li>Idea: Cross-Origin Resource Sharing (CORS) is an HTTP-header based
mechanism that allows a server to indicate any origins (domain, scheme,
or port) other than its own from which a browser should permit loading
resources <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// server code</span></span><br><span class="line">res.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">res.setHeader(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">res.setHeader(<span class="string">&quot;Access-Control-Allow-Methods&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">res.setHeader(<span class="string">&quot;Access-Control-Expose-Headers&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
</ol>
<h2 id="promise">Promise</h2>
<ol type="1">
<li>Promise Basics
<ul>
<li>The promise represents the completion or failure of an asynchronous
operation and its resulting value. It was introduced in ES6. Promise or
async/await can be used to prevent callback hell</li>
<li>Callback hell: nested/ multiple layer of callbacks can cause
asynchronouse code become difficult to readand maintain</li>
<li>An example <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> rand = <span class="function">(<span class="params">a, b</span>) =&gt;</span> <span class="built_in">Math</span>.ceil(<span class="built_in">Math</span>.random() * (b - a + <span class="number">1</span>)) + a - <span class="number">1</span>;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> rd1 = <span class="built_in">document</span>.querySelector(<span class="string">&quot;#rd1&quot;</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> rd2 = <span class="built_in">document</span>.querySelector(<span class="string">&quot;#rd2&quot;</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> result = <span class="built_in">document</span>.querySelector(<span class="string">&quot;#result&quot;</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">  rd1.onclick = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">let</span> num = rand(<span class="number">1</span>, <span class="number">100</span>);</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(num);</span></span><br><span class="line"><span class="javascript">      <span class="keyword">if</span> (num &lt;= <span class="number">30</span>) &#123;</span></span><br><span class="line"><span class="javascript">        result.innerHTML = <span class="string">`You win! Num: <span class="subst">$&#123;num&#125;</span>`</span>;</span></span><br><span class="line"><span class="javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">        result.innerHTML = <span class="string">`You loose! Num: <span class="subst">$&#123;num&#125;</span>`</span>;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, 100);</span><br><span class="line">  &#125;;</span><br><span class="line"><span class="javascript">  rd2.onclick = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> num = rand(<span class="number">1</span>, <span class="number">100</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(num);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (num &lt;= <span class="number">30</span>) &#123;</span></span><br><span class="line"><span class="javascript">          <span class="comment">// pass result value</span></span></span><br><span class="line">          resolve(num);</span><br><span class="line"><span class="javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="comment">// pass result value</span></span></span><br><span class="line">          reject(num);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, 100);</span><br><span class="line">    &#125;).then(</span><br><span class="line">      (value) =&gt; &#123;</span><br><span class="line"><span class="javascript">        <span class="comment">// succeed</span></span></span><br><span class="line"><span class="javascript">        result.innerHTML = <span class="string">`You win! Num: <span class="subst">$&#123;value&#125;</span>`</span>;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      (reason) =&gt; &#123;</span><br><span class="line"><span class="javascript">        <span class="comment">// reject</span></span></span><br><span class="line"><span class="javascript">        result.innerHTML = <span class="string">`You win! Num: <span class="subst">$&#123;reason&#125;</span>`</span>;</span></span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><code>fs</code> module promise <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">&quot;./input.txt&quot;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(data.toString());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  fs.readFile(<span class="string">&quot;./input.txt&quot;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      reject(err);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      resolve(data);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;).then(<span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value.toString());</span><br><span class="line">&#125;, <span class="function"><span class="params">reason</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(reason);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>ajax promise <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> rd1 = <span class="built_in">document</span>.querySelector(<span class="string">&quot;#rd1&quot;</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> rd2 = <span class="built_in">document</span>.querySelector(<span class="string">&quot;#rd2&quot;</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> result = <span class="built_in">document</span>.querySelector(<span class="string">&quot;#result&quot;</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">  rd1.onclick = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="javascript">    xhr.open(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;http://127.0.0.1:9000/server&quot;</span>);</span></span><br><span class="line">    xhr.send();</span><br><span class="line"><span class="javascript">    xhr.onreadystatechange = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">if</span> (xhr.readyState === <span class="number">4</span>) &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.readyState &lt; <span class="number">300</span>) &#123;</span></span><br><span class="line">          result.innerHTML = xhr.response;</span><br><span class="line"><span class="javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">          result.innerHTML = <span class="string">&quot;Error&quot;</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">        result.innerHTML = <span class="string">&quot;Error&quot;</span>;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line"><span class="javascript">  rd2.onclick = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">const</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="javascript">      xhr.open(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;http://127.0.0.1:9000/server&quot;</span>);</span></span><br><span class="line">      xhr.send();</span><br><span class="line"><span class="javascript">      xhr.onreadystatechange = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (xhr.readyState === <span class="number">4</span>) &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">if</span> (xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.readyState &lt; <span class="number">300</span>) &#123;</span></span><br><span class="line">            result.innerHTML = xhr.response;</span><br><span class="line"><span class="javascript">          &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">            result.innerHTML = <span class="string">&quot;Error&quot;</span>;</span></span><br><span class="line">          &#125;</span><br><span class="line"><span class="javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">          result.innerHTML = <span class="string">&quot;Error&quot;</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;).then(</span><br><span class="line">      (value) =&gt; &#123;</span><br><span class="line">        result.innerHTML = value;</span><br><span class="line">      &#125;,</span><br><span class="line">      (reason) =&gt; &#123;</span><br><span class="line"><span class="javascript">        result.innerHTML = <span class="string">`Error <span class="subst">$&#123;reason&#125;</span>`</span>;</span></span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><code>util.promisify(callback)</code>, the callback should have the
error-first style, i.e. <code>(err, data) =&gt; &#123;&#125;</code>, this method
returns a version that returns promises <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> util = <span class="built_in">require</span>(<span class="string">&quot;util&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> readFilePromise = util.promisify(fs.readFile);</span><br><span class="line"></span><br><span class="line">readFilePromise(<span class="string">&quot;./input.txt&quot;</span>).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123; <span class="built_in">console</span>.log(data.toString()) &#125;, <span class="function"><span class="params">msg</span> =&gt;</span> &#123; <span class="built_in">console</span>.log(msg); &#125;);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Attributes and Execution logic
<ul>
<li>Three states: <code>pending</code>,
<code>resolved/fullfilled</code>, <code>rejected</code></li>
<li><code>pending</code> =&gt; <code>resolved</code>/
<code>fulfilled</code></li>
<li><code>resolve</code> and <code>reject</code> can modify
PromiseResult</li>
<li>Change promise state: <code>resolve</code>, <code>reject</code>,
<code>throw</code> an error(reject)</li>
<li>Code template <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;&#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">value</span> =&gt;</span> &#123;&#125;, <span class="function"><span class="params">reason</span> =&gt;</span> &#123;&#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">reason</span> =&gt;</span> &#123;&#125;)</span><br></pre></td></tr></table></figure></li>
<li>Execution order
<ul>
<li>If resolve and reject are sync method, they change the promise state
first, then is executed afterwards to handle PromiseResult</li>
<li>If resolve or reject is async method, then waits resolve/reject to
change the promise state, and is executed afterwards to handle
PromiseResult</li>
</ul></li>
<li>The <code>then</code> method
<ul>
<li>Returns a promise, its result depends on the input of then method.
If input callback throws an error, promiseResult of then if error, state
is rejected. If input callback does not returns a promise, promiseResult
of then is return value of input callback, state is resolved. If input
callback returns a callback, it decides the returned promise of the then
method</li>
</ul></li>
<li>If you add <code>catch</code> to the end of a promise chain, then it
will be called when any of the asynchronous function calls fails</li>
<li>How to interrupt promise chain: return a pending promise somewhere
in the chain: <code>return new Promise(() =&gt; &#123;&#125;);</code></li>
</ul></li>
<li>Methods
<ul>
<li><code>Promise.resolve()</code>: if input is not a promise, return
resolved promise whose PromiseResult is input; if input is a promise,
return a promise that has the same state and result as the input
promise</li>
<li><code>Promise.resolve()</code>: return a rejected promise whose
result is input when input is not a promise, or PromiseResult when input
is a promise</li>
<li><code>Promise.all(promises)</code>: if all promises in the input
array is resolved then resolved, otherwise rejected</li>
<li><code>Promise.race(promises)</code>: return result is the same as
the first completed promise</li>
</ul></li>
<li><code>async</code> and <code>await</code>
<ul>
<li><code>async</code> function: returns a promise, the promise state
and promiseResult depends on the returning value of the function. If
returned value is not a promise, returns a resolved promise whose result
is the returned value. If returned value is a promise, the returning
promise behaves the same as the returned promise</li>
<li><code>await RHS</code>: if RHS is not a promise, returns the value
of RHS. If RHS is a promise, await returns the resolved value of the
promise, if the promise is rejected, await throws an error, so it should
be surrounded with try...catch. await should be inside an async
function, but an async function can have no await keyword</li>
</ul></li>
</ol>
<h2 id="es-new-features">ES New Features</h2>
<ol type="1">
<li>ES6
<ul>
<li><code>let</code>: cannot define twice, has block scope, does not
have variable hoisting</li>
<li><code>const</code>: use uppercase word</li>
<li>Destructuring assignment: array, object</li>
<li>String template: <code>$&#123;&#125;</code></li>
<li>Object field <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> y = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> obj = &#123;x, y&#125;; <span class="comment">// same as const obj = &#123;x: x, y: y&#125;;</span></span><br></pre></td></tr></table></figure></li>
<li>Object method <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="function"><span class="title">speak</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Speaking&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// same as speak: () =&gt; &#123;console.log(&quot;Speaking&quot;)&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Arrow function: <code>this</code> in arrow function always points to
the this object where the function is defined, cannot access
<code>arguments</code> object</li>
<li>Function argument default value</li>
<li>Function <code>...args</code> arguments: match an array of
arguments</li>
<li>Spreading operator: <code>...arr</code></li>
<li>Symbol type: symbol is unique, javascript datatype USONB(undefined,
string, symbol, object, null, number, boolean) <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="built_in">Symbol</span>(<span class="string">&quot;xx&quot;</span>);</span><br><span class="line">ley y = <span class="built_in">Symbol</span>(<span class="string">&quot;xx&quot;</span>);</span><br><span class="line">x === y; <span class="comment">// false</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="built_in">Symbol</span>.for(<span class="string">&quot;yy&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> b = <span class="built_in">Symbol</span>.for(<span class="string">&quot;yy&quot;</span>);</span><br><span class="line">a === b; <span class="comment">// true</span></span><br></pre></td></tr></table></figure></li>
<li>Iterator: type that has
iterator(<code>Symbol(Symbol.iterator)</code>) can use
<code>for...of</code> loop, iterator can be used for user-defined
iteration</li>
<li>Generator: a function used for async programming</li>
<li>Set: <code>let x = new Set([items])</code>, <code>s.size</code>,
<code>s.add(x)</code>, <code>s.delete(x)</code>, <code>s.has(x)</code>,
can use <code>for...of</code> loop on set</li>
<li>Map: <code>m.set(key, value)</code>, <code>m.delete(key)</code>,
<code>m.get(key)</code>, can use <code>for...of</code> loop on map</li>
<li>class: instance field/method, static field/method,
<code>extends</code></li>
</ul></li>
</ol>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>Yanxuanshaozhu
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="https://yanxuanshaozhu.github.io/2023/03/16/COSI-152A-Web-Application-Development/" title="COSI 152A Web Application Development">https://yanxuanshaozhu.github.io/2023/03/16/COSI-152A-Web-Application-Development/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Node-js/" rel="tag"># Node.js</a>
              <a href="/tags/Web-Development/" rel="tag"># Web Development</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/03/06/React-Notes/" rel="prev" title="React Notes">
      <i class="fa fa-chevron-left"></i> React Notes
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/03/20/Certificate-Preparation-AWS-Azure/" rel="next" title="Certificate Preparation(AWS/Azure)">
      Certificate Preparation(AWS/Azure) <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B0%9A%E7%A1%85%E8%B0%B7-node.js-%E6%95%99%E7%A8%8B"><span class="nav-number">1.</span> <span class="nav-text">尚硅谷 Node.js 教程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#the-fs-module"><span class="nav-number">1.1.</span> <span class="nav-text">The fs module</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#the-path-module"><span class="nav-number">1.2.</span> <span class="nav-text">The path module</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#http"><span class="nav-number">1.3.</span> <span class="nav-text">HTTP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#the-http-nodule"><span class="nav-number">1.4.</span> <span class="nav-text">The http nodule</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#modularity"><span class="nav-number">1.5.</span> <span class="nav-text">Modularity</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#express.js"><span class="nav-number">1.6.</span> <span class="nav-text">Express.js</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mongodb"><span class="nav-number">1.7.</span> <span class="nav-text">MongoDB</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%85%B6%E4%BB%96%E6%95%99%E7%A8%8B"><span class="nav-number">2.</span> <span class="nav-text">尚硅谷其他教程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ajax"><span class="nav-number">2.1.</span> <span class="nav-text">AJAX</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#promise"><span class="nav-number">2.2.</span> <span class="nav-text">Promise</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#es-new-features"><span class="nav-number">2.3.</span> <span class="nav-text">ES New Features</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Yanxuanshaozhu"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Yanxuanshaozhu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">55</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">54</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/yanxuanshaozhu" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yanxuanshaozhu" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:mrlixm.cn@gmail.com" title="E-Mail → mailto:mrlixm.cn@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yanxuanshaozhu</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="Symbols count total">1.7m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">26:30</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

</body>
</html>
