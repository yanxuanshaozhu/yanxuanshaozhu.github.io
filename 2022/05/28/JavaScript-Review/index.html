<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yanxuanshaozhu.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="What is JavaScript">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaScript Review">
<meta property="og:url" content="https://yanxuanshaozhu.github.io/2022/05/28/JavaScript-Review/index.html">
<meta property="og:site_name" content="My Blog">
<meta property="og:description" content="What is JavaScript">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://yanxuanshaozhu.github.io/images/JSReview/offsetDimension.png">
<meta property="og:image" content="https://yanxuanshaozhu.github.io/images/JSReview/clientDimension.png">
<meta property="og:image" content="https://yanxuanshaozhu.github.io/images/JSReview/scrollDimension.png">
<meta property="article:published_time" content="2022-05-28T18:41:06.000Z">
<meta property="article:modified_time" content="2022-07-24T08:23:13.000Z">
<meta property="article:author" content="Yanxuanshaozhu">
<meta property="article:tag" content="JavaScript">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yanxuanshaozhu.github.io/images/JSReview/offsetDimension.png">

<link rel="canonical" href="https://yanxuanshaozhu.github.io/2022/05/28/JavaScript-Review/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>JavaScript Review | My Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">My Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-portfolio">

    <a href="/portfolio/" rel="section"><i class="fas fa-wallet fa-fw"></i>Portfolio</a>

  </li>
        <li class="menu-item menu-item-memories">

    <a href="/memories/" rel="section"><i class="fas fa-camera fa-fw"></i>Memories</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://yanxuanshaozhu.github.io/2022/05/28/JavaScript-Review/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Yanxuanshaozhu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          JavaScript Review
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-28 14:41:06" itemprop="dateCreated datePublished" datetime="2022-05-28T14:41:06-04:00">2022-05-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-07-24 04:23:13" itemprop="dateModified" datetime="2022-07-24T04:23:13-04:00">2022-07-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computer-Science/" itemprop="url" rel="index"><span itemprop="name">Computer Science</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>199k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>3:01</span>
            </span>
            <div class="post-description">What is JavaScript</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="what-is-javascript">What is JavaScript</h1>
<span id="more"></span>
<ol type="1">
<li>JavaScript was developed in 1995 by Netscape</li>
<li>JavaScript implementation
<ul>
<li>The core: ECMAScript
<ul>
<li>ECMMAScript implements all features described in ECMA-262</li>
<li>ECMA-262 is ECMAScript edition 7</li>
</ul></li>
<li>The Document Object Model(DOM)
<ul>
<li>The DOM is an API for XML that was extended for use in HTML</li>
<li>The DOM maps out an entire page as a hierarchy of nodes</li>
<li>Each part of an HTML or XML page is a type of node containing
different kinds of data</li>
<li>DOM Levels
<ul>
<li>DOM level 1: DOM core (provides a way to map XML-based document to a
hierarchy of nodes), DOM HTML (extends the DOM core)</li>
<li>DOM level 2: introduces DOM views, DOM events, DOM style, DOM
traversal and range</li>
<li>DOM level 3: introduces DOM Load and Save, DOM Validation</li>
</ul></li>
</ul></li>
<li>The Browser Object Model(BOM)
<ul>
<li>BOM allows access and manipulation of the browser window</li>
<li>Primarily, the BOM deals with the browser window and frames, but
generally any browser-specific extension to JavaScript is considered to
be a part of the BOM</li>
</ul></li>
</ul></li>
</ol>
<h1 id="javascript-in-html">JavaScript in HTML</h1>
<ol type="1">
<li>The <code>&lt;script&gt;</code> element
<ul>
<li>Attributes: <code>charset</code>, <code>crossorigin</code>,
<code>src</code>, <code>type=text/javascript</code>, ...</li>
<li>Two ways to use the <code>&lt;script&gt;</code> element: embed
JavaScript code directly into the page or include JavaScript from an
external file</li>
<li>In XHTML, you can write like this:
<code>&lt;script src="example.js"/&gt;</code>, but in HTML, you should
write likt this:
<code>&lt;script src="example.js"&gt; &lt;/script&gt;</code></li>
<li>Tag placement
<ul>
<li>Traditionally, all <code>&lt;script&gt;</code> elements were placed
within the <code>&lt;head&gt;</code> element on a page, the main purpose
of this formant was to keep external file references, both CSS files and
JavaScript files, in the same area. But this format requires all scripts
are loaded before the page begins rendering</li>
<li>Modern web applications typically include all JavaScript references
in the <code>&lt;body&gt;</code> element, after the page content</li>
<li>Deferred scripts: use <code>defer</code> attribute,
<code>&lt;script defer src="example.js"&gt;&lt;/script</code></li>
<li>Asynchronous scripts: use <code>async</code> attribute,
<code>&lt;script async src="example.js"&gt;&lt;/script</code></li>
</ul></li>
<li>Dynamic script loading: use DOM to load scripts dynamically
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> script = <span class="built_in">document</span>.createElement(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">script.src = <span class="string">&#x27;example.js&#x27;</span>;</span><br><span class="line">&lt;!-- Some browser does not support the <span class="keyword">async</span> attribute --&gt;</span><br><span class="line">script.async = <span class="literal">false</span>;</span><br><span class="line"><span class="built_in">document</span>.head.appendChild(script);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Inline code versus external files
<ul>
<li>Generally it's a best practice to include as much JavaScript as
possible using external files</li>
<li>Reasons
<ul>
<li>Maintainability: easier to have a directory for all JavaScript
files</li>
<li>Caching: browser cache all externally linked JavaScript files to
improve performance</li>
<li>Future proof: the syntax is the same in both HTML and XHTML</li>
</ul></li>
</ul></li>
<li>Document modes
<ul>
<li>Quirk mode: layout emulates nonstandard behavior in Navigator 4 and
Internet Explorer 5, this is to support websites that were built before
the widespread adoption of web standards</li>
<li>Fully standards mode: the behavior is the one described by the HTML
and CSS specifications</li>
<li>Almost standards mode: has a lot of the features of standards mode
but isn’t as strict</li>
</ul></li>
<li>The <code>&lt;nonscript&gt;</code> element
<ul>
<li>Some early browser does not support JavaScript, the
<code>&lt;nonscript&gt;</code> element was created to provide alternate
content to browsers without JavaScript</li>
<li><code>&lt;nonscript&gt;</code> element can contain any HTML elements
that can be included in the document <code>&lt;body&gt;</code>, aside
from <code>&lt;script&gt;</code></li>
<li>Any content contained in a <code>&lt;nonscript&gt;</code> element
will be displayed when the browser does not support scripting or the
browser's scripting support is turned off</li>
</ul></li>
</ol>
<h1 id="language-basics">Language Basics</h1>
<ol type="1">
<li>Syntax
<ul>
<li>Case-sensitivity: everything is case-sensitive</li>
<li>Identifiers:
<ul>
<li>Name format
<ul>
<li>First character must be a letter, an underscore, or a dollar
sign</li>
<li>All other characters may be letters, underscores, dollar signs, or
number</li>
</ul></li>
<li>Identifiers use camel case</li>
<li>Keywords, reserved words, true, false and null cannot be used as
identifiers</li>
</ul></li>
<li>Comments
<ul>
<li><code>//</code> single line comment</li>
<li><code>/**/</code> multi-line comment</li>
</ul></li>
<li>Strict mode
<ul>
<li>ECMAScript 5 introduced the strict mode, the strict mode is a
restricted variant of JavaScript, but is not just a subset: it
intentionally has different semantics from normal code</li>
<li>Use strict code for an entire script: add <code>"use strict";</code>
at the top of the script</li>
<li>Specify just a function to execute in strict mode:
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="meta">  &quot;use strict&quot;</span>;</span><br><span class="line">  <span class="comment">// function body</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>All modern browsers support strict mode</li>
</ul></li>
<li>Statements
<ul>
<li>Statements are terminated by a semicolon</li>
<li>A semicolon is not required, but you should always include one</li>
<li>Multiple statements can be combined into a code block using curly
braces</li>
<li>Control statements require code blocks only when executing multiple
statements, but it is considered a best practice to always use code
blocks with control blocks</li>
</ul></li>
</ul></li>
<li>Keywords and reserved words
<ul>
<li>Keywords: <code>typeof</code>, <code>instanceof</code>,
<code>yield</code>, <code>debugger</code>, etc.</li>
<li>Reserved words:
<ul>
<li>Always reserved: <code>enum</code></li>
<li>Reserved in strict mode: <code>implements</code>,
<code>package</code>, <code>public</code>, <code>protected</code>,
<code>private</code>, <code>let</code>, <code>static</code>,
<code>interface</code></li>
<li>Reserved in module code: <code>await</code></li>
</ul></li>
</ul></li>
<li>Variables
<ul>
<li>ECMAScript variables are loosely typed, meaning they can hold any
type of data</li>
<li><code>var</code> is available for all ECMAScript versions,
<code>const</code> and <code>let</code> were introduced in ECMAScript
6</li>
<li><code>var</code> declaration scope: the <code>var</code> operator
defines a variable that is local to the function scope in which it is
defined <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(x); <span class="comment">// 1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(x); <span class="comment">// ReferenceError: x is not defined</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  y = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(y); <span class="comment">// 1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(y); </span><br><span class="line"><span class="comment">// 1, y is seen as a global variable; in strict mode this line throws a ReferenceError </span></span><br></pre></td></tr></table></figure></li>
<li><code>var</code> declaration hoisting: the interpreter pulls all
variable declaration to the top of its scope <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The following two functions are equivalent</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(x); <span class="comment">// undefined</span></span><br><span class="line">  <span class="comment">// Redundant declaration is allowed for var</span></span><br><span class="line">  <span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">var</span> x = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">var</span> x = <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> x;</span><br><span class="line">  <span class="built_in">console</span>.log(x); <span class="comment">// undefined</span></span><br><span class="line">  x = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><code>let</code> declaration
<ul>
<li><code>let</code> is block scoped rather than function scoped</li>
<li>Redundant declaration is not allowed for <code>let</code></li>
<li>There is not declaration hoisting for <code>let</code></li>
<li><code>let</code> does not create properties of the window object
when declared globally</li>
</ul></li>
<li><code>const</code> declaration
<ul>
<li>Similar to <code>let</code>, but it must be initialized with a value
and the value cannot be redefined after declaration</li>
<li>Attempting to modify a <code>const</code> variable will result in a
runtime error</li>
</ul></li>
<li>Declaration styles and best practice
<ul>
<li>Don't use <code>var</code></li>
<li>Prefer <code>cosnt</code> over <code>let</code></li>
</ul></li>
</ul></li>
<li>Date types
<ul>
<li>Six primitive data types in ECMAScript: Undefined, Null, Boolean,
Number, String, and Symbol. One complex data type: Object (unordered
list of name-value pairs)</li>
<li>The <code>typeof</code> operator returns one of the following
things: undefined, boolean, string, number, object, function
(technically, functions are considered objects in ECMAScript), or
symbol</li>
<li>The Undefined type
<ul>
<li>Only one value: <code>undefined</code></li>
<li>When a variable is declared but not initialized, its value is
<code>undefined</code></li>
</ul></li>
<li>The Null type
<ul>
<li>Only one value: <code>null</code></li>
<li><code>undefined</code> is a derivative of <code>null</code>, so
<code>null == undefined</code> is true</li>
</ul></li>
<li>The Boolean type
<ul>
<li>Only two values: <code>true</code> and <code>false</code></li>
<li>Convert to boolean: <code>Boolean(value)</code></li>
</ul></li>
<li>The Number type
<ul>
<li>Octal lateral: <code>0ab</code></li>
<li>Hexadecimal lateral: <code>0xab</code></li>
<li>Floating-point values use approximations</li>
<li>Infinity: <code>Infinity</code>, <code>-Infinity</code>, use
<code>isFinite(value)</code> to check for infinity</li>
<li><code>NaN</code>: not a number
<ul>
<li>Any mathematical operation involves <code>NaN</code> results in
<code>NaN</code></li>
<li><code>NaN == NaN</code> is false</li>
<li>Use <code>isNaN(value)</code> to check for NaN</li>
</ul></li>
<li>Convert to number: <code>Number(value)</code>,
<code>parseInt(value)</code>, <code>parseFloat(value)</code></li>
</ul></li>
<li>The String type
<ul>
<li>String can be delineated by double quotes, single quotes, or
backticks</li>
<li>Strings are immutable</li>
<li>Length of string: <code>value.length</code></li>
<li>Convert to string
<ul>
<li><code>value.toString()</code></li>
<li>When the string is a number, you can pass the radix as the parameter
of <code>toString()</code>: <code>value.toString(radix)</code>
(<code>value.toString(2)</code>, <code>value.toString(8)</code>,
<code>value.toString(16)</code>)</li>
<li><code>String(value)</code></li>
</ul></li>
<li>Template literals: template literals defined using
<code>backticks</code> can span multiple lines</li>
<li>Interpolation: use <code>$&#123;variable&#125;</code> to insert the value of a
variable into a template literal</li>
<li>Raw strings: use <code>String.raw(value)</code> to get raw
strings</li>
</ul></li>
<li>The Symbol type
<ul>
<li>Symbol instances are unique and immutable</li>
<li>The purpose of a symbol is to be a guaranteed unique identifier for
object properties that does not risk property collision</li>
<li>Use <code>Symbol(value)</code> to create a symbol <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x1 = <span class="built_in">Symbol</span>(<span class="string">&#x27;x1&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> x2 = <span class="built_in">Symbol</span>(<span class="string">&#x27;x1&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(x1 === x2); <span class="comment">// false, because symbols are unique</span></span><br><span class="line"><span class="built_in">console</span>.log(x1.description); <span class="comment">// x1 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> num = <span class="keyword">new</span> <span class="built_in">Number</span>();</span><br><span class="line"><span class="keyword">let</span> sym = <span class="built_in">Symbol</span>(); <span class="comment">// You cannot use new keyword to create a symbol</span></span><br></pre></td></tr></table></figure></li>
<li>Use the global symbol registry: <code>Symbol.for(string)</code> to
get a symbol if it exists or create a new one if it doesn't, it's an
idempotent operation
<ul>
<li>Global symbols are not the same as local symbols <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> globalSymbol = <span class="built_in">Symbol</span>.for(<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> localSymbol = <span class="built_in">Symbol</span>(<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(globalSymbol === localSymbol); <span class="comment">// false</span></span><br></pre></td></tr></table></figure></li>
<li>Use <code>Symbol.keyFor(string)</code> to find the global string key
for a global symbol <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> globalSymbol = <span class="built_in">Symbol</span>.for(<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> localSymbol = <span class="built_in">Symbol</span>(<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Symbol</span>.keyFor(globalSymbol)); <span class="comment">// test</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Symbol</span>.keyFor(localSymbol)); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure></li>
<li>Anywhere you can use a string or number property, you can also use a
symbol <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> sym = <span class="built_in">Symbol</span>(<span class="string">&#x27;key&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  [sym]: <span class="string">&#x27;value&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(obj[sym]); <span class="comment">// value</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>There are some built-int symbols in ECMAScript 6 that would be used
to expose internal language behavior for direct access, overriding, or
emulating
<ul>
<li>Example: <code>Symbol.asyncIterator</code>,
<code>Symbol.hasInstance</code>, <code>Symbol.isConcatSpreadable</code>,
<code>Symbol.iterator</code>, <code>Symbol.match</code>,
<code>Symbol.replace</code>, <code>Symbol.search</code>,
<code>Symbol.species</code>, <code>Symbol.split</code>,
<code>Symbol.toPrimitive</code>, <code>Symbol.toStringTag</code>,
<code>Symbol.unscopables</code></li>
</ul></li>
</ul></li>
<li>The Object type
<ul>
<li>If the constructor has no arguments, the parentheses are optional,
but it's recommended to use them: <code>let obj = new Object</code>,
this is correct, but not recommended</li>
<li>Properties and methods
<ul>
<li><code>constructor</code>, <code>hasOwnProperty(propertyName)</code>,
<code>isPrototypeOf(object)</code>,
<code>propertyIsEnumerable(propertyName)</code>,
<code>toLocaleString()</code>, <code>toString()</code>,
<code>valueOf()</code></li>
</ul></li>
</ul></li>
</ul></li>
<li>Operators
<ul>
<li>Unary operators:
<ul>
<li>Increment/decrement: <code>++</code>, <code>--</code>, can be used
on any values
<ul>
<li>For string, convert to number/NaN, and then increment/decrement</li>
<li>For object, use <code>obj.valueOf()</code> to get number/NaN, and
then increment/decrement</li>
</ul></li>
<li>Plus/minus: <code>+</code>, <code>-</code>
<ul>
<li>For string, convert to number/NaN, and then plus/minus</li>
<li>For object, use <code>obj.valueOf()</code> to get number/NaN, and
then plus/minus</li>
</ul></li>
</ul></li>
<li>Bitwise operators: <code>~</code>, <code>&amp;</code>,
<code>|</code>, <code>^</code>, <code>&lt;&lt;</code>,
<code>&gt;&gt;</code>(signed right shift),
<code>&gt;&gt;&gt;</code>(unsigned right shift)</li>
<li>Boolean operators: <code>!</code>, <code>&amp;&amp;</code>,
<code>||</code></li>
<li>Multiplicative operators: <code>*</code>, <code>/</code>,
<code>%</code></li>
<li>Exponentiation operator: <code>**</code></li>
<li>Additive operators: <code>+</code>, <code>-</code></li>
<li>Relational operators: <code>&lt;</code>, <code>&lt;=</code>,
<code>&gt;</code>, <code>&gt;=</code>, <code>instanceof</code>,
<code>in</code>
<ul>
<li>If both are numbers, perform numeric comparison</li>
<li>If both are strings, compare the character codes of each
character</li>
<li>If one is number, convert the other to number, and the perform
numeric comparison</li>
<li>If an object, use <code>valueOf()</code> to get numeric value, if
<code>valueOf()</code> is not available, use <code>toString()</code> to
get string value, and then compare</li>
<li>If one is Boolean, convert it to a number and then compare</li>
</ul></li>
<li>Equality operators: <code>==</code>, <code>！=</code>,
<code>===</code>, <code>！==</code>
<ul>
<li>If one is a boolean, convert it to a number and then compare</li>
<li>If one is a string, the other is a number, convert to string to
number, and then compare</li>
<li>If one is object, use <code>valueOf()</code> to get numeric value,
if <code>valueOf()</code> is not available, use <code>toString()</code>
to get string value, and then compare</li>
<li><code>null == undefined</code> is true</li>
<li><code>NaN == x</code> is false</li>
</ul></li>
<li>Conditional operator:
<code>booleanExpression ? valueIfTrue : valueIfFalse</code></li>
<li>Assignment operators: <code>=</code>, <code>+=</code>,
<code>-=</code>, <code>*=</code>, <code>/=</code>, <code>%=</code>,
<code>&lt;&lt;=</code>, <code>&gt;&gt;=</code>,
<code>&gt;&gt;&gt;=</code>, <code>&amp;=</code>, <code>^=</code>,
<code>|=</code></li>
<li>Comma operator: <code>,</code>
<ul>
<li><code>let x = 1, y = 2;</code></li>
<li><code>let x = (1, 2);</code>, then <code>x = 2</code></li>
</ul></li>
</ul></li>
<li>Statements
<ul>
<li>The <code>if</code> statement</li>
<li>The <code>do-while</code> statement</li>
<li>The <code>while</code> statement</li>
<li>The <code>for</code> statement: initialization, control expression,
and postloop expression are all optional</li>
<li>The <code>for-in</code> statement: used to enumerate the non-symbol
keyed properties of an object</li>
<li>The <code>for-of</code> statement: used to loop through elements in
an iterable object</li>
<li>Labeled statements: <code>label: statement</code>, can be used
together with <code>break</code>, <code>continue</code></li>
<li><code>break</code> and <code>continue</code> statements</li>
<li><code>with</code> statements: sets the scope of the code within a
particular object <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The following two formats are equivalent</span></span><br><span class="line"><span class="keyword">let</span> eq = location.search.substring(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">let</span> hostName = location.hostname;</span><br><span class="line"><span class="keyword">let</span> url = location.href;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">with</span>(<span class="params">location</span>)</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> eq = search.substring(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">let</span> hostName = hostName;</span><br><span class="line">  <span class="keyword">let</span> url = href;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>The <code>switch</code> statement <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span>(expression) &#123;</span><br><span class="line">  <span class="keyword">case</span> value1:</span><br><span class="line">    statement;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> value2:</span><br><span class="line">    statement;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">default</span>:</span><br><span class="line">    statement;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Functions
<ul>
<li>Basic syntax <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">functionName</span>(<span class="params">arg0, arg1, ..., argN</span>) </span>&#123;</span><br><span class="line">  statements;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Functions do not need to specify whether they return a value, any
function can return a value at any time by using the <code>return</code>
statement</li>
<li>Strict mode places several restrictions on functions
<ul>
<li>No function can be named eval or arguments</li>
<li>No named parameter can be named eval or arguments</li>
<li>No two named parameters can have the same name</li>
</ul></li>
</ul></li>
</ol>
<h1 id="variables-scope-and-memory">Variables, Scope, and Memory</h1>
<ol type="1">
<li>Primitive and reference values
<ul>
<li>ECMAScript variables contain two different types of data: primitive
values and reference values</li>
<li>Primitive values are simple atomic pieces of data</li>
<li>Reference values are objects that may be made up of multiple
values</li>
<li>JavaScript does not permit direct access of memory locations, so you
actually work on a reference to the object that you manipulate</li>
<li>Primitive values cannot have properties added to them even though
attempting to do so won't cause an error</li>
<li>Copying values
<ul>
<li>When a primitive value is assigned from one variable to another, the
value stored on the variable object is created and copied into the
location for the new variable</li>
<li>When a reference value is assigned from one variable to another, the
value stored on the variable object is also copied into the location for
the new variable</li>
</ul></li>
<li>Argument passing: all function arguments are passed by value</li>
<li>Determining type
<ul>
<li>If x is null or an object, <code>typeof x</code> returns
<code>object</code></li>
<li>Use <code>x instanceof Type</code> to check if the variable is an
instance of the given reference type, e.g.
<code>person instanceof Object</code></li>
</ul></li>
</ul></li>
<li>Execution context and scope
<ul>
<li>The execution context of a variable or function defines what other
dat it has access to, as well as how it should behave. Each execution
context has an associated variable object upon which all of its defined
variables and functions exist</li>
<li>The global execution context is the outermost one. In web browsers,
the global context is that of the <code>window</code> object</li>
<li>ECMAScript execution flow
<ul>
<li>Each function call has its own execution context</li>
<li>A context stack holds all function contexts</li>
</ul></li>
<li>When code is executed, a scope chain of variable objects is created,
the scope provide ordered access to all variables and functions than an
execution context has access to</li>
<li>Each execution context has an associated variable object upon which
all of its defined variables and functions exist</li>
<li>Scope chain augmentation: in a <code>catch</code> block of a
<code>try-catch</code> statement, or in a <code>with</code> statement, a
temporary addition to the front of the scope chain appears</li>
<li>Identifier lookup
<ul>
<li>Search starts at the front of the scope chain, if target is found in
the local context, then done, otherwise continuing along the scope
chain</li>
<li>The process continues until the global context is done</li>
</ul></li>
</ul></li>
<li>Garbage collection
<ul>
<li>JavaScript is a garbage-collected language, it automatically
allocates what is needed and reclaims memory that is no longer being
used</li>
<li>Idea: figure out which variables aren't going to be used and free
the memory associated with them, run garbage collection
periodically</li>
<li>Two strategies have traditionally been used in browsers:
mark-and-sweep, and reference counting</li>
<li>Mark-and-sweep
<ul>
<li>The most popular JavaScript garbage collection format</li>
<li>Variables are flagged when they are in context</li>
<li>GC procedure
<ul>
<li>The garbage collector marks all variables stored in memory
first</li>
<li>The garbage collector then removes marks off variables that are in
context or referenced by in-context variables</li>
<li>All variables that are still marked are considered ready for
deletion</li>
<li>The garbage collector then does a memory sweep, destroying each of
the marked values and reclaiming the memory associated with them</li>
</ul></li>
</ul></li>
<li>Reference counting
<ul>
<li>Idea: every value keeps track of how many references are made to it,
when the reference count reaches zero, there is no way to reach that
value and it is safe to reclaim the associated memory</li>
<li>A problem with reference counting is that when there are circular
references, the reference count will not be zero even when the objects
are no longer reachable</li>
</ul></li>
<li>Performance
<ul>
<li>GC runs periodically and can slow normal operations down if there
are a large number of variable allocations in memory, so the timing of
GC is important</li>
<li>The best strategy is to organize your code in such a way that it
allows garbage collection to do its job to the best of its ability
whenever it is scheduled to run</li>
</ul></li>
<li>Managing memory
<ul>
<li>Due to GC, developers typically don't have to worry about memory
management</li>
<li>Keeping in the amount of used memory to a minimum leads to better
page performance</li>
<li>The best way to optimize memory usage is to ensure that you only
keep around data that is necessary for the execution of your code. When
data is no longer necessary, it's best to set the value to null</li>
<li>Use const and let declarations to boost performance</li>
<li>Memory leaks
<ul>
<li>One of the most common and easily fixed memory leak is accidentally
declaring global variables</li>
<li>Interval timers can also cause memory leaks</li>
<li>JavaScript closures can also cause memory leaks</li>
</ul></li>
<li>Static allocation and object pools: use object pools to reduce GC
and boost performance</li>
</ul></li>
</ul></li>
</ol>
<h1 id="basic-reference-types">Basic Reference Types</h1>
<ol type="1">
<li>Introduction
<ul>
<li>A reference value/object is an instance of a specific reference
type</li>
</ul></li>
<li>The <code>Date</code> type
<ul>
<li>The <code>Date</code> type stores dates as the number of
milliseconds that have passed since midnight on January 1, 1970 UTC</li>
<li>Now: <code>let now = new Date();</code></li>
<li>Use <code>Date.parse(string)</code> to convert a string to
milliseconds
<ul>
<li>String format: <code>month/date/year</code>,
<code>month_name date, year</code>,
<code>YYYY-MM-DDTHH:mm:ss:sssZ</code>,
<code>day_of_week month_name date year HH:mm:ss time_zone</code></li>
<li>Example: <code>let date = new Date(Date.parse("06/02/2022))</code>,
this is equivalent to <code>let date new Date("06/02/2022")</code></li>
</ul></li>
<li>Use <code>Date.UTC(YYYY, MM, DD, HH, mm, ss)</code> to convert a
string to milliseconds
<ul>
<li>MM is 0 indexed, so January is 0</li>
<li>Example:
<code>let date = new Date(Date.UTC(2022, 5, 2, 12, 0, 0))</code>, this
is equivalent to
<code>let date new Date(2022, 5, 2, 12, 0, 0)</code></li>
<li>During implicit call, <code>Date.parse()</code> creates GMT time,
<code>Date.UTC()</code> creates local time</li>
</ul></li>
<li>Use <code>Date.now()</code> to calculate time difference
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> t1 = <span class="built_in">Date</span>.now();</span><br><span class="line"><span class="comment">// do something</span></span><br><span class="line"><span class="keyword">let</span> t2 = <span class="built_in">Date</span>.now();</span><br><span class="line"><span class="built_in">console</span>.log(t2 - t1);</span><br></pre></td></tr></table></figure></li>
<li>Inherited methods: <code>toLocaleString()</code> does not contain
time zone, <code>toString()</code> contains time zone information,
<code>valueOf()</code> returns the milliseconds</li>
<li>Date-formatting methods: <code>toDateString()</code>,
<code>toTimeString()</code>, <code>toLocaleDateString()</code>,
<code>toLocaleTimeString()</code>, <code>toUTCString()</code></li>
<li>Date/time component methods: <code>getTime()</code> returns
milliseconds, <code>setTime()</code>, <code>getFullYear()</code>,
<code>getMonth()</code>, <code>getDate()</code>, <code>getDay()</code>,
<code>getHours()</code>, <code>getMinutes()</code>,
<code>getSeconds()</code>, <code>getMilliseconds()</code>,
<code>getTimezoneOffset()</code>, ...</li>
</ul></li>
<li><code>RegExp</code>
<ul>
<li>ECMAScript supports regular expression through the
<code>RegExp</code> type</li>
<li>Regular expression syntax: <code>let expr = /pattern/flags</code>
<ul>
<li>flags: <code>g</code>: find all matches instead the first one,
<code>i</code>: case-insensitive mode, <code>m</code>: multiline mode,
pattern ends after EOF, <code>u</code>: Unicode mode is enabled</li>
<li>You can also use <code>let expr = new RegExp(pattern, flags)</code>
to create regular expressions</li>
</ul></li>
<li>Instance properties: <code>global</code> boolean,
<code>ignoreCase</code> boolean, <code>unicode</code> boolean,
<code>multiline</code> boolean, <code>flags</code> string</li>
<li>Instance methods
<ul>
<li><code>pattern.exec(target)</code>
<ul>
<li>Returns an array of information about the first match, or null if no
match is found</li>
<li>The returned array has <code>index</code> and <code>input</code>
properties to indicate the position of the match, and the input
string</li>
<li>The first string in the array is the matched string</li>
<li>If global flag is set, the <code>exec()</code> method returns
information about one match per iteration, when the global flag is not
specified, calling <code>exec()</code> on the same string multiple times
will always return information about the first match</li>
</ul></li>
<li><code>pattern.test(target)</code>
<ul>
<li>Returns true if the pattern matches the argument and false if it
does not</li>
</ul></li>
</ul></li>
</ul></li>
<li>Primitive wrapper types
<ul>
<li>Three special reference types are designed to ease interaction with
primitive values: <code>Boolean</code>, <code>Number</code>, and
<code>String</code></li>
<li>Every time a primitive value is read, an object of the corresponding
primitive wrapper type is created, the wrapper object is destroyed when
it's done <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s1 = <span class="string">&quot;text&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> s2 = s1.substring(<span class="number">2</span>);</span><br><span class="line"><span class="comment">// the above line creates a wrapper object from s1, call substring method on it, and destroys the wrapper object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> s1 = <span class="string">&quot;text&quot;</span>;</span><br><span class="line">s1.color = <span class="string">&quot;red&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(s1.color); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure></li>
<li>Calling <code>typeof</code> on an instance of a primitive wrapper
type returns <code>object</code>, and all primitive wrapper objects
convert to the Boolean value <code>true</code> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(x == <span class="literal">false</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(x &amp;&amp; <span class="number">1</span>); <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> x); <span class="comment">// object</span></span><br><span class="line"><span class="built_in">console</span>.log(x <span class="keyword">instanceof</span> <span class="built_in">String</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure></li>
<li>The <code>Object</code> constructor also acts as a factor method and
is capable of returning an instance of a primitive wrapper based on the
type of value passed into the constructor <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="keyword">new</span> <span class="built_in">Object</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(x <span class="keyword">instanceof</span> <span class="built_in">String</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure></li>
<li>The <code>Boolean</code> type
<ul>
<li>Instances of Boolean override the <code>valueOf()</code> method and
the <code>toString()</code> method</li>
<li>Boolean objects are seldom used because they can be rather confusing
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="keyword">new</span> <span class="built_in">Boolean</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="built_in">console</span>.log(x &amp;&amp; <span class="literal">true</span>); <span class="comment">// true</span></span><br><span class="line"><span class="keyword">let</span> y = <span class="literal">false</span>;</span><br><span class="line"><span class="built_in">console</span>.log(y &amp;&amp; <span class="literal">true</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>The <code>Number</code> type
<ul>
<li>The <code>toString()</code> method accepts a single argument
indicating the radix in which to represent the number
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">10</span>);</span><br><span class="line"><span class="built_in">console</span>.log(x.toString(<span class="number">2</span>)); <span class="comment">// 1010</span></span><br><span class="line"><span class="built_in">console</span>.log(x.toString(<span class="number">8</span>)); <span class="comment">// 12</span></span><br><span class="line"><span class="built_in">console</span>.log(x.toString(<span class="number">10</span>)); <span class="comment">// 10</span></span><br><span class="line"><span class="built_in">console</span>.log(x.toString(<span class="number">16</span>)); <span class="comment">// a</span></span><br></pre></td></tr></table></figure></li>
<li><code>toFixed(n)</code>: returns a string representation of a number
with a specified number of decimal points</li>
<li><code>toExponential()</code>: returns a string with the number of
formatted in exponential notation</li>
<li><code>toPrecision()</code>: returns either the fixed or the
exponential representation of a number, depending on which makes the
most sense</li>
<li>Some differences <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">10</span>);</span><br><span class="line"><span class="keyword">let</span> y = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> x); <span class="comment">// object</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> y); <span class="comment">// number</span></span><br><span class="line"><span class="built_in">console</span>.log(x <span class="keyword">instanceof</span> <span class="built_in">Number</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(y <span class="keyword">instanceof</span> <span class="built_in">Number</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure></li>
<li><code>Number.isInteger(value)</code>: whether a number is stored as
an interger</li>
<li><code>Number.isSafeInteger(value)</code>: whether a number is stored
as an interger and is within the range of a 32-bit signed integer, i.e.,
([-2^{53} + 1, 2^{53} - 1])</li>
</ul></li>
<li>The <code>String</code> type
<ul>
<li><code>s.length</code>: return the length of a string</li>
<li><code>charAt(index)</code>: returns the character at the specified
index</li>
<li><code>s1.concat(s2)</code>: creates a new string by concatenating
two strings, s1 and s2 remain the same</li>
<li><code>s.slice(start, end)</code>,
<code>s.substring(start, end)</code>: returns a substring of a
string</li>
<li><code>s.substr(start, length)</code>: returns a substring of a
string</li>
<li><code>s.indexOf(str[, pos])</code>: returns the index of the first
occurrence of a substring in a string, starting from pos</li>
<li><code>s.lastIndexOf(str[, pos])</code>: returns the index of the
last occurrence of a substring in a string, starting from pos</li>
<li><code>s.startsWith(str)</code>, <code>s.endsWith(str)</code>:
returns true if the string starts or ends with the specified
substring</li>
<li><code>s.includes(str)</code>: returns true if the string contains
the specified substring</li>
<li><code>s.trim()</code>, <code>s.trimLeft()</code>,
<code>s.trimRight()</code>: returns a string with whitespace
removed</li>
<li><code>s.repeat(n)</code>: returns a string consisting of n copies of
the string</li>
<li><code>s.padStart()</code>, <code>s.padEnd()</code>: returns a string
with the specified padding</li>
<li>String destructuring: <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> c <span class="keyword">of</span> <span class="string">&quot;abc&quot;</span>) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// a</span></span><br><span class="line"><span class="comment">// b</span></span><br><span class="line"><span class="comment">// c</span></span><br></pre></td></tr></table></figure></li>
<li><code>s.toLowerCase()</code>, <code>s.toUpperCase()</code>: returns
a string with all characters converted to lowercase or uppercase</li>
<li><code>s.match(pattern)</code>: equivalent to
<code>pattern.exec(s)</code></li>
<li><code>s1.localeCompare(s2)</code>: compares two strings in a
locale-aware manner, returns 1, 0, or -1</li>
</ul></li>
</ul></li>
<li>Singleton built-in objects
<ul>
<li>The <code>Global</code> object
<ul>
<li>It's the most unique in ECMAScript because it is not explicitly
accessible</li>
<li>The <code>Global</code> object is the catchall for properties and
methods that don't otherwise have an owning object</li>
<li>URL-encoding methods: <code>encodeURI(uri)</code>,
<code>encodeURIComponent(uri)</code>, <code>decodeURI(uri)</code>,
<code>decodeURIComponent(uri)</code></li>
<li>Properties: <code>undefined</code>, <code>NaN</code>,
<code>Infinity</code>, <code>Object</code>, ...</li>
<li>The <code>window</code> object： web browsers implement it in such
that the <code>window</code> is the <code>Global</code> object's
delegate</li>
<li>Use <code>this</code> to get the <code>Global</code> object:
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="built_in">global</span> = <span class="function">() =&gt;</span> &#123;<span class="keyword">return</span> <span class="built_in">this</span>;&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>The <code>Math</code> object
<ul>
<li>Properties: <code>Math.E</code>, <code>Math.PI</code>,
<code>Math.LN10</code>, <code>Math.LN2</code>, <code>Math.LOG2E</code>,
<code>Math.LOG10E</code>, <code>Math.SQRT1_2</code>,
<code>Math.SQRT2</code></li>
<li>Methods
<ul>
<li><code>min(x1, ..., xn)</code>, <code>max(x1, ..., xn)</code></li>
<li><code>ceil()</code>, <code>floor()</code>, <code>round()</code>,
<code>fround()</code></li>
<li><code>random()</code>: use
<code>Math.floor(Math.random() * max + min)</code> to get an integer
range of ([min, max))</li>
<li>Others: <code>abs(x)</code>, <code>exp(x)</code>,
<code>expm1(x)</code> exp(x) - 1, <code>log(x)</code>,
<code>log1p(x)</code> log(x) + 1, <code>pow(x, power)</code>, ...</li>
</ul></li>
</ul></li>
</ul></li>
</ol>
<h1 id="collection-reference-types">Collection Reference Types</h1>
<ol type="1">
<li>The <code>Object</code> type
<ul>
<li>Two ways to create an instance of Object
<ul>
<li>Use <code>new</code> operator <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">obj.name = <span class="string">&#x27;Superman&#x27;</span>;</span><br><span class="line">obj.sex = <span class="string">&#x27;Female&#x27;</span>;</span><br></pre></td></tr></table></figure></li>
<li>Use object lateral notation <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  name: <span class="string">&#x27;Superman&#x27;</span>,</span><br><span class="line">  sex: <span class="string">&#x27;Female&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Property names can be string or number</li>
<li>Accessing a property: <code>obj.property</code>, or
<code>obj['property']</code></li>
</ul></li>
</ul></li>
<li>Array
<ul>
<li>ECMAScript arrays are ordered lists of data, but they can hold any
type of data in each slot</li>
<li>ECMAScript arrays are dynamically sized, automatically growing to
accommodate any data that is added to them</li>
<li>Creating arrays: <code>let arr = new Array(3);</code> or
<code>let arr = new Array('a', 'b', 'c');</code>,
<code>let arr = ['a', 'b', 'c'];</code></li>
<li>Use <code>Array.from(iterable[, map_function])</code> to create an
array from an iterable object</li>
<li>Use <code>Array.of(x1, ..., xn)</code> to create an array</li>
<li>Array holes <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a1 = [,,,]; <span class="comment">// [x0, x1, x2,], so length is 3</span></span><br><span class="line"><span class="keyword">let</span> a2 = [<span class="number">1</span>,,,]; <span class="comment">// [1, x0, x1,], so length is 3</span></span><br><span class="line"><span class="keyword">let</span> a3 = [,,,<span class="number">1</span>]; <span class="comment">// [x0, x1, x2, 1], so length is 4</span></span><br><span class="line"><span class="keyword">let</span> a4 = [<span class="number">1</span>,,,<span class="number">2</span>]; <span class="comment">// [1, x0, x1, 2], so length is 4</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>map()</code> method skip array holes, <code>join()</code>
method treats holes as empty strings</li>
</ul></li>
<li>Detect arrays
<ul>
<li>Use <code>value instanceof Array</code> to detect</li>
<li>Use <code>Array.isArray(value)</code> to detect</li>
</ul></li>
<li>Iterator methods
<ul>
<li><code>arr.keys()</code>, <code>arr.values()</code>,
<code>arr.entries()</code></li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> <span class="built_in">Array</span>.from(arr.keys())) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 0\n 1\n 2\n</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> <span class="built_in">Array</span>.from(arr.values())) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// a\n b\n c\n</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> <span class="built_in">Array</span>.from(arr.entries())) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key + <span class="string">&#x27;: &#x27;</span> + value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 0: a\n 1: b\n 2: c\n</span></span><br></pre></td></tr></table></figure></li>
<li>Copy and fill methods
<ul>
<li><code>arr.fill(value[, start[, end]])</code>: fill the array with
the specified value, start and end are optional</li>
<li><code>arr.copyWithin(target, start[, end])</code>: copy the array to
a new location, start and end are optional</li>
</ul></li>
</ul></li>
<li>Conversion methods
<ul>
<li><code>toString()</code> and <code>valueOf()</code> methods return
the same comma separated string or an array</li>
</ul></li>
<li>Stack methods
<ul>
<li><code>arr.push(value)</code>: add a new element to the end of the
array</li>
<li><code>arr.pop()</code>: remove the last element of the array, this
method returns the removed item</li>
</ul></li>
<li>Queue methods
<ul>
<li><code>arr.push(value)</code>: add a new element to the end of the
array</li>
<li><code>arr.shift()</code>: remove the first element of the array,
this method returns the removed item</li>
<li><code>arr.unshift(value)</code>: add a new element to the beginning
of the array</li>
<li><code>arr.pop()</code>: remove the last element of the array, this
method returns the removed item</li>
</ul></li>
<li>Reordering methods
<ul>
<li><code>arr.reverse()</code>: reverse an array in place, this method
returns the reversed array</li>
<li><code>arr.sort()</code>: sort an array in place, this method returns
the sorted array
<ul>
<li>By default , the sort order is ascending, built-upon converting the
items into strings and then comparing their sequences of UTF-16 code
units values</li>
<li>You can pass a compare function to <code>sort</code> to specify the
sort order, if <code>a &lt; b</code> then a appears before b</li>
</ul></li>
</ul></li>
<li>Manipulation methods
<ul>
<li><code>a1.concat(a2)</code>: return a new concatenated array, a1 and
a2 remain the same</li>
<li><code>arr.slice(start[, end])</code>: return a new array arr[start:
end], end is optional, both can be negative</li>
<li><code>arr.splice(start, deleteCount[, item1[, item2[, ...]]])</code>
<ul>
<li>One parameter: delete all items in the array starting from
<code>start</code></li>
<li>Two parameters: <code>start</code> and <code>deleteCount</code>,
delete <code>deleteCount</code> items starting from
<code>start</code></li>
<li>More than two parameters, <code>deleteCount</code> is 0: insert the
items into the array starting from <code>start</code></li>
<li>More than two parameters, <code>deleteCount</code> is positive:
delete <code>deleteCount</code> items starting from <code>start</code>,
then insert the items into the array starting from
<code>start</code></li>
</ul></li>
</ul></li>
<li>Search and location methods
<ul>
<li><code>indexOf(item)</code>, <code>lastIndexOf(item)</code>,
<code>includes(item)</code></li>
<li>Predicate search
<ul>
<li>Predicate:
<code>(item, index, array) =&gt; boolean_function(item)</code></li>
<li><code>arr.find(predicate)</code>: return the matched item</li>
<li><code>arr.findIndex(predicate)</code>: return the index of the
matched item</li>
</ul></li>
</ul></li>
<li>Iterative methods
<ul>
<li><code>every(predicate)</code>: returns true if all items in the
array satisfy the predicate, otherwise false</li>
<li><code>filter(predicate)</code>: return a new array with all items
that satisfy the predicate</li>
<li><code>forEach((item, index, array) =&gt; &#123;// do something&#125;)</code>:
execute a function for each item in the array</li>
<li><code>map(predicate)</code>: return a new array with the result of
the function</li>
<li><code>some(predicate)</code>: returns true if any item in the array
satisfies the predicate, otherwise false</li>
</ul></li>
<li>Reduction methods
<ul>
<li><code>arr.reduce((pre, cur, index, array) =&gt; &#123;function(pre, cur)&#125;, initialValue)</code>:
reduce the array to a single value, initialValue is optional (if
initialValue is not provided, pre = arr[0], cur = arr[1]), start from
left to right</li>
<li><code>arr.reduceRight((pre, cur, index, array) =&gt; &#123;function(pre, cur)&#125;, initialValue)</code>:
reduce the array to a single value, initialValue is optional (if
initialValue is not provided, pre = arr[arr.length - 1], cur =
arr[arr.length - 2]), start from right to left</li>
</ul></li>
</ul></li>
<li>Typed arrays
<ul>
<li>The typed array is a construct designed for efficiently passing
binary data to native libraries. There is no actual typed array in
JavaScript, the term refers to a collection of specialized arrays that
contain numeric types</li>
<li>Using ArrayBuffers
<ul>
<li>ArrayBuffer is a normal JavaScript constructor that can be used to
allocate a specific number of bytes in memory</li>
<li><code>const buf = new ArrayBuffer(n);</code>: allocates n bytes of
memory</li>
<li>ArrayBuffer cannot be resized once it is created, you can copy a
part to create a new one:
<code>const buf = new ArrayBuffer(n).slice(start, end);</code></li>
<li>You can use views to read data from or write data into an
ArrayBuffer</li>
</ul></li>
<li>DataViews: designed for file I/O and network I/O</li>
<li>Typed arrays: another form of an ArrayBuffer view, it offers broader
API and better performance</li>
</ul></li>
<li>The <code>Map</code> type
<ul>
<li>Prior to the ECMASCript 6, implementing a key/value store in
JavaScript could be accomplished effectively and easily by using an
Object. Newly added in the ECMAScript 6, Map is a new collection type
that introduces true key/value behavior into the language</li>
<li>Creating a new map <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> m1 = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"><span class="comment">// Pass an iterable of key/value pair arrays to the map constructor</span></span><br><span class="line"><span class="keyword">const</span> m2 = <span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="string">&#x27;k1&#x27;</span>, <span class="string">&#x27;v1&#x27;</span>], [<span class="string">&#x27;k2&#x27;</span>, <span class="string">&#x27;v2&#x27;</span>]]);</span><br><span class="line"><span class="built_in">console</span>.log(m2.size); <span class="comment">// 2</span></span><br></pre></td></tr></table></figure></li>
<li>Accessor and mutator
<ul>
<li><code>map.get(key)</code>: return the value associated with the
key</li>
<li><code>map.set(key, value)</code>: set the value associated with the
key, return the modified map</li>
<li><code>map.has(key)</code>: return true if the map contains the key,
otherwise false</li>
<li><code>map.delete(key)</code>: delete the value associated with the
key</li>
<li><code>map.clear()</code>: delete all values</li>
</ul></li>
<li>Order and iteration
<ul>
<li>One major departure from the <code>Object</code> type’s conventions
is that <code>Map</code> instances maintain the order of key/value
insertion and allow you to perform iterative operations following
insertion order</li>
<li>Iterator: <code>map.keys()</code>, <code>map.values()</code>,
<code>map.entries()</code>
<ul>
<li>You can use spread operator to convert a map to an array of
key/value pairs: <code>[...map]</code></li>
</ul></li>
</ul></li>
<li>Choosing between object and map
<ul>
<li>Memory profile: Results may vary by browser, but given a fixed
amount of memory, a <code>Map</code> will be able to store roughly 50
percent more key/value pairs than an <code>Object</code></li>
<li>Insertion performance: insertion into a <code>Map</code> will
generally be slightly faster across all browser engines</li>
<li>Lookup performance: when the amount of key/value pairs is small,
there isn't much difference between <code>Object</code> and
<code>Map</code>, but when the number of key/value pairs is large,
<code>Object</code> is faster</li>
<li>Delete performance: deleting properties from an <code>Object</code>
is notorious, you should use <code>Map</code> instead</li>
</ul></li>
</ul></li>
<li>The <code>WeakMap</code> type
<ul>
<li>Newly added in the ECMAScript 6, <code>WeakMap</code> is a new
collection type that introduces augmented key/value behavior into the
language. The “weak” designation describes how JavaScript’s garbage
collector treats keys in a <code>WeakMap</code></li>
<li>Basic API
<ul>
<li><code>const wm = new WeakMap();</code>: create a new weak map</li>
<li>Keys in a <code>WeakMap</code> must be objects, and values can be
anything</li>
<li><code>wm.has(key)</code>, <code>wm.set(key, value)</code>,
<code>wm.get(key)</code>, <code>wm.delete(key)</code></li>
</ul></li>
<li>Weak keys
<ul>
<li>keys in a <code>WeakMap</code> are weak, meaning that they are not
counted as formal references that would otherwise prevent garbage
collection</li>
<li>Values in a <code>WeakMap</code> are not weak</li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> wm1 = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span><br><span class="line">wm1.set(&#123;&#125;, <span class="string">&#x27;value&#x27;</span>); <span class="comment">// after the line is done, the key/value pair is garbage collected</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> wm2 = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span><br><span class="line"><span class="keyword">let</span> container = &#123;<span class="attr">key</span>: &#123;&#125;&#125;;</span><br><span class="line">wm2.set(container.key, <span class="string">&#x27;value&#x27;</span>); <span class="comment">// the key is not garbage collected because it is referenced by the container</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Non-iterable keys: because the key/value pairs can be garbage
collected at any time, so you cannot iterate over them (including
destroying the key/value pairs using the <code>clear</code> method)</li>
<li>Utility
<ul>
<li>Private variables: private variables will be stored in a
<code>WeakMap</code> with the object instance as the key and a
dictionary of private members as the value</li>
<li>DOM data metadata: because WeakMap instances do not interfere with
garbage collection, they are a terrific tool for cleanup-free metadata
association</li>
</ul></li>
</ul></li>
<li>The <code>Set</code> type
<ul>
<li><code>Set</code> type is added in the ECMAScript 6</li>
<li>Basic API
<ul>
<li>Create a set: <code>const s = new Set();</code></li>
<li>Create a set with an iterable:
<code>const s = new Set(iterable);</code></li>
<li>Accessor and mutator: <code>set.add(value)</code> this is
idempotent, <code>set.has(value)</code>, <code>set.size</code>,
<code>set.delete(value)</code> returns boolean and is idempotent,
<code>set.clear()</code></li>
</ul></li>
<li>A <code>Set</code> can contain any JavaScript data type as a
value</li>
<li>Order and iteration
<ul>
<li>Sets maintain the order of value insertion and allow you to perform
iterative operations following insertion order</li>
<li>You can iterate a set using the <code>set.values()</code> method or
the <code>set[Symbol.iterator]()</code> method <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">const</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>(arr);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> s.values()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> value <span class="keyword">of</span> s[<span class="built_in">Symbol</span>.iterator]()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>The <code>set.entries()</code> method returns an iterator that
yields value/value pairs for each value in the set</li>
<li>You can use <code>set.forEach(callback)</code> to iterate over the
set</li>
</ul></li>
</ul></li>
<li>The <code>WeakSet</code> type
<ul>
<li>Basic API
<ul>
<li>Create a <code>WeakSet</code>:
<code>const we = new WeakSet();</code></li>
<li>Create a <code>WeakSet</code> with an iterable:
<code>const we = new WeakSet(iterable);</code></li>
<li>Accessor and mutator: <code>set.add(value)</code> this is
idempotent, <code>set.has(value)</code>,
<code>set.delete(value)</code></li>
</ul></li>
<li>Weak keys
<ul>
<li>Values in a WeakSet are “weakly held,” meaning they are not counted
as formal references, which would otherwise prevent garbage
collection</li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ws1 = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span><br><span class="line">ws1.add(&#123;&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ws2 = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span><br><span class="line"><span class="keyword">let</span> container = &#123; <span class="attr">val</span>: &#123;&#125;&#125;;</span><br><span class="line">ws2.add(container.val);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Non-iterable keys: because the key/value pairs can be garbage
collected at any time, so you cannot iterate over them (including
destroying the key/value pairs using the <code>clear</code> method)</li>
</ul></li>
<li>Iteration and spread operators
<ul>
<li>Four native reference types define a default iterator:
<code>Array</code>, all <code>Typed Array</code>, <code>Map</code>,
<code>Set</code></li>
<li>Iterable types support ordered iteration and can be passed to a
<code>for..of</code> loop</li>
<li>Iterable types are compatible with the spread operator, the spread
operator is especially useful as it performs a shallow copy on the
iterable object</li>
</ul></li>
</ol>
<h1 id="iterators-and-generators">Iterators and generators</h1>
<ol type="1">
<li>Introduction to iteration
<ul>
<li>Using index to iterate over an array is not the ideal iteration
approach:
<ul>
<li>You need to have a specific knowledge of how to use the data
structure</li>
<li>The order of traversal is not inherent to the data structure</li>
</ul></li>
<li>The <code>Array.prototype.forEach()</code> is not ideal</li>
</ul></li>
<li>The iteration pattern
<ul>
<li>The <code>iterator pattern</code> describes a solution in which
something can be described as iterable and can implement a formal
<code>iterable</code> interface and be consumed by an
<code>Iterator</code></li>
<li>An <code>iterator</code> is a separate object created on demand and
intended for a single use. Each iterator is associated with an iterable,
and the iterator exposes an API to iterate through the associated
iterable a single time</li>
<li>The iterable protocol
<ul>
<li>Implementing the <code>Iterable</code> interface requires both the
capability to self-identify as supporting iteration and the capability
to create an object that implements the <code>Iterator</code> interface.
In ECMAScript, this requires it must expose a property, the "default
iterator", keyed with the special <code>Symbol.iterator</code> key.</li>
<li>Many built-in types implement the <code>Iterable</code> interface:
<code>String</code>, <code>Array</code>, <code>Map</code>,
<code>Set</code>, the <code>arguments</code> object, some Dom collection
types like <code>NodeList</code></li>
<li>You can use <code>object[Symbol.iterator]</code> to check if an
object is iterable</li>
<li>You do not need to explicitly invoke the factory function to produce
an iterator. Anything that implements the <code>Iterable</code>
interface will automatically invoke the factor function to produce an
iterator</li>
</ul></li>
<li>The <code>Iterator</code> protocol
<ul>
<li>An iterator is a single-use object that will iterate through
whatever iterable it is associated with</li>
<li>Use an <code>next()</code> method to advance through the iterable,
each time return an <code>IteratorResult</code> object containing the
next value in the iterator, the current position the iterator is at
cannot be known without invoking the <code>next()</code> method</li>
<li>The <code>next()</code> method return an object with two properties:
<code>done</code> true if there is no more values to iterate, and
<code>value</code> which contains the next value in the iterable if done
is false</li>
</ul></li>
<li>Custom iterator definition
<ul>
<li>Any object that implements the <code>Iterator</code> interface can
be used as an iterator</li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">limit</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.count = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">this</span>.limit = limit;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">next</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.count &lt;= <span class="built_in">this</span>.limit) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">value</span>: <span class="built_in">this</span>.count++, done: <span class="literal">false</span> &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">value</span>: <span class="literal">undefined</span>, <span class="attr">done</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  [<span class="built_in">Symbol</span>.iterator]() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Early termination of iterators: the optional <code>return()</code>
method allows for specifying behavior that will execute only if the
iterator is closed prematurely <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">limit</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.limit = limit;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  [<span class="built_in">Symbol</span>.iterator]() &#123;</span><br><span class="line">    <span class="keyword">let</span> count = <span class="number">1</span>;</span><br><span class="line">    limit = <span class="built_in">this</span>.limit;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="function"><span class="title">next</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (count &lt;= limit) &#123;</span><br><span class="line">          <span class="keyword">return</span> &#123; <span class="attr">value</span>: count++, done: <span class="literal">false</span> &#125;;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> &#123; <span class="attr">value</span>: <span class="literal">undefined</span>, <span class="attr">done</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="keyword">return</span>() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Early termination&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">value</span>: <span class="literal">undefined</span>, <span class="attr">done</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Generators
<ul>
<li>Generators are a delightfully flexible construct introduced in the
ECMAScript 6 specification that offers the ability to pause and resume
code execution inside a single function block</li>
<li>Basics API
<ul>
<li>Syntax: <code>function* generatorName() &#123; ... &#125;</code></li>
<li>When invoked, generator functions produce a generator object,
generator objects begin in a state of suspended execution, and implement
the <code>Iterator</code> interface and thus feature a
<code>next()</code> method</li>
</ul></li>
<li>Interrupting execution with <code>yield</code>
<ul>
<li>The <code>yield</code> keyword allows generators to stop and start
execution, and it is what makes generators truly useful</li>
<li>Upon encountering the <code>yield</code> keyword, execution will be
halted and the scope state of the function will be preserved. Execution
will only resume when the <code>next()</code> method is invoked on the
generator object <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">generatorFunction</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> generator = generatorFunction();</span><br><span class="line"><span class="built_in">console</span>.log(generator.next()); <span class="comment">// &#123; value: 1, done: false &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(generator.next()); <span class="comment">// &#123; value: 2, done: false &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(generator.next()); <span class="comment">// &#123; value: undefined, done: true &#125;</span></span><br></pre></td></tr></table></figure></li>
<li>Using a generator object as an iterable <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">generatorFunction</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> generatorFunction()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br></pre></td></tr></table></figure></li>
<li>Using yield for input and output <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">range</span>(<span class="params">start, end</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (end &gt; start) &#123;</span><br><span class="line">    <span class="keyword">yield</span> start;</span><br><span class="line">    start += <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> range(<span class="number">1</span>, <span class="number">3</span>)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br></pre></td></tr></table></figure></li>
<li>Yielding an iterable with <code>yield*</code> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">generatorFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">yield</span>* [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Recursive algorithms using <code>yield*</code> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">nTimes</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (n &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">yield</span>* nTimes(n - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">yield</span> n - <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> x <span class="keyword">of</span> nTimes(<span class="number">3</span>)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 0</span></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2  </span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Using a generator as the default iterator
<ul>
<li>Because generator objects implement the <code>Iterator</code>
interface, and because both generator functions and the default iterator
are invoked to produce an iterator, generators are exceptionally well
suited to be used as default iterators</li>
</ul></li>
<li>Early termination of generators
<ul>
<li>A generator can use both the <code>next()</code> method and the
<code>throw()</code> method to be terminated early</li>
</ul></li>
</ul></li>
</ol>
<h1 id="objects-classes-and-objected-oriented-programming">Objects,
Classes, and Objected-Oriented Programming</h1>
<ol type="1">
<li>Understanding objects
<ul>
<li>Create a new custom object <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj1 = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">obj1.name = <span class="string">&quot;Obj1&quot;</span>;</span><br><span class="line">obj1.age = -<span class="number">1</span>;</span><br><span class="line">obj1.sayHello = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Hi, I&#x27;m &quot;</span> + <span class="built_in">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj2 = &#123;</span><br><span class="line">  name: <span class="string">&quot;Obj2&quot;</span>,</span><br><span class="line">  age: -<span class="number">2</span>,</span><br><span class="line">  sayHello: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Hi, I&#x27;m &quot;</span> + <span class="built_in">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>Types of properties
<ul>
<li>ECMA-262 describes characteristics of properties through the use of
internal-only attributes</li>
<li>Data properties
<ul>
<li>Data properties contain a single location for a data value, values
are read from and written to this location</li>
<li><code>Configurable</code> attribute: boolean, whether the property
may be redefined or deleted</li>
<li><code>Enumerable</code> attribute: boolean, whether the property
will be returned in a <code>for...in</code> loop</li>
<li><code>Writable</code> attribute: boolean, whether the value of the
property can be changed</li>
<li><code>Value</code> attribute: boolean, contains the actual data
value for the property</li>
</ul></li>
<li>Accessor properties
<ul>
<li>Accessor properties do not contain a data value, they contain a
combination of a getter function and a setter function</li>
<li><code>Configurable</code> attribute: boolean, whether the property
may be redefined or deleted</li>
<li><code>Enumerable</code> attribute: boolean, whether the property
will be returned in a <code>for...in</code> loop</li>
<li><code>Get</code> attribute: function, the function to call when the
property is read from</li>
<li><code>Set</code> attribute: function, the function to call when the
property is written to</li>
</ul></li>
<li>Object identity and equality
<ul>
<li><code>NaN === NaN</code> is false, <code>isNaN(NaN)</code> is true,
<code>Object.is(NaN, NaN)</code> is true</li>
</ul></li>
<li>Enhanced object syntax
<ul>
<li>Property value shorthand <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&quot;Obj1&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  name</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">    When the property name and the value name are the same, you can omit the </span></span><br><span class="line"><span class="comment">    value name, this is equivalent to name: name;</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>Concise method syntax <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">  sayName: <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Hi, I&#x27;m <span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">  <span class="function"><span class="title">sayName</span>(<span class="params">name</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Hi, I&#x27;m <span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Object destructuring <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">  name: <span class="string">&quot;John&quot;</span>,</span><br><span class="line">  age: <span class="number">30</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> &#123;name, age&#125; = person;</span><br><span class="line"><span class="built_in">console</span>.log(name); <span class="comment">// John</span></span><br><span class="line"><span class="built_in">console</span>.log(age); <span class="comment">// 30</span></span><br><span class="line"><span class="keyword">let</span> &#123;a, b=<span class="string">&#x27;b&#x27;</span>&#125; = person;</span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// undefined, no corresponding property in person</span></span><br><span class="line"><span class="built_in">console</span>.log(b); <span class="comment">// b, default value is provided</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
<li>Object creation
<ul>
<li>Although the <code>Object</code> constructor or an object literal
are convenient ways to create single objects, creating multiple objects
with the same interface requires a lot of code duplication</li>
<li>In ECMAScript 6, formal support for classes and inheritance was
introduced</li>
<li>The factory pattern
<ul>
<li>It is a well-known design pattern used in software engineering to
abstract away the process of creating specific objects</li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createPerson</span>(<span class="params">name, age, job</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">  obj.name = name;</span><br><span class="line">  obj.age = age;</span><br><span class="line">  obj.job = job;</span><br><span class="line">  obj.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Hi, I&#x27;m <span class="subst">$&#123;<span class="built_in">this</span>.name&#125;</span>`</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj1 = createPerson(<span class="string">&quot;John&quot;</span>, <span class="number">30</span>, <span class="string">&quot;Programmer&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> obj2 = createPerson(<span class="string">&quot;Jane&quot;</span>, <span class="number">25</span>, <span class="string">&quot;Designer&quot;</span>);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>The function constructor pattern
<ul>
<li>Constructors are used to create specific types of objects, there are
native constructors, but it is also possible to define custom
constructors</li>
<li>Compared with the factory pattern, the function constructor pattern
does no explicitly create an object and return it. Defining custom
constructors also ensures that instances can be identified as a
particular type of object</li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.name = name;</span><br><span class="line">  <span class="built_in">this</span>.age = age;</span><br><span class="line">  <span class="built_in">this</span>.job = job;</span><br><span class="line">  <span class="built_in">this</span>.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Hi, I&#x27;m <span class="subst">$&#123;<span class="built_in">this</span>.name&#125;</span>`</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj1 = <span class="keyword">new</span> Person(<span class="string">&quot;John&quot;</span>, <span class="number">30</span>, <span class="string">&quot;Programmer&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> obj2 = <span class="keyword">new</span> Person(<span class="string">&quot;Jane&quot;</span>, <span class="number">25</span>, <span class="string">&quot;Designer&quot;</span>);</span><br></pre></td></tr></table></figure></li>
<li>Problems with constructors: methods are created once for each
instance, which is unnecessary and inefficient</li>
</ul></li>
<li>The prototype pattern
<ul>
<li>Each function is created with a prototype property, which is an
object containing properties and methods that should be available to
instances of a particular reference type</li>
<li>The benefit of using the prototype is that all of its properties and
methods are shared among object instances</li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.name = <span class="string">&quot;John&quot;</span>;</span><br><span class="line">Person.prototype.age = <span class="number">30</span>;</span><br><span class="line">Person.prototype.job = <span class="string">&quot;Programmer&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj1 = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="keyword">let</span> obj2 = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="built_in">console</span>.log(obj1.name); <span class="comment">// John</span></span><br><span class="line"><span class="built_in">console</span>.log(obj2.name); <span class="comment">// John</span></span><br></pre></td></tr></table></figure></li>
<li>Use <code>isPrototypeOf</code> to check if an object is an instance
of a prototype <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.name = <span class="string">&quot;John&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> obj1 = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="built_in">console</span>.log(Person.prototype.isPrototypeOf(obj1)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getPrototypeOf(obj1) === Person.prototype); <span class="comment">// true</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  You can manually set the prototype of an object, but this will likely cause </span></span><br><span class="line"><span class="comment">  severe slowdowns when used</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.setPrototypeOf(obj1, Person.prototype)); </span><br></pre></td></tr></table></figure></li>
<li>Understanding the prototype hierarchy
<ul>
<li>Property searching by name: search the instance first, then the
prototype</li>
<li>The property of an instance will shadow the property of the
prototype with the same name <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Person.prototype.name = <span class="string">&quot;John&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj1 = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="built_in">console</span>.log(obj1.name); <span class="comment">// John</span></span><br><span class="line"><span class="built_in">console</span>.log(obj1.hasOwnProperty(<span class="string">&quot;name&quot;</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;name&quot;</span> <span class="keyword">in</span> obj1); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">obj1.name = <span class="string">&quot;Jane&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(obj1.name); <span class="comment">// Jane</span></span><br><span class="line"><span class="built_in">console</span>.log(obj1.hasOwnProperty(<span class="string">&quot;name&quot;</span>)); <span class="comment">// true</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Property enumeration order
<ul>
<li>The <code>for..in</code> loop and <code>Object.keys</code> do not
have a deterministic order of enumeration, these are determined by the
JavaScript engine and may vary by browser</li>
<li><code>Object.getOwnPropertyNames()</code>,
<code>Object.getOwnPropertySymbols()</code>,
<code>Object.assign()</code> do have a deterministic enumeration order.
Number keys will first be enumerated in ascending order, then string and
symbol keys enumerated in insertion order</li>
</ul></li>
<li>Object iteration
<ul>
<li>The <code>Object.values()</code> and <code>Object.entries()</code>
methods return an array of values or entries, respectively</li>
<li>Alternate prototype syntax <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">  name: <span class="string">&quot;John&quot;</span>,</span><br><span class="line">  age: <span class="number">30</span>,</span><br><span class="line">  job: <span class="string">&quot;Programmer&quot;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>Dynamic nature of prototype
<ul>
<li>Because the process of looking up values on a prototype is a search,
changes made to the prototype at any point are immediately reflected on
instances, even the instances that existed before the change was
made</li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">let</span> obj1 = <span class="keyword">new</span> Person();</span><br><span class="line">Person.prototype.name = <span class="string">&quot;John&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(obj1.name); <span class="comment">// John</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Problems with prototypes
<ul>
<li>Prototype pattern negates the ability to pass initialization
arguments into the constructor, meaning all instances get the same
property values by default</li>
<li>All properties on the prototype are shared among instances, but
reference value can cause problems <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">  name: <span class="string">&quot;John&quot;</span>,</span><br><span class="line">  friends: [<span class="string">&quot;Jane&quot;</span>, <span class="string">&quot;Bob&quot;</span>]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj1 = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="keyword">let</span> obj2 = <span class="keyword">new</span> Person();</span><br><span class="line">obj1.friends.push(<span class="string">&quot;Mary&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(obj2.friends); <span class="comment">// [&quot;Jane&quot;, &quot;Bob&quot;, &quot;Mary&quot;]</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li>Inheritance
<ul>
<li>There are two types of inheritance, interface inheritance, where
only the method signatures are inherited, and implementation
inheritance, where actual methods are inherited</li>
<li>Implementation inheritance is the only type of inheritance supported
by ECMAScript</li>
<li>ECMA-262 describes prototype chaining as the primary method for
inheritance in ECMAScript. The idea is to use the concept of prototype
to inherit properties and methods between two reference types</li>
<li>Each constructor has a prototype object that points back to the
constructor, and instances have an internal pointer to the prototype. If
the prototype were actually an instance of another type, the prototype
itself would have a pointer to a different prototype that, in turn,
would have a pointer to another constructor</li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.property = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">SuperType.prototype.getSuperValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.property;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.subProperty = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">SubType.prototype = <span class="keyword">new</span> SuperType();</span><br><span class="line"></span><br><span class="line">SubType.prototype.getSubValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.subProperty;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> instance = <span class="keyword">new</span> SubType();</span><br><span class="line"><span class="built_in">console</span>.log(instance.getSuperValue()); <span class="comment">// true</span></span><br></pre></td></tr></table></figure></li>
<li>Constructor stealing
<ul>
<li>Constructor stealing (also called object masquerading or classical
inheritance) is the technique that calling the supertype constructor
from within the subtype constructor</li>
<li>The <code>apply()</code> and <code>call()</code> methods can be used
to execute a constructor on the newly created object</li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;blue&quot;</span>, <span class="string">&quot;green&quot;</span>];</span><br><span class="line">  <span class="built_in">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  SuperType.call(<span class="built_in">this</span>, name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj1 = <span class="keyword">new</span> SubType(<span class="string">&quot;Tom&quot;</span>);</span><br><span class="line">obj1.colors.push(<span class="string">&quot;black&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(obj1.colors); <span class="comment">// [&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;, &quot;black&quot;]</span></span><br><span class="line"><span class="built_in">console</span>.log(obj1.name); <span class="comment">// Tom</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj2 = <span class="keyword">new</span> SubType(<span class="string">&quot;Nicholas&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(obj2.colors); <span class="comment">// [&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;]</span></span><br><span class="line"><span class="built_in">console</span>.log(obj2.name); <span class="comment">// Nicholas</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Combination inheritance
<ul>
<li>Combination inheritance combines prototype chaining and constructor
stealing to get the best of each approach</li>
<li>The idea is to use prototype chaining to inherit properties and
methods on the prototype and to use constructor stealing to inherit
instance properties</li>
</ul></li>
<li>Other inheritance: prototypal inheritance, parasitic inheritance,
parasitic combination inheritance</li>
</ul></li>
<li>Classes
<ul>
<li>The ability to formally define classes using the <code>class</code>
keyword was introduced in ECMAScript 6, although classes still use
prototype and constructor concepts under the hood</li>
<li>Class definition basics
<ul>
<li>Class declaration: <code>class Person &#123;&#125;</code></li>
<li>Class expression: <code>const Person = class &#123;&#125;</code></li>
<li>Class composition
<ul>
<li>Components: constructor method, instance methods, getters, setters
and static class methods</li>
<li>None of the components are required, an empty class definition is
valid syntax</li>
<li>By default, everything inside a class definition executes in strict
mode</li>
</ul></li>
</ul></li>
<li>The class constructor
<ul>
<li>The <code>constructor</code> keyword is used inside the class
definition block so signal the definition of the class's constructor
function</li>
<li>A constructor is not required</li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>There is no formal class type in the ECMAScript specification, and
in may ways ECMAScript classes behave like special functions</li>
</ul></li>
<li>Instance, prototype, and class members
<ul>
<li>Each instance is assigned unique member objects, meaning nothing is
shared on the prototype</li>
<li>Everything defined in the class body is defined on the class
prototype object</li>
<li>For static methods, there is one copy in each class
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.locate = <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;instance&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  locate = <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;prototype&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> locate = <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;class&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj1 = <span class="keyword">new</span> Person(<span class="string">&quot;John&quot;</span>);</span><br><span class="line">obj1.locate(); <span class="comment">// instance</span></span><br><span class="line">Person.locate(); <span class="comment">// class</span></span><br><span class="line">Person.prototype.locate(); <span class="comment">// prototype</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Inheritance
<ul>
<li>Inheritance basics
<ul>
<li>Inherit from class <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Engineer</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;&#125;</span><br><span class="line"><span class="keyword">let</span> engineer = <span class="keyword">new</span> Engineer();</span><br><span class="line"><span class="built_in">console</span>.log(engineer <span class="keyword">instanceof</span> Person); <span class="comment">// true</span></span><br></pre></td></tr></table></figure></li>
<li>Inherit from function constructor <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Engineer</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;&#125;</span><br><span class="line"><span class="keyword">let</span> engineer = <span class="keyword">new</span> Engineer();</span><br><span class="line"><span class="built_in">console</span>.log(engineer <span class="keyword">instanceof</span> Person); <span class="comment">// true</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li><code>super()</code>
<ul>
<li><code>super</code> is used inside the constructor to control when to
invoke the parent class constructor</li>
<li><code>super</code> can also be used inside static methods to invoke
static methods defined on the inherited class</li>
<li><code>super</code> cannot be referenced by itself</li>
</ul></li>
<li>Abstract base classes
<ul>
<li>ECMAScript does not explicitly support defining abstract
classes</li>
<li>You need to use <code>new.target</code> to prevent instantiating
abstract class objects <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">new</span>.target === Person) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;Cannot instantiate abstract class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
</ul></li>
</ol>
<h1 id="proxies-and-reflect">Proxies and Reflect</h1>
<ol type="1">
<li>Proxy foundation
<ul>
<li>Introduced in ECMAScript 6, proxies and reflection are new
constructs that afford you the ability to intercept and shim additional
behavior into fundamental operations within the language</li>
<li>A proxy behaves as an abstraction for a target object, the target
can either be manipulated directly or through the proxy</li>
<li>Creating a passthrough proxy
<ul>
<li>By default, all operations performed on a proxy object will be
propagated through to the target object</li>
<li>A proxy is created using the <code>Proxy</code> constructor, you
need to provide both a target object and a handler object, without which
a <code>TypeError</code> is thrown</li>
</ul></li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> target = &#123;</span><br><span class="line">  id: <span class="string">&#x27;target&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> handler = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(proxy.id); <span class="comment">// target</span></span><br><span class="line"><span class="built_in">console</span>.log(target.id); <span class="comment">// target</span></span><br></pre></td></tr></table></figure></li>
<li>Defining traps
<ul>
<li>The primary purpose of a proxy is to allow you to define traps,
which behaves as fundamental operations interceptors inside the handler
object</li>
<li>Each handler is made up to a certain amount ot traps, and each trap
corresponds to a fundamental operation that can be directly or
indirectly called on the proxy</li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> target = &#123;</span><br><span class="line">  foo: <span class="string">&#x27;bar&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> handler = &#123;</span><br><span class="line">  <span class="comment">// traps are keyed by method name inside the handler object</span></span><br><span class="line">  <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;handler override&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</span><br><span class="line"><span class="built_in">console</span>.log(proxy.foo); <span class="comment">// handler override</span></span><br><span class="line"><span class="built_in">console</span>.log(target.foo); <span class="comment">// bar</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Trap parameters and the reflect API
<ul>
<li>All traps have access to parameters that will allow you to fully
recreate the original behavior of the trapped method</li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> target = &#123;</span><br><span class="line">  msg1: <span class="string">&quot;hello&quot;</span>,</span><br><span class="line">  msg2: <span class="string">&quot;everyone&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> handler = &#123;</span><br><span class="line">  <span class="function"><span class="title">get</span>(<span class="params">target, property, receiver</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (property === <span class="string">&quot;msg1&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(...arguments);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</span><br><span class="line"><span class="built_in">console</span>.log(target.msg1); <span class="comment">// hello</span></span><br><span class="line"><span class="built_in">console</span>.log(proxy.msg1); <span class="comment">// hello world</span></span><br><span class="line"><span class="built_in">console</span>.log(target.msg2); <span class="comment">// everyone</span></span><br><span class="line"><span class="built_in">console</span>.log(proxy.msg2); <span class="comment">// everyone</span></span><br></pre></td></tr></table></figure></li>
<li>Every method that can be trapped inside a handler object has a
corresponding Reflect API method, this method has identical name and
function signature, and performs the exact behavior that the trapped
method is intercepting <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> target = &#123;&#125;;</span><br><span class="line"><span class="comment">// Approach 1</span></span><br><span class="line"><span class="keyword">const</span> handler = &#123;</span><br><span class="line">  <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(...arguments);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Approach 2</span></span><br><span class="line"><span class="keyword">const</span> handler = &#123;</span><br><span class="line">  get: <span class="built_in">Reflect</span>.get</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Trap invariants
<ul>
<li>Traps are not without restriction, each trapped method is aware of
the target object context and trap function signature, and the behavior
of the trap handler function must obey the trap invariants</li>
<li>Trap invariants vary by method, but in general they will prevent the
trap definition from exhibiting any grossly unexpected behavior</li>
</ul></li>
<li>Utility of the Reflect API
<ul>
<li>Reflect API vs. Object API
<ul>
<li>The Reflect API is not limited to trap handler</li>
<li>Most Reflect API methods have an analogue on the Object type</li>
</ul></li>
<li>Status flags: many Reflect methods return a Boolean, indicating if
the operation they intend to perform will be successful or not</li>
</ul></li>
<li>Proxying a Proxy
<ul>
<li>Proxies are capable of intercepting Reflect API operations, and this
means that it is entirely possible to create a proxy of a proxy, this
allows you to build multiple layers of indirection on top of a singular
target object</li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> target = &#123;</span><br><span class="line">  foo: <span class="string">&#x27;bar&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> firstProxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, &#123;</span><br><span class="line">  <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;first proxy&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(...arguments);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> secondProxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(firstProxy, &#123;</span><br><span class="line">  <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;second proxy&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(...arguments);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(secondProxy.foo); </span><br><span class="line"><span class="comment">// second proxy</span></span><br><span class="line"><span class="comment">// first proxy</span></span><br><span class="line"><span class="comment">// bar</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Proxy considerations and shortcomings
<ul>
<li>One potential source of trouble with proxies is the value of
<code>this</code></li>
<li>Some built-in types are not compatible with proxies</li>
</ul></li>
</ul></li>
<li>Proxy types and Reflect methods</li>
</ol>
<ul>
<li>Proxies are able to trap thirteen fundamental operations, each has
its own entry in the Reflect API, parameters, associated ECMAScript
operations, and invariants</li>
<li>Different JavaScript operations may invoke the same trap handler,
but for any single operation that is performed on a proxy object, only
one trap handler will ever be called, there is no overlap of trap
coverage</li>
<li><code>get()</code>
<ul>
<li>The <code>get()</code> trap is called inside operations that
retrieve a property value, its corresponding Reflect API method is
<code>Reflect.get()</code></li>
<li><code>get(target, property, receiver)</code>, return value is
unrestricted</li>
</ul></li>
<li><code>set()</code>
<ul>
<li>The <code>set()</code> trap is called inside operations that assign
a property value, its corresponding Reflect method is
<code>Reflect.set()</code></li>
<li><code>set(target, property, value, receiver)</code>, return boolean
value</li>
</ul></li>
<li><code>has()</code>
<ul>
<li>The <code>has()</code> trap is called inside the in operator, its
corresponding Reflect API method is <code>Reflect.has()</code></li>
<li><code>has(target, property)</code>, return boolean value</li>
</ul></li>
<li><code>defineProperty()</code>
<ul>
<li>The <code>defineProperty()</code> trap is called inside the
<code>Object.defineProperty()</code> method, its corresponding Reflect
API method is <code>Reflect.defineProperty()</code></li>
<li><code>defineProperty(target, property, descriptor)</code>, return
boolean value</li>
</ul></li>
<li><code>getOwnPropertyDescriptor()</code>
<ul>
<li>The <code>getOwnPropertyDescriptor()</code> trap is called inside
the <code>Object.getOwnPropertyDescriptor()</code> method, its
corresponding Reflect API method is
<code>Reflect.getOwnPropertyDescriptor()</code></li>
<li><code>getOwnPropertyDescriptor(target, property)</code>, return an
object, or undefined if the property does not exist</li>
</ul></li>
<li><code>deleteProperty()</code>
<ul>
<li>The <code>deleteProperty()</code> trap is called inside the
<code>delete</code> operator, its corresponding Reflect API method is
<code>Reflect.deleteProperty()</code></li>
<li><code>deleteProperty(target, property)</code>, return a boolean
value</li>
</ul></li>
<li><code>ownKeys()</code>
<ul>
<li>The <code>ownKeys()</code> trap is called inside
<code>Object.keys()</code> and similar methods, its corresponding
Reflect API method is <code>Reflect.ownKeys()</code></li>
<li><code>ownKeys(target)</code>, return an enumerable object that
contains either strings or symbols</li>
</ul></li>
<li><code>getPrototypeOf()</code>
<ul>
<li>The <code>getPrototypeOf()</code> trap is called inside the
<code>Object.getPrototypeOf()</code> method, its corresponding Reflect
API method is <code>Reflect.getPrototypeOf()</code></li>
<li><code>getPrototypeOf(target)</code>, return an object or null</li>
</ul></li>
<li><code>setPrototypeOf()</code>
<ul>
<li>The <code>setPrototypeOf()</code> trap is called inside the
<code>Object.setPrototypeOf()</code> method, its corresponding Reflect
API method is <code>Reflect.setPrototypeOf()</code></li>
<li><code>setPrototypeOf(target, prototype)</code>, return a boolean
value</li>
</ul></li>
<li><code>isExtensible()</code>
<ul>
<li>The <code>isExtensible()</code> trap is called inside the
<code>Object.isExtensible()</code> method, its corresponding Reflect API
method is <code>Reflect.isExtensible()</code></li>
<li><code>isExtensible(target)</code>, return a boolean value</li>
</ul></li>
<li><code>preventExtensions()</code>
<ul>
<li>The <code>preventExtensions()</code> trap is called inside the
<code>Object.preventExtensions()</code> method, its corresponding
Reflect API method is <code>Reflect.preventExtensions()</code></li>
<li><code>preventExtensions(target)</code>, return a boolean value</li>
</ul></li>
<li><code>apply()</code>
<ul>
<li>The <code>apply()</code> trap is called on function calls, its
corresponding Reflect API method is <code>Reflect.apply()</code></li>
<li><code>apply(target, thisArg, ...argumentsList)</code>, the return
value is unrestricted</li>
</ul></li>
<li><code>construct()</code>
<ul>
<li>The <code>construct()</code> trap is called on the <code>new</code>
operator, its corresponding Reflect API method is
<code>Reflect.construct()</code></li>
<li><code>construct(target, argumentsList)</code>, the return value is
unrestricted</li>
</ul></li>
</ul>
<ol start="3" type="1">
<li>Proxy patterns
<ul>
<li>Tracking property access</li>
<li>Hidden properties</li>
<li>Property validation</li>
<li>Function and constructor parameter validation</li>
<li>Data binding and observables</li>
</ul></li>
</ol>
<h1 id="functions">Functions</h1>
<ol type="1">
<li>Introduction
<ul>
<li>Each function is an instance of the <code>Function</code> type that
has properties and methods just like other reference types</li>
<li>There is no semicolon after the end of the function definition, but
there is a semicolon after the end of function declaration</li>
<li>You can use the function keyword or the arrow function syntax to
define a function</li>
</ul></li>
<li>Arrow functions
<ul>
<li>For the most part, arrow functions instantiate function objects that
behave in the same manner as their formal function expression
counterparts, anywhere a function expression can be used, an arrow
function can also be used</li>
<li>Arrow functions are useful in inline situations</li>
<li>Arrow functions do not require the parentheses if you only want to
use a single parameter, if you want to have zero parameters, or more
than one parameter, parentheses are required</li>
<li>Arrow functions also do no require curly braces</li>
<li>Arrow functions do not allow the use of arguments, super, or
new.target, and cannot be used as a constructor, functions objects
created with the arrow syntax do not have a prototype defined</li>
</ul></li>
<li>Function names
<ul>
<li>Function names are simply pointers to functions, so it is possible
to have multiple names for a single function</li>
<li>All function objects in ECMAScript 6 expose a read-only name
property that describes the function. If a function is unnamed, the name
property returns an empty string, if a function is created using the
function constructor, the name property returns anonymous
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mySum</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> anotherSum = mySum;</span><br><span class="line"><span class="built_in">console</span>.log(mySum(<span class="number">1</span>, <span class="number">2</span>)); <span class="comment">// 3</span></span><br><span class="line"><span class="built_in">console</span>.log(anotherSum(<span class="number">1</span>, <span class="number">2</span>)); <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> testFunc = <span class="function">() =&gt;</span> &#123;&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(mySum.name); <span class="comment">// mySum</span></span><br><span class="line"><span class="built_in">console</span>.log(testFunc.name); <span class="comment">// (empty string here)</span></span><br><span class="line"><span class="built_in">console</span>.log((<span class="keyword">new</span> <span class="built_in">Function</span>()),name); <span class="comment">// anonymous </span></span><br><span class="line"><span class="built_in">console</span>.log(anotherSum.name); <span class="comment">// mySum</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Understanding arguments
<ul>
<li>An ECMAScript function does not care how many arguments are passed
in, nor does it care about the data types of those arguments</li>
<li>Arguments in ECMAScript are represented as an array internally, the
function does not care what is in the array</li>
<li>Named arguments are a convenience, not a necessity
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The following functions are equivalent</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHi1</span>(<span class="params">name, msg</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Hello <span class="subst">$&#123;name&#125;</span>, <span class="subst">$&#123;msg&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHi2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Hello <span class="subst">$&#123;<span class="built_in">arguments</span>[<span class="number">0</span>]&#125;</span>, <span class="subst">$&#123;<span class="built_in">arguments</span>[<span class="number">1</span>]&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>The amount of arguments: <code>arguments.length</code></li>
<li>Arguments in arrow functions
<ul>
<li>When a function is defined using the arrow notation, the arguments
passed to the function cannot be accessed using the
<code>arguments</code> keyword; they can only be accessed using their
named token in the function definition</li>
</ul></li>
</ul></li>
<li>No overloading
<ul>
<li>ECMAScript functions cannot be overloaded in the traditional sense,
they don't have signatures</li>
<li>If two functions are defined to have the same name, it is the last
function that becomes the owner of that name</li>
</ul></li>
<li>Default parameters
<ul>
<li>You can define default values for arguments</li>
<li>Temporal dead zone: the default parameter values are initialized in
the order in which they are listed in the list of parameters
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This one works</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeKing</span>(<span class="params">name = <span class="string">&#x27;Henry&#x27;</span> numerals = name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`King <span class="subst">$&#123;name&#125;</span> <span class="subst">$&#123;numerals&#125;</span>`</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This one does not work</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeKing</span>(<span class="params">numerals = name, name = <span class="string">&#x27;Henry&#x27;</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`King <span class="subst">$&#123;name&#125;</span> <span class="subst">$&#123;numerals&#125;</span>`</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Spread arguments and rest parameters
<ul>
<li>Use the spread operator to expand the elements of an array into a
list of arguments <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</span><br><span class="line">    sum += <span class="built_in">arguments</span>[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="built_in">console</span>.log(add(-<span class="number">1</span>, ...arr)); <span class="comment">// 5</span></span><br></pre></td></tr></table></figure></li>
<li>Rest parameter <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">...values</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> values.reduce(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="built_in">console</span>.log(add(-<span class="number">1</span>, ...arr)); <span class="comment">// 5</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Function declarations versus function expressions
<ul>
<li>Function declarations are read and available in an execution context
before any code is executed, whereas function expressions aren't
complete until the execution reaches that line of code
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This works</span></span><br><span class="line"><span class="built_in">console</span>.log(add1(<span class="number">10</span>, <span class="number">10</span>)); <span class="comment">// 20</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add1</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This doesn&#x27;t work</span></span><br><span class="line"><span class="built_in">console</span>.log(add2(<span class="number">10</span>, <span class="number">10</span>)); <span class="comment">// Uncaught ReferenceError: add2 is not defined</span></span><br><span class="line"><span class="keyword">let</span> add2 = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Functions as values
<ul>
<li>Because function names are variables, functions can be used anywhere
variables can be used, this means it is possible not only to pass a
function into another function as an argument, but also to return a
function as the result of another function <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">comparePropertyFunc</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">obj1, obj2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> val1 = obj1[name];</span><br><span class="line">    <span class="keyword">let</span> val2 = obj2[name];</span><br><span class="line">    <span class="keyword">if</span> (val1 &lt; val2) &#123;</span><br><span class="line">      <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (val1 &gt; val2) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Function internals
<ul>
<li><code>arguments</code>: the <code>arguments</code> object has a
property named <code>callee</code>, which is a pointer to the function
that owns the <code>arguments</code> object <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fact</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// This recursive call is tightly coupled with the function name</span></span><br><span class="line">  <span class="keyword">return</span> n * fact(n - <span class="number">1</span>);</span><br><span class="line">  <span class="comment">// This is the equivalent one: return n * arguments.callee(n - 1);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ol>
<ul>
<li><code>this</code>: <code>this</code> behaves differently when used
inside a standard function and an arrow function
<ul>
<li>Inside a standard function, it is a reference to the context object
that the function is operating on, often called the
<code>this value</code></li>
<li>Inside an arrow function, it references the context in which the
arrow function expression is defined</li>
</ul></li>
<li><code>caller</code>
<ul>
<li>The <code>caller</code> property contains a reference to the
function that called this function or null if the function was called
from the global scope</li>
<li>When function code executes in strict mode,
<code>arguments.callee</code> and <code>arguments.caller</code> result
in an error</li>
<li>In strict mode, you also cannot assign a value fo the caller
property of a function, otherwise an error is called</li>
</ul></li>
</ul>
<ol start="11" type="1">
<li>Function properties and methods
<ul>
<li>Each function has two properties: <code>length</code> and
<code>prototype</code>
<ul>
<li>The <code>length</code> indicates the number of named arguments that
the function expects</li>
<li>The <code>prototype</code> property is the actual location of all
instance methods for reference types, meaning methods actual exist on
the prototype and are then accessed from the object instances</li>
</ul></li>
<li>Each function has two methods: <code>call</code> and
<code>apply</code>
<ul>
<li>Both methods call the function with a specific this value,
effectively setting the value of this object inside the function
body</li>
<li><code>apply()</code> accepts two arguments: the value of this inside
the function and an array of arguments</li>
<li><code>call()</code>: the first arguments is the this value, but
arguments are passed directly into the function <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callSum1</span> (<span class="params">val1, val2</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Alternative way: return add.apply(this, arguments);</span></span><br><span class="line">  <span class="keyword">return</span> add.apply(<span class="built_in">this</span>, [val1, val2]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callSum2</span>(<span class="params">val1, val2</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> add.call(<span class="built_in">this</span>, val1, val2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
<li>Function expressions
<ul>
<li>The created function in an function expression is considered to be
anonymous function/lambda function</li>
<li>Function expressions must be assigned before usage</li>
</ul></li>
<li>Recursion
<ul>
<li>A recursive function typically is formed when a function calls
itself by name</li>
<li>The ECMAScript 6 introduced a memory management optimization that
allows the JavaScript engine to reuse stack frames with tail calls,
where the return value of an outer function is the returned value of an
inner function</li>
<li>Requirements for tail call
<ul>
<li>The code is executing in strict mode</li>
<li>The return value of the outer function is the invoked tail call
function</li>
<li>There is no further execution required after the tail call function
returns</li>
<li>The tail call function is not a closure that refers to variables in
the outer function's scope</li>
</ul></li>
</ul></li>
<li>Closures
<ul>
<li>Closures are functions that have access to variables from another
function's scope, this is often accomplished by creating a function
inside a function</li>
<li>In general, when a variable is accessed inside a function, the scope
chain is searched for a variable with the given name, once the function
has completed, the local activation object is destroyed, leaving only
the global scope in memory</li>
<li>In closures, the outer function adds the inner function to its own
scope, and the inner function can access the outer function's variables
even after the inner function has completed</li>
<li>There may be memory leaks with closures</li>
</ul></li>
<li>Private variables
<ul>
<li>Strictly speaking, JavaScript has no concept of private members, all
object properties are public</li>
<li>Any variable defined inside a function or block is considered
private because it is accessible outside that function</li>
<li>A privileged method is a public method that has access to private
variables and/or private functions
<ul>
<li>Privileged methods can be created inside a constructor</li>
<li>Privileged methods can also be created by using a private scope to
define the private variables or functions</li>
</ul></li>
</ul></li>
</ol>
<h1 id="promises-and-async-functions">Promises and Async Functions</h1>
<ol type="1">
<li>Asynchronous programming
<ul>
<li>Synchronous behavior is analogous to sequential processor
instructions in memory, each instruction is executed strictly in the
order in which it appears. At each step in this program, it is possible
to reason about the state of the program because execution will not
proceed until the previous instruction is completed</li>
<li>Asynchronous behavior is analogous to interrupts, where an entity
external to the current process is able to trigger code execution,
asynchronous operation is often required because it is infeasible to
force the process to wait a long time for an operation to complete</li>
<li>Legacy asynchronous programming patterns
<ul>
<li>In early versions of JavaScript, an asynchronous operation only
supported definition of a callback function to indicate that the
asynchronous operation had completed</li>
<li>Serializing asynchronous behavior was a common problem, usually
solved by a codebase full of nested callback functions, colloquially
referred to as callback hell</li>
<li>An example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">double</span>(<span class="params">value, success, failure</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> value !== <span class="string">&#x27;number&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">&#x27;Must provide number as first argument!&#x27;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      success(value * <span class="number">2</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      failure(err);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> successCallback = <span class="function">(<span class="params">value</span>) =&gt;</span> <span class="built_in">console</span>.log(<span class="string">`Success: <span class="subst">$&#123;value&#125;</span>`</span>);</span><br><span class="line"><span class="keyword">const</span> failureCallback = <span class="function">(<span class="params">err</span>) =&gt;</span> <span class="built_in">console</span>.log(<span class="string">`Failure: <span class="subst">$&#123;err&#125;</span>`</span>);</span><br><span class="line">double(<span class="number">3</span>, successCallback, failureCallback); <span class="comment">// Success: 6</span></span><br><span class="line">double(<span class="string">&#x27;3&#x27;</span>, successCallback, failureCallback); <span class="comment">// Failure: Must provide number as first argument!</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
<li>Promises
<ul>
<li>Promises are used to describe a programming tool for synchronizing
program execution</li>
<li>ECMAScript 6 uses the Promises/A+ Promise Specification to define
how promises were implemented. ECMAScript 6 introduced a first-class
implementation of a Promise/A+-compliant Promise type</li>
<li>Promise basics
<ul>
<li>Create a promise with <code>new</code> keyword:
<code>let p = new Promise(executor)</code></li>
<li>The promise state machine
<ul>
<li>A promise is a stateful object that can exist in one of three
states: pending, fulfilled (resolved), or rejected</li>
<li>The pending state is the initial state a promise begins in</li>
<li>The pending state can become settled by irreversibly transitioning
to either the fulfilled state or the rejected state</li>
<li>It is not guaranteed that a promise will leave the pending
state</li>
<li>The state of a promise is private and cannot be directly inspected
in JavaScript</li>
</ul></li>
<li>Utilities of promises
<ul>
<li>Promise can be used to represent a block of asynchronous execution,
the pending state indicates that the execution has not yet begun, the
fulfilled state indicates the execution is successful, the rejected
state indicates the execution failed</li>
<li>Promise can be used to generate a value, the fulfilled state
contains a private internal value, the rejected state contains the
reason for rejection</li>
</ul></li>
<li>Controlling promise state with the executor
<ul>
<li>The state of a promise can only be manipulated internally using the
executor function</li>
<li>Two methods are involved: <code>resolve()</code> and
<code>reject()</code></li>
<li>An example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    resolve(<span class="string">&#x27;Success!&#x27;</span>);</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    reject(<span class="string">&#x27;Failure!&#x27;</span>);</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Resolve:
<code>let p = new Promise((resolve, reject) =&gt; &#123; resolve('Success!'); &#125;)</code>,
or equivalently, <code>let p = Promise.resolve('Success!')</code></li>
<li>Reject:
<code>let p = new Promise((resolve, reject) =&gt; &#123; reject('Failure!'); &#125;)</code>,
or equivalently, <code>let p = Promise.reject('Failure!')</code></li>
</ul></li>
</ul></li>
<li>Promise methods
<ul>
<li>Implementing the Thenable interface
<ul>
<li>Any asynchronous constructs expose a <code>then()</code> method,
which implements the <code>Thenable</code> interface</li>
</ul></li>
<li><code>Promise.prototype.then()</code>
<ul>
<li>Then <code>then()</code> method accepts up to two arguments, an
optional <code>onResolved</code> handler function, and an optional
<code>OnRejected</code> handler function</li>
<li>The <code>onResolved</code> handler function is called when the
promise is fulfilled, and the <code>OnRejected</code> handler function
is called when the promise is rejected</li>
<li>An example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    resolve(<span class="string">&#x27;Success!&#x27;</span>);</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line">p1.then(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value); <span class="comment">// Success!</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    reject(<span class="string">&#x27;Failure!&#x27;</span>);</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line">p2.then(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value); <span class="comment">// Failure!</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li><code>Promise.prototype.catch()</code>
<ul>
<li>The <code>catch()</code> method can be used to attach only a reject
handler to a promise, it only takes a single argument, the
<code>onRejected</code> handler function</li>
<li>The <code>catch(onRejected)</code> is equivalent to
<code>then(null, onRejected)</code></li>
</ul></li>
<li><code>Promise.prototype.finally()</code>
<ul>
<li>The <code>finally()</code> method can be used to attach an
<code>onFinally</code> handler function, which executes when the promise
reaches either a fulfilled or rejected state</li>
<li>Since the <code>finally</code> does not know the state of the
promise, it is designed to be used for things like cleanup, logging, and
other tasks that need to be performed regardless of the state of the
promise</li>
</ul></li>
<li>Each promise instance methods return a new promise, so promises can
be chained</li>
<li><code>Promise.all()</code>: this static method creates an
all-or-nothing promise that resolves only once every promise in a
collection of promises resolves, a new promise is returned</li>
<li><code>Promise.race()</code>: this static method creates a promise
that will mirror whichever promise inside a collection of promises
reaches a resolved or rejected state first, a new promise is
returned</li>
</ul></li>
</ul></li>
<li>Async functions
<ul>
<li>Async functions, also referred to by the operative keyword pair
<code>async/await</code>, are the application of the ES6 Promise
paradigm to ECMAScript functions</li>
<li>Async function basics
<ul>
<li>The <code>async</code> keyword
<ul>
<li>An async function can be declared by prepending the
<code>async</code> keyword, this keyword can be used on function
declarations, function expressions, arrow functions and methods</li>
<li>Using the <code>async</code> keyword will create a function that
exhibits some asynchronous characteristics but overall is still
synchronously evaluated</li>
<li>In an async function, whatever value is returned with the return
keyword will be converted into a promise object with
<code>Promise.resolve()</code>. An async function will always return a
promise object</li>
<li>The return value of an async function anticipates, but does not
require a thenable object</li>
<li>Throwing an error value instead return a rejected promise</li>
</ul></li>
<li>The <code>await</code> keyword
<ul>
<li>An async function indicates to code invoking it that there is no
exception of timely completion, the logical extension of this behavior
is the ability to pause and resume execution</li>
<li>The <code>await</code> keyword is used to pause execution while
waiting for a promise to resolve</li>
<li>It can be used standalone or inside an expression</li>
<li>The <code>await</code> keyword anticipates, but does not actually
require, a thenable object</li>
<li>The <code>await</code> keyword can only be used inside an async
function, otherwise a SyntaxError is thrown</li>
</ul></li>
<li>Halting and resuming execution
<ul>
<li>Example 1 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">  <span class="keyword">await</span> <span class="literal">null</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">foo();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line"><span class="comment">// 1 2 3 4</span></span><br></pre></td></tr></table></figure></li>
<li>Example 2 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">await</span> <span class="built_in">Promise</span>.resolve(<span class="number">8</span>));</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">9</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">4</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">await</span> <span class="number">6</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">7</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">foo();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line">bar();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">5</span>);</span><br><span class="line"><span class="comment">// 1 2 3 4 5 6 7 8 9</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
<li>Strategies for async function
<ul>
<li>Implementing sleep <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">sleep</span>(<span class="params">delay</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(resolve, delay);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Serial promise execution <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addTwo</span>(<span class="params">x</span>) <span class="title">return</span> <span class="title">x</span> + 2</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addThree</span>(<span class="params">x</span>) <span class="title">return</span> <span class="title">x</span> + 3</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addFive</span>(<span class="params">x</span>) <span class="title">return</span> <span class="title">x</span> + 5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">addTen</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> fn <span class="keyword">of</span> [addTwo, addThree, addFive]) &#123;</span><br><span class="line">    x = <span class="keyword">await</span> fn(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">addTen(<span class="number">1</span>).then(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value); <span class="comment">// 11</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
</ol>
<h1 id="the-browser-object-model">The Browser Object Model</h1>
<ol type="1">
<li>The <code>window</code> object
<ul>
<li>Although ECMAScript describes it as the cores of JavaScript, the BOM
is really the core of using JavaScript on the web. The BOM provides
objects the expose browser functionality independent of any web page
content</li>
<li>At the core of the BOM is the window object, which represents an
instance of the browser</li>
<li>Two purposes of window object in browsers:
<ul>
<li>Act as the JavaScript interface to the browser window</li>
<li>Act as the ECMAScript global object</li>
</ul></li>
<li>The global scope
<ul>
<li>All variables and functions declared globally with var become
properties and methods of the window object, if they are defined using
let or const, they are not global <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> age = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;Susan&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> sayAge = <span class="function">() =&gt;</span> alert(<span class="built_in">this</span>.age);</span><br><span class="line"></span><br><span class="line">alert(<span class="built_in">window</span>.age); <span class="comment">// 20</span></span><br><span class="line">alert(<span class="built_in">window</span>.name); <span class="comment">// undefined</span></span><br><span class="line">alert(<span class="built_in">window</span>.sayAge); <span class="comment">// TypeError: window.sayAge is not a function</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Window relationships
<ul>
<li>Introduction
<ul>
<li>The <code>top</code> object always points to the very top window,
which is the browser window itself</li>
<li>The <code>parent</code> object always points to the current window's
immediate parent window. For the topmost window, parent is equal to top,
and both equal to window</li>
<li>The topmost window will never have a value set for name unless the
window was opened using <code>window.open()</code></li>
</ul></li>
<li>Window position and pixel ratio
<ul>
<li>Modern browsers all provide <code>screenLeft</code> and
<code>screenTop</code> properties that indicate the window's location in
relation to the left and top of the screen, respectively, in CSS
pixels</li>
<li>It's also possible to move the window using the
<code>window.moveTo(x, y)</code> and <code>window.moveBy(dx, dy)</code>
methods</li>
<li>Pixel ratio
<ul>
<li>A CSS pixel is the denomination of the pixel used universally in web
development, it is defined as an angular measurement: 0.0213(^{}),
approximately 1/96 of an inch on a device held at arm's length.</li>
<li>A CSS pixel (px) is not the same as a physical resolution of a
device (device pixel, pt)</li>
<li>Device pixel ratio = device resolution / CSS pixel. If the device
has a physical resolution of 1920x1080, and we want to convert it to
640x360, then the device pixel ratio is 3</li>
</ul></li>
</ul></li>
<li>Window size
<ul>
<li>All modern browsers provide four properties to determine the window
size: <code>innerWidth</code>, <code>innerHeight</code>,
<code>outerWidth</code>, and <code>outerHeight</code>. The
<code>outerWidth</code> and <code>outerHeight</code> return the
dimensions of the browser window itself, the <code>innerWidth</code> and
<code>innerHeight</code> indicate the size of the page viewport inside
the browser window (minus borders and toolbars)</li>
<li>The <code>document.documentElement.clientWidth</code> and
<code>document.documentElement.clientHeight</code> properties return the
size of the page viewport, for mobile browsers, use
<code>document.body.clientWidth</code> and
<code>document.body.clientHeight</code></li>
<li>The browser window can be resides using the
<code>window.resizeTo(width, height)</code> and
<code>resizeBy(dw, dh)</code> methods</li>
</ul></li>
<li>Window viewport position
<ul>
<li>Because the browser window is usually not large enough to display
the entire rendered document at once, the user is give the ability to
scroll around the document with a limited viewport</li>
<li>The X and Y offsets are each accessible bia two properties, which
return identical values: <code>window.pageXoffset</code>/
<code>window.scrollX</code>, and <code>window.pageYoffset</code>/
<code>window.scrollY</code></li>
<li>You can also use the <code>window.scroll(x, y)</code>,
<code>window.scrollTo(x, y)</code>, and
<code>window.scrollBy(dx, dy)</code> methods to move the viewport</li>
</ul></li>
<li>Navigating and opening windows
<ul>
<li><code>window.open(stringUR, stringName, stringFeatures, booleanReplace)</code>
<ul>
<li>stringURL: the URL to load</li>
<li>stringName: the name of the new window</li>
<li>stringFeatures: comma-separated list of features to enable</li>
<li>booleanReplace: if true, the current window is replaced, otherwise a
new window is opened</li>
</ul></li>
<li><code>window.open()</code> return a window object, this object can
be used to manipulate the newly opened window in the same way as any
other window</li>
<li><code>window.close()</code>: close the current window, return a
boolean indicating whether the window was closed</li>
<li>Security restrictions: pop-up windows went through a period of
overuse by online ads, so browsers nowadays put limits on teh
configuration of pop-up windows. Browsers will allow the creation of
pop-up windows only after a user action, a call to
<code>window.open()</code> while a page is still being loaded will not
be executed and may cause an error to be displayed to the user</li>
<li>Pop-up blocks: all modern browsers have pop-up blocking software
built in
<ul>
<li>If a pop-up window is blocked by the built-in blocker, then
<code>window.open()</code> returns null</li>
<li>When a browser add-on or other program blocks a pop-up,
<code>window.open()</code> typically throws an error</li>
<li>Detection <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> blocked = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> win = <span class="built_in">window</span>.open(url, name, features, replace);</span><br><span class="line">  <span class="keyword">if</span> (win == <span class="literal">null</span>) &#123;</span><br><span class="line">    blocked = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (ex) &#123;</span><br><span class="line">  blocked = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (blocked) &#123;</span><br><span class="line">  alert(<span class="string">&#x27;Pop-ups are blocked&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
<li>Intervals and timeouts
<ul>
<li>JavaScript execution in a browser is single-threaded, but does allow
for the scheduling of code to run at specific points in time through the
use of timeouts and intervals</li>
<li>Timeouts execute some code after a specified amount of time, whereas
intervals execute code repeatedly, waiting a specific amount of time in
between each execution</li>
<li><code>window.setTimeout(callback, milliseconds)</code></li>
<li><code>window.clearTimeout(timeoutId)</code>: cancel a pending
timeout operation, the timeoutId is an unique number returned from the
setTimeout method</li>
<li><code>window.setInterval(callback, milliseconds)</code></li>
<li><code>window.clearInterval(intervalId)</code>: cancel a pending
interval operation, the intervalId is an unique number returned from the
setInterval method <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> intervalId = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">let</span> max = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> callback = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(num);</span><br><span class="line">  num++;</span><br><span class="line">  <span class="keyword">if</span> (num &gt;= max) &#123;</span><br><span class="line">    <span class="built_in">clearInterval</span>(intervalId);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">intervalId = <span class="built_in">setInterval</span>(callback, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>System dialogs
<ul>
<li>The browser is capable of invoking system dialogs to display to the
user through the <code>alert()</code>, <code>confirm()</code>, and
<code>prompt()</code> methods</li>
<li>The system dialogs are not related to the web page being displayed
in the browser and do not contain HTML, the appearance is determined by
operating system and/or browser settings rather than CSS, and each of
the dialogs is synchronous</li>
<li>The <code>alert()</code> method
<ul>
<li>Accept a string to display to the user, if the argument of alert is
not a string, it will be converted to a string first</li>
<li>It contains a single OK button</li>
<li>Alert dialogs are typically used when users must be made aware of
something that they have no control over, such as an error, the user's
only choice is to dismiss the dialog after reading the message</li>
</ul></li>
<li>The <code>confirm()</code> method
<ul>
<li>It looks similar to an alert dialog in that it displays a message to
the user, the main difference is that the confirm dialog contains a
Cancel button along with the OK button, which allows the user to
indicate if a given action should be taken</li>
<li>The <code>confirm()</code> method returns a boolean value: true if
OK was clicked, or false if Cancel was clicked <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (confirm(<span class="string">&#x27;Are you sure?&#x27;</span>)) &#123;</span><br><span class="line">  alert(<span class="string">&quot;I&#x27;m so glad you&#x27;re sure!&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  alert(<span class="string">&quot;I&#x27;m sorry to hear you&#x27;re not sure!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>The <code>prompt()</code> method
<ul>
<li>The prompt dialog prompts the user for input: along with the Cancel
and OK button, it has a text box where the user may enter some data</li>
<li><code>window.prompt(stringMessage, stringDefault)</code></li>
<li>If the OK button is clicked, <code>prompt()</code> returns the value
in teh text box, if Cancel is clicked or the dialog is otherwise closed
without clicking OK, <code>prompt()</code> returns null</li>
</ul></li>
<li>The system dialogs can be helpful for displaying information to the
user and asking for confirmation of decisions, because they require not
HTML or CSS, they are fast and easy ways to enhance a web
application</li>
</ul></li>
</ul></li>
</ul></li>
<li>The <code>location</code> object
<ul>
<li>One of the most useful BOM object is location, which provides
information about the document that is currently loaded in the window,
as well as general navigation functionality</li>
<li>Both <code>window.location</code> and <code>document.location</code>
point to the same object</li>
<li>Some properties of the location object: <code>location.host</code>
(name of server + port number if present),
<code>location.hostname</code> (name of server),
<code>location.port</code> (port number), <code>location.protocol</code>
(the protocol used by the page, typically http or https),
<code>location.username</code> (the username specified before the domain
name), <code>location.password</code> (the password specified before the
domain name), <code>location.origin</code> (the origin of the URL, read
only), <code>location.search</code> (the query string of the URL,
returns a striong beginning with a question mark)</li>
<li>Convert query string to an object <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> getParams = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> queryString = location.search.length &gt; <span class="number">0</span> ? location.search.substring(<span class="number">1</span>) : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="keyword">let</span> params = &#123;&#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> queryString.split(<span class="string">&quot;&amp;&quot;</span>).map(<span class="function">(<span class="params">x</span>) =&gt;</span> x.split(<span class="string">&quot;=&quot;</span>))) &#123;</span><br><span class="line">    <span class="comment">// query-string arguments are supposed to be encoded</span></span><br><span class="line">    <span class="keyword">let</span> key = <span class="built_in">decodeURIComponent</span>(item[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">let</span> value = <span class="built_in">decodeURIComponent</span>(item[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span> (key.length) &#123;</span><br><span class="line">      params[key] = value;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> params;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Manipulating the location
<ul>
<li><code>location.assign(URL)</code>: navigate to the new URL and makes
an entry in the browser's history stack. If
<code>location.href=URL</code> or <code>window.location=URL</code> is
used, the <code>location.assign()</code> method is called
automatically</li>
<li>Changing various properties on the location object can also modify
the currently loaded page</li>
<li>Generally, when the URL is changed, an entry is made in the
browser's history stack so the user may click the Back button to
navigate to the previous page. It is possible to disallow this behavior
by using the <code>replace()</code> method</li>
</ul></li>
</ul></li>
<li>The <code>navigator</code> object
<ul>
<li>The navigator object is the standard browser identification on the
client, each browser supports its own set of properties</li>
<li>Properties: <code>navigator.appCodeName</code> (return Mozilla),
<code>navigator.appName</code> (return browser full name),
<code>navigator.appVersion</code>, <code>navigator.deviceMemory</code>
(the amount of device memory in GB),
<code>navigator.hardwareConcurrency</code> (device's number of processor
cores), <code>navigator.language</code> (browser primary language),
<code>navigator.languages</code> (all browser's preferred languages),
<code>navigator.platform</code> (system platform)</li>
<li>Detecting plug-ins <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> hasPlugin = <span class="function">(<span class="params">name</span>) =&gt;</span> &#123;</span><br><span class="line">  name = name.toLowerCase();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> navigator.plugins) &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.name.toLowerCase().indexOf(name) &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">alert(hasPlugin(<span class="string">&quot;Flash&quot;</span>));</span><br></pre></td></tr></table></figure></li>
<li>Registering handlers <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">navigator.registerProtocolHandler(<span class="string">&quot;URL&quot;</span>, name);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>The <code>screen</code> object
<ul>
<li>The screen object (also a property of window) is one of the few
object JavaScript objects that have little to no programming use, it is
used purely as an indication of client capabilities</li>
<li>Property: <code>screen.height</code>, <code>screen.width</code>,
<code>screen.left</code> (the pixel distance of the current screen's
left side), <code>screen.top</code> (the pixel distance of the current
screen's top), <code>screen.orientation</code>,
<code>screen.colorDepth</code> (the number of bits used to represent
colors)</li>
</ul></li>
<li>The <code>history</code> object
<ul>
<li>The history object represents the user's navigation history since
the given window was first used</li>
<li>Because history is a property of window, each browser object has its
own history object relating specifically to that instance</li>
<li>The <code>history.go(n)</code>navigates through the user's history
iun either direction, backward or forward, if n &lt; 0, then navigates
backward, you can also use <code>history.back(n)</code>,
<code>history.forward(n)</code></li>
<li>You can also use <code>history.go(URL)</code> to go the nearest URL
page</li>
<li><code>history.length</code> returns the amount of items in the
history stack</li>
</ul></li>
</ol>
<h1 id="client-detection">Client Detection</h1>
<ol type="1">
<li>Introduction
<ul>
<li>Although browser vendors have made a concerted effort to implement
common interfaces, the face remains that each browser presents its own
capabilities and flaws</li>
<li>Developers need to either design for the lowest common denominator
or, more commonly, use various methods of client detection to work with
or around limitations</li>
<li>Client detection should be the very last step in solving a problem,
whenever a more common solution is available, that solution should be
used</li>
</ul></li>
<li>Capability detection
<ul>
<li>Capability detection (feature detection) uses a suite of simple
checks in the browser's JavaScript runtime to test for support of
various features</li>
<li>You should verify not just the feature is present but also that the
feature is likely to behave an appropriate manner</li>
</ul></li>
<li>User-agent detection
<ul>
<li>User-agent detection uses the browser's user-agent string to
determine information about the browser being used</li>
<li>The user-agent string is sent as a response header for every HTTP
request and is made accessible in JavaScript through
<code>navigator.userAgent</code></li>
<li>Mozilla is an abbreviation for Mosaic Killer</li>
<li>Spoofing a user-agent
<ul>
<li>User-agent is an imperfect browser identification solution, because
it is easy to spoof a user-agent string</li>
<li>Browsers that implement the <code>window.navigator</code> offer the
user-agent string as a read-only property, so you cannot modify it
directly</li>
<li>If browsers offer the pesudo-private <code>__defineGetter__</code>
method, then spoofing a user-agent is easy <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.navigator.__defineGetter(<span class="string">&quot;userAgent&quot;</span>, <span class="function">() =&gt;</span> <span class="string">&quot;random&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.navigator.userAgent); <span class="comment">// random</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>You can infer many of the following information from the user-agent:
browser, browser version, browser rendering engine, device
class(desktop/mobile), device manufacture, device model, operating
system, operating system version</li>
</ul></li>
<li>Software and hardware detection
<ul>
<li>Browser and operating system identification
<ul>
<li><code>navigator.oscpu</code>: this is deprecated, Edge and Chrome
does not have this property</li>
<li><code>navigator.vendor</code>: return a string of the browser
vendor</li>
<li><code>navigator.platform</code>: return a string indicating the
operating system inside which the browser is executing</li>
<li><code>screen.colorDepth</code>/ <code>screen.pixelDepth</code>:
return the number of color bits that can be represented in the
display</li>
<li><code>screen.orientation</code>: return a
<code>ScreenOrientation</code> object, which contains information about
the browser's screen according to the Screen Orientation API</li>
</ul></li>
<li>Browser Metadata
<ul>
<li><code>navigator.geolocation</code> property provides access to the
GeoLocation API, wich allows browser scripts to learn about the current
device's location <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p;</span><br><span class="line"><span class="comment">// The following line requires user permission </span></span><br><span class="line">navigator.geolocation.getCurrentPosition(<span class="function">(<span class="params">pos</span>) =&gt;</span> p = pos);</span><br><span class="line"><span class="built_in">console</span>.log(p.timestamp);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> p.coords); <span class="comment">// object</span></span><br><span class="line"><span class="built_in">console</span>.log(p.coords.latitude, p.coords.longitude); <span class="comment">// get the latitude and the longitude</span></span><br><span class="line"><span class="built_in">console</span>.log(p.coords.altitude); <span class="comment">// the altitude of the device, this can be null</span></span><br><span class="line"><span class="built_in">console</span>.log(p.coords.speed); <span class="comment">// the speed of the device, this can be null</span></span><br></pre></td></tr></table></figure></li>
<li>The
<code>navigator.geolocation.getCurrentPosition(callback1, callback2)</code>
can be rejected, so the first argument is the handler for position
object, the second argument is the handler for PositionError object, use
<code>e.code</code>/ <code>e.message</code> to get information about the
PositionError</li>
<li>The browser tracks the network connection state and exposes this
information in two ways: connection events, and the
<code>navigator.onLine</code> boolean property</li>
<li>The <code>navigator.connection</code> property exposes teh
NetworkInformation API</li>
<li>Battery status API: the <code>navigator.getBattery()</code> returns
a promises that resolves to a <code>BatteryManager</code> object
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">navigator.getBattery().then(</span><br><span class="line">  (bat) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(bat.charing); <span class="comment">// boolean</span></span><br><span class="line">    <span class="built_in">console</span>.log(chargingTime); <span class="comment">// number</span></span><br><span class="line">    <span class="built_in">console</span>.log(dischargingTime); <span class="comment">// number</span></span><br><span class="line">    <span class="built_in">console</span>.log(level); <span class="comment">// number</span></span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Hardware
<ul>
<li>Processor cores: <code>navigator.hardwareConcurrency</code></li>
<li>Device memory: <code>navigator.deviceMemory</code></li>
<li>Maximum touch points: <code>navigator.maxTouchPoints</code></li>
</ul></li>
</ul></li>
</ol>
<h1 id="the-document-object-model">The Document Object Model</h1>
<ol type="1">
<li>Introduction
<ul>
<li>The Document Object Model (DOM) is an application programming
interface for HTML and XML documents</li>
<li>The DOM represents a document as a hierarchical tree of nodes,
allowing for adding, removing and modifying individual parts of the
page</li>
</ul></li>
<li>Hierarchy of nodes
<ul>
<li>A document node represents every document as the root</li>
<li>In HTML, the only child of the document node is the
<code>&lt;html&gt;</code> element, which is called the document element.
There can be only one document element per document. In HTML, the
document element is always the
<html>
element, in XML, any element may be the document element</html></li>
<li>The node type
<ul>
<li>DOM Level 1 describes an interface called Node that is to be
implemented by all node types in the DOM, the Node interface is
implemented in JavaScript as the Node type</li>
<li>There are 12 node types in total: <code>Node.ELEMENT_NODE(1)</code>,
<code>Node.ATTRIBUTE_NODE(2)</code>, <code>Node.TEXT_NODE(3)</code>,
<code>Node.CDATA_SECTION_NODE(4)</code>,
<code>Node.ENTITY_REFERENCE_NODE(5)</code>,
<code>Node.ENTITY_NODE(6)</code>,
<code>Node.PROCESSING_INSTRUCTION_NODE(7)</code>,
<code>Node.COMMENT_NODE(8)</code>, <code>Node.DOCUMENT_NODE(9)</code>,
<code>Node.DOCUMENT_TYPE_NODE(10)</code>,
<code>Node.DOCUMENT_FRAGMENT_NODE(11)</code>,
<code>Node.NOTATION_NODE(12)</code></li>
<li>Get the type of a node: <code>node.nodeType</code>, this returns the
node type as a number</li>
<li>The <code>node.nodeName</code> and the <code>node.nodeValue</code>
properties return the node name and value respectively</li>
<li>Node relationships:
<ul>
<li><code>node.childNodes</code> return the child nodes of the node,
each node has this property</li>
<li><code>node.childNodes.item(1)</code> is equivalent to
<code>node.childNodes[1]</code></li>
<li><code>node.firstChild</code> is equivalent to
<code>node.childNodes[0]</code></li>
<li><code>node.lastChild</code> is equivalent to
<code>node.childNodes[node.childNodes.length - 1]</code></li>
</ul></li>
<li>Manipulating nodes
<ul>
<li><code>node.appendNode(newNode)</code>: append a node to the end of
the child nodes of the node</li>
<li><code>node.insertBefore(newNode, referenceNode)</code>: insert a
node before the reference node,
<code>node.insertBefore(newNode, null)</code> is equivalent to
<code>node.appendChild(newNode)</code>,
<code>node.insertBefore(newNode, node.firstChild)</code> inserts the
node before the first child of the node</li>
<li><code>node.replaceChild(newNode, oldNode)</code>: replace the old
node with the new node</li>
<li><code>node.removeChild(oldNode)</code>: remove the old node</li>
<li><code>node.cloneNode(booleanFlag)</code>: clone the node, if flag is
true, it is deep copy, otherwise it is shallow copy</li>
</ul></li>
</ul></li>
</ul></li>
<li>The <code>Document</code> type
<ul>
<li>The document object is an instance of HTMLDocument (which inherits
from Document)</li>
<li><code>node.nodeType = 9</code>,
<code>node.nodeName = #document</code>,
<code>node.value = null</code></li>
<li>The child of a Document node can be a <code>DocumentType</code>,
<code>Element</code>, <code>ProcessingInstruction</code>,
<code>Comment</code></li>
<li>HTML example
<ul>
<li><code>let html = document.documentElement;</code></li>
<li><code>let head = document.head;</code></li>
<li><code>let body = document.body;</code></li>
<li><code>let doctype = document.doctype;</code></li>
<li><code>let title = document.title;</code>,
<code>document.title = "new title";</code></li>
<li><code>let domain = document.domain;</code></li>
<li><code>let referrer = document.referrer;</code></li>
</ul></li>
<li>Locating elements
<ul>
<li><code>let item = document.getElementById("itemId");</code></li>
<li><code>let items = document.getElementsByTagName("tagName");</code>:
return a HTMLCollection object that acts like a list of elements</li>
<li><code>let items = document.getElementByTagName("tagName"); let item = item.namedItem("itemName")</code>:
get an element from a HTMLCollection by its name property</li>
<li><code>let allItems = document.getElementByTagName("*");</code>: get
all elements</li>
<li><code>let radios = document.getElementsByName("tagName");</code>:
get all elements with the same name, often used with radio buttons</li>
</ul></li>
<li>Document writing
<ul>
<li><code>document.write(string)</code>: write a string tag to the
document</li>
<li><code>document.writeln(string)</code>: write a string tag to the
document and add a new line</li>
</ul></li>
</ul></li>
<li>The <code>Element</code> type
<ul>
<li><code>node.nodeType = 1</code>,
<code>node.nodeName = #element</code>,
<code>node.value = null</code></li>
<li><code>node.nodeName === node.tagName</code>: the tag name of the
element, return tag name in uppercase in HTML, the same as it is in XML
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// this is the general check for the tag name</span></span><br><span class="line"><span class="keyword">if</span> (element.tagName.toLowerCase() === <span class="string">&quot;xxx&quot;</span>) &#123;</span><br><span class="line">  <span class="comment">// do something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>HTML elements
<ul>
<li>Properties: <code>id</code>, <code>className</code> (the class
property, because class is a keyword in ECMAScript, you cannot use class
directly), <code>title</code> (additional information about the
element), <code>lang</code> (code language), <code>dir</code> (direction
of the language, "ltf" : left-to-right, "rtl": right-to-left, rarely
used) <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;item&quot;</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">title</span>=<span class="string">&quot;item title&quot;</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">dir</span>=<span class="string">&quot;ltr&quot;</span>&gt;</span><span class="tag">&lt;&gt;</span></span><br></pre></td></tr></table></figure> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> item = <span class="built_in">document</span>.getElementById(<span class="string">&quot;item&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(item.id); <span class="comment">// item</span></span><br><span class="line"><span class="built_in">console</span>.log(item.className); <span class="comment">// item</span></span><br><span class="line"><span class="built_in">console</span>.log(item.title); <span class="comment">// item title</span></span><br><span class="line"><span class="built_in">console</span>.log(item.lang); <span class="comment">// en</span></span><br><span class="line"><span class="built_in">console</span>.log(item.dir); <span class="comment">// ltr</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Getting attributes
<ul>
<li>Each element may have zero or more attributes, which are typically
used to give extra information about the particular element or its
contents, three primary DOM methods for working with attributes are
<code>getAttribute(attrName)</code>,
<code>setAttribute(attrName, value)</code>,
<code>removeAttribute(attrName)</code></li>
<li><code>item.setAttribute("attrName", "value")</code> is equivalent to
<code>item.attrName = "value"</code></li>
</ul></li>
<li>The attributes property
<ul>
<li>The Element type is the only DOM node type that uses the
<code>attributes</code> property, the attributes property is a
NamedNodeMap object, which is a list of attributes, each attribute is an
Attr node</li>
<li>use <code>item.attributes.getNamedItem(attrName)</code> to get the
value of an attributes, use
<code>item.attributes.removeNamedItem(attrName)</code> to remove an
attributes</li>
</ul></li>
<li>Create elements: use <code>document.createElement(tagName)</code> to
create an element</li>
</ul></li>
<li>The <code>Text</code> type
<ul>
<li><code>node.nodeType = 3</code>, <code>node.nodeName = #text</code>,
<code>node.value = textContent</code>, child nodes are not
supported</li>
<li>The text contained in a Text node may be accessed via either the
<code>nodeValue</code> property or the <code>data</code> property, both
of which contain the same value</li>
<li>Creating text nodes: use <code>document.createTextNode(text)</code>
to create a text node <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> textNode = <span class="built_in">document</span>.createTextNode(<span class="string">&quot;text&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> node = <span class="built_in">document</span>.createElement(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">node.appendChild(textNode);</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(node);</span><br></pre></td></tr></table></figure></li>
<li>Normalizing text nodes
<ul>
<li>Typically, elements have only one text node as a child, sibling text
nodes can be confusing</li>
<li>Use <code>node.normalize()</code> to merge adjacent text nodes, the
caller node should be the parent node of the text nodes that are to be
merged</li>
</ul></li>
<li>Splitting text nodes
<ul>
<li>The <code>textNode.splitText(offset)</code> method splits one text
node into two at the given offset</li>
</ul></li>
</ul></li>
<li>The <code>Comment</code> type
<ul>
<li><code>node.nodeType = 8</code>,
<code>node.nodeName = #comment</code>,
<code>node.value = textContent</code>, child nodes are not
supported</li>
<li>The Comment type inherits from the same base as the Text type, so it
has all of the same string manipulation methods except
<code>splitText()</code>, the actual content of the comment may be
retrieved using either <code>nodeValue</code> or the <code>data</code>
property</li>
</ul></li>
<li>The <code>CDATASection</code> type
<ul>
<li><code>node.nodeType = 4</code>,
<code>node.nodeName = #cdata-section</code>,
<code>node.value = textContent</code>, child nodes are not
supported</li>
<li>CDATA sections are specific to XML-based documents and are
represented by the CDATASection type</li>
<li>The CDATA section type inherits from the same base as the Text type,
so it has all of the same string manipulation methods except
<code>splitText()</code>, the actual content of the CDATA section may be
retrieved using either <code>nodeValue</code> or the <code>data</code>
property</li>
</ul></li>
<li>The <code>DocumentType</code> type
<ul>
<li><code>node.nodeType = 10</code>,
<code>node.nodeName = #document-type</code>,
<code>node.value = null</code></li>
<li>A DocumentType object contains about the document's doctype</li>
<li>DocumentType objects cannot be created dynamically in DOM level
1,they are created only as teh document's code is being parsed</li>
</ul></li>
<li>The <code>DocumentFragment</code> type
<ul>
<li><code>node.nodeType = 11</code>,
<code>node.nodeName = #document-fragment</code>,
<code>node.value = null</code></li>
<li>Of all the node types, the DocumentFragment type is the only one
that has no representation in markup. DOM defines a document fragment as
a lightweight document, capable of containing and manipulating nodes
without all of the additional overhead of a complete document</li>
<li>A document fragment cannot be added to a document directly. Document
fragments are created using the
<code>document.createDocumentFragment()</code> method</li>
<li>Default fragments inherit all methods from Node and are typically
used to perform DOM manipulations that are to be applied to a
document</li>
</ul></li>
<li>The <code>Attr</code> type
<ul>
<li><code>node.nodeType = 11</code>,
<code>node.nodeName = attribute name</code>,
<code>node.value = attribute value</code></li>
<li>Element attributes are represented by the Attr type in the DOM, the
Attr type constructor and prototype are accessible in all browsers</li>
<li>Even though they are nodes, attributes are not considered part of
the DOM document tree</li>
<li>There are three properties on an Attr object: <code>name</code> the
attribute name , <code>value</code> the attribute value,
<code>specified</code> a boolean value indicating if the attribute was
specified in code or if it is a default value</li>
<li>Creating new attributes:
<code>document.createAttribute(attrName)</code></li>
</ul></li>
<li>Working with the DOM
<ul>
<li>Dynamic scripts
<ul>
<li>The <code>&lt;script&gt;</code> element is used to insert JavaScript
code into the page, either by using the <code>src</code> attribute to
include an external file or by including text inside the element
itself</li>
<li>Dynamic scripts are those that don't exist when teh page is loaded
but are included later by using the DOM</li>
<li>Dynamic loading an external file example <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;script.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> script = <span class="built_in">document</span>.createElement(<span class="string">&quot;script&quot;</span>);</span><br><span class="line">script.src = <span class="string">&quot;script.js&quot;</span>;</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(script); <span class="comment">//&#x27; This is when the script.js is downloaded</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Dynamic styles
<ul>
<li>CSS styles are included in HTML pages using one of two elements: the
<code>&lt;link&gt;</code> element is used to include CSS from an
external file, the <code>&lt;style&gt;</code> element is used to specify
inline styles</li>
<li>Dynamic styles don't exist on the page when it is loaded initially,
they are added after the page has been loaded</li>
<li>Dynamic loading an external CSS file example <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;style.css&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> link = <span class="built_in">document</span>.createElement(<span class="string">&quot;link&quot;</span>);</span><br><span class="line">link.rel = <span class="string">&quot;stylesheet&quot;</span>;</span><br><span class="line">link.type = <span class="string">&quot;text/css&quot;</span>;</span><br><span class="line">link.href = <span class="string">&quot;style.css&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> head = <span class="built_in">document</span>.getElementsByTagName(<span class="string">&quot;head&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">head.appendChild(link); </span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Manipulating tables
<ul>
<li>Using the core DOM methods to create and change tables can require a
large amount of code</li>
<li>Example <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>content<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> table = <span class="built_in">document</span>.createElement(<span class="string">&quot;table&quot;</span>);</span><br><span class="line">table.border = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">table.width = <span class="string">&quot;100%&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> thead = <span class="built_in">document</span>.createElement(<span class="string">&quot;thead&quot;</span>);</span><br><span class="line">table.appendChild(thead);</span><br><span class="line"><span class="keyword">let</span> thr = <span class="built_in">document</span>.createElement(<span class="string">&quot;tr&quot;</span>);</span><br><span class="line">thead.appendChild(thr);</span><br><span class="line"><span class="keyword">let</span> th = <span class="built_in">document</span>.createElement(<span class="string">&quot;th&quot;</span>);</span><br><span class="line">thr.appendChild(th);</span><br><span class="line">th.appendChild(<span class="built_in">document</span>.createTextNode(<span class="string">&quot;Title&quot;</span>));</span><br><span class="line"><span class="keyword">let</span> tbody = <span class="built_in">document</span>.createElement(<span class="string">&quot;tbody&quot;</span>);</span><br><span class="line">table.appendChild(tbody);</span><br><span class="line"><span class="keyword">let</span> tbr = <span class="built_in">document</span>.createElement(<span class="string">&quot;tr&quot;</span>);</span><br><span class="line">tbody.appendChild(tbr);</span><br><span class="line"><span class="keyword">let</span> td = <span class="built_in">document</span>.createElement(<span class="string">&quot;td&quot;</span>);</span><br><span class="line">tbr.appendChild(td);</span><br><span class="line">td.appendChild(<span class="built_in">document</span>.createTextNode(<span class="string">&quot;content&quot;</span>));</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(table);</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
</ol>
<h1 id="dom-extensions">DOM Extensions</h1>
<ol type="1">
<li>Selectors API
<ul>
<li>Background
<ul>
<li>The DOM API is frequently augmented, in 2008 the W3C adopted some of
the DOM extensions into formal specifications</li>
<li>The two primary standards specifying DOM extensions are the
Selectors API and HTML5</li>
</ul></li>
<li>Introduction
<ul>
<li>One of the most popular capabilities of JavaScript libraries is the
ability to retrieve a number of DOM elements matching a pattern
specified using CSS selectors</li>
<li>The selectors API was started by the W3C to specify native support
for CSS queries in browsers</li>
<li>At the core of Selectors API level 1 are two methods:
<code>querySelector()</code> and <code>querySelectorAll()</code>, these
methods are available on the Document type and on the Element type</li>
<li>The Selectors API level 2 specifications introduces more methods:
<code>matches()</code>, <code>find()</code>, <code>findAll()</code> on
the Element type</li>
</ul></li>
<li>The <code>querySelector()</code> method
<ul>
<li>This method accepts a CSS query and returns the first descendant
element that matches the pattern or null if there is no matching
element</li>
<li>Example query strings: <code>tag</code>, <code>#id</code>,
<code>.class</code>, etc</li>
<li>When the method is used on the Document type, it starts trying to
match the pattern from the document element; when used on an Element
type, the query attempts to make a match from the descendants of the
element only</li>
</ul></li>
<li>The <code>querySelectorAll()</code> method
<ul>
<li>This method accepts a CSS query and returns a NodeList object
regardless of the number of matching elements, if there are not matches,
the NodeList is empty</li>
<li>Can work on Document, DocumentFragment and Element</li>
</ul></li>
<li>The <code>matches()</code> method
<ul>
<li>This method accepts a single argument, a CSS selector, and returns
true if the given element matches the selector or false if not</li>
<li>All major browsers support some form of matches()</li>
</ul></li>
</ul></li>
<li>HTML5
<ul>
<li>All HTML specifications before HTML5 were short of any JavaScript
interfaces, all JavaScripts were binding to the DOM specification. The
HTML5 specification contains a large amount of JavaScript APIs designed
for use with the markup additions, part of these APIs overlap with the
DOM and define DOM extensions that browsers should provide</li>
<li>Class-related additions
<ul>
<li>The <code>getElementByClassName()</code> method
<ul>
<li>This method can be called on the Document object and on all HTML
elements</li>
<li>Accepts a single string containing one or more class names, returns
a NodeList containing all elements that have all of the the specified
classes applied, if multiple class names are specified, the order is
unimportant</li>
</ul></li>
<li>The <code>classList</code> property
<ul>
<li>This property is used to add, remove, and replace class names</li>
<li>The classList property is an instance of a collection named
<code>DOMTokenList</code>, it has the following methods:
<code>add(value)</code>, <code>contains(value)</code> returns boolean,
<code>remove(value)</code>, <code>toggle(value)</code> remove if
present, add if not present <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;myDiv&quot;</span> <span class="attr">class</span>=<span class="string">&quot;bd user disabled&quot;</span>&gt;</span>content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> div = <span class="built_in">document</span>.getElementById(<span class="string">&quot;myDiv&quot;</span>);</span><br><span class="line">div.classList.</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
<li>Focus management
<ul>
<li><code>document.activeElement</code> contains a pointer to the DOM
element that currently has focus, an element can receive focus
automatically as the page is loading, via user input, or
programmatically using the <code>focus()</code> method
<ul>
<li>When the document is first loaded,
<code>document.activeElement</code> is set to
<code>document.body</code></li>
<li>When the document is being loaded,
<code>document.activeElement</code> is null</li>
</ul></li>
<li><code>document.hasFocus()</code> returns true if the document has
focus or false if not</li>
</ul></li>
<li>Changes to HTMLDocument
<ul>
<li>The <code>readyState</code> property
<ul>
<li>Used to indicate whether the document has been loaded</li>
<li>The property has two values: <code>loading</code>,
<code>complete</code></li>
</ul></li>
<li>The <code>compatMode</code> property
<ul>
<li>Used on the document object to indicate which rendering mode the
browser is in</li>
<li>When a browser is in standards mode,
<code>document.compatMode = CSS1Compat</code>, when a browser is in
quirks mode, <code>document.compatMode = BackCompat</code></li>
</ul></li>
<li>The <code>head</code> property: <code>document.head</code> points to
the <code>&lt;head&gt;</code> element of a document</li>
</ul></li>
<li>Character set properties
<ul>
<li>The <code>document.characterSet</code> property indicates the actual
character being used by the document and can also be used to specify a
new character set and can also be used to specify a new character
set</li>
<li>The default value is <code>UTF-16</code></li>
</ul></li>
<li>Custom data attributes
<ul>
<li>HTML allows elements to be specified with nonstandard attributes
prefixed with <code>data-</code> in order to provide information that
isn't necessary to the rendering or semantic value of the element</li>
<li>Example:
<code>&lt;div id="myDiv" data-infoId="myDivInfo" data-nyName="divExp"&gt;Content&lt;/div&gt;</code></li>
<li>The customized data attributes can be accessed via the
<code>dataset</code> property of the element, example:
<code>div.dataset.infoId</code></li>
</ul></li>
<li>Markup insertion
<ul>
<li>The <code>innerHTML</code> property
<ul>
<li>When used in read mode, innerHTML returns the HTML representing all
of the child nodes, including elements, comment,s and text nodes. When
used in write mode, innerHTML completely replaces all of the childe node
in the element with a new DOM subtree based on the given HTML string
input</li>
</ul></li>
<li>In modern browsers, <code>&lt;script&gt;</code> elements cannot be
executed in innerHTML， the <code>&lt;style&gt;</code> elements causes
similar problems with innerHTML</li>
<li>The <code>outerHTML</code> property
<ul>
<li>When outerHTML is called in read mode, it returns the HTML of the
element on which it is called, as well as its child nodes. When called
in write mode, outerHTML replaces the node on which it is called with
the DOM subtree created from parsing the given HTML string</li>
</ul></li>
<li><code>insertAdjacentHTML(pos, text)</code> and
<code>insertAdjacentText(pos, text)</code>, the position can be one of
the following:
<ul>
<li><code>beforebegin</code>: insert just before the element as a
previous sibling</li>
<li><code>afterbegin</code>: insert inside the element as a new child or
series of children before the first child</li>
<li><code>beforeend</code>: insert inside the element as a new child or
series of children after the last child</li>
<li><code>afterend</code>: insert just after the element as a next
sibling</li>
</ul></li>
<li>The <code>scrollIntoView()</code> method
<ul>
<li>The method exists on all HTML elements and scrolls the browser
window or container element so the element is visible in the
viewport</li>
<li>Variations: <code>element.scrollIntoView()</code>,
<code>element.scrollIntoView(alignToTop)</code>,
<code>element.scrollIntoView(scrollIntoViewOptions)</code>
<ul>
<li>boolean alignToTop: if true, the element is scrolled to the top of
the viewport, otherwise the bottom</li>
<li>object options: with property <code>behavior</code>,
<code>block</code>, <code>inline</code></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li>Proprietary extension
<ul>
<li>The <code>children</code> property: returns an HTMLCollection that
contains only an element's child nodes that are also elements</li>
<li>The <code>contains</code> method: check if two nodes have parental
relationship</li>
<li>Markup insertion
<ul>
<li>The <code>innerText</code> property
<ul>
<li>When used to read the value, innerText concatenates the values of
all text nodes in the subtree in DFS order</li>
<li>When used to write the value, removes all children of the element
and inserts a text node containing the given value</li>
</ul></li>
<li>The <code>outerText</code> property
<ul>
<li>For reading text values, outerText and innerText essentially behave
in the same way, in writing mode, outerText replaces the entire element,
including child nodes</li>
</ul></li>
</ul></li>
<li>Scrolling
<ul>
<li>Scrolling specification didn't exist prior to HTML5</li>
<li>Apart from <code>scrollIntoView()</code>, you can use
<code>scrollIntoViewIfNeeded()</code></li>
</ul></li>
</ul></li>
</ol>
<h1 id="dom-levels-2-and-3">DOM Levels 2 and 3</h1>
<ol type="1">
<li>Introduction
<ul>
<li>DOM levels 2 and 3 consist of several modules
<ul>
<li>DOM Core: builds on level 1 core, adding methods and properties to
nodes</li>
<li>DOM Views: defined different views for a document based on stylistic
information</li>
<li>DOM Events: defines how to tie interactivity to DOM documents using
events</li>
<li>DOM Style: defines how to programmatically access and changes CSS
styling information</li>
<li>DOM Traversal and Range: introduces new interfaces for traversing a
DOM document and selecting specific parts of it</li>
<li>DOM HTML: builds on the level 1 HTML, adding properties, methods and
interfaces</li>
<li>DOM Mutation Observers: allows for definition of callbacks upon
changes to the DOM</li>
</ul></li>
</ul></li>
<li>DOM changes
<ul>
<li>Backgrounds
<ul>
<li>The DOM levels 2 and 3 Core is to expand the DOM API, for the most
part, this means supporting the concept of XML namespaces</li>
<li>The DOM Views and DOM HTML augment DOM interfaces, they are fairly
small</li>
</ul></li>
<li>XML namespaces
<ul>
<li>XML namespaces allow elements from different XML-based language to
be mixed together in a single, well-formed document without fear of
element name clashes. XML namespaces are not supported by HTML but
supported in XHTML</li>
<li>Namespaces are specified using the <code>xmlns</code> attribute and
should be included on the <code>&lt;html&gt;</code> element of any
well-formed XHTML page</li>
<li>Changes to Node: add <code>localName</code>,
<code>namespaceURL</code>, <code>prefix</code> properties</li>
<li>Changes to Document: add
<code>createElementNS(namespaceURL, tagName)</code>,
<code>createAttributeNS(nameSpaceURL, attributeName)</code>,
<code>getElementsByTagNameNS(namespaceURL, tagName)</code> methods</li>
<li>Changes to Element: add
<code>getAttributeNS(namespaceURL, attributeName)</code>,
<code>setAttributeNS(namespaceURL, attributeName, value)</code>,
<code>removeAttributeNS(namespaceURL, attributeName)</code> methods</li>
</ul></li>
</ul></li>
<li>Styles
<ul>
<li>Styles are defined in HTML in three ways, including an external
style sheet via the <code>&lt;link&gt;</code> element, defining inline
styles using the <code>&lt;style&gt;</code> element, and defining
element specific styles using the <code>style</code> attribute. DOM
levels 2 Styles provide an API around all three of these styling
mechanisms</li>
<li>Accessing element styles
<ul>
<li>Any HTML elements that supports the style attribute also has a style
property exposed in JavaScript, which is an instance of
<code>CSSStyleDeclaration</code> and contains all stylistic information
specified by the HTML style attribute but no information about styles
that have cascaded from either included or inline style sheets</li>
<li>CSS property names use dash case, the names must be converted to
camel case to be used in the JavaScript API, for example,
<code>background-color</code> becomes <code>backgroundColor</code></li>
<li>Example <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;myDiv&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: red;&quot;</span>&gt;</span>Content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> div = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myDiv&#x27;</span>);</span><br><span class="line">div.style.backgroundColor; <span class="comment">// &#x27;red&#x27;</span></span><br><span class="line">div.style.height = <span class="string">&quot;100px&quot;</span>;</span><br><span class="line">div.style.width = <span class="string">&quot;100px&quot;</span>;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Working with style sheets
<ul>
<li>The <code>CSSStyleSheet</code> type represents a CSS style sheet as
included using a <code>&lt;link&gt;</code> element or defined in a
<code>&lt;style&gt;</code> element</li>
<li>The CSSStyleSheet type inherits from StyleSheet, which can be used
to define non-CSS style sheets</li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> styles = <span class="built_in">document</span>.styleSheets[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">let</span> rules = styles.cssRules;</span><br><span class="line"><span class="keyword">let</span> r0 = rules[<span class="number">0</span>];</span><br><span class="line"><span class="built_in">console</span>.log(r0.selectorText); <span class="comment">// the selector text for the first rule</span></span><br><span class="line"><span class="built_in">console</span>.log(r0.cssText); <span class="comment">// the CSS text for the first rule</span></span><br><span class="line"><span class="built_in">console</span>.log(r0.style.backgroundColor); <span class="comment">// the background color for the first rule</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Element dimensions
<ul>
<li>Offset dimensions
<ul>
<li>The offset dimensions incorporate all of the visual space that an
element takes up on the screen <img src="/images/JSReview/offsetDimension.png"></li>
<li>Properties: <code>offsetHeight</code>, <code>offsetWidth</code>,
<code>offsetTop</code>, <code>offsetLeft</code>,
<code>offsetParent</code>. The offsetLeft and offsetTop properties are
in relation to the containing element, which is stored in the
<code>offsetParent</code> property. The offsetParent may not necessarily
be the same as the parentNode</li>
</ul></li>
<li>Client dimensions
<ul>
<li>The client dimensions of an element comprise the space occupied by
the element's content and its padding</li>
<li>Properties: <code>clientWidth</code>, and <code>clientHeight</code>
<img src="/images/JSReview/clientDimension.png"></li>
</ul></li>
<li>Scroll dimensions
<ul>
<li>The scroll dimension provide information about an element whose
content is scrolling</li>
<li>Properties: <code>scrollHeight</code>, <code>scrollLeft</code>,
<code>scrollTop</code>, <code>scrollWidth</code> <img src="/images/JSReview/scrollDimension.png"></li>
</ul></li>
</ul></li>
</ul></li>
<li>Traversals
<ul>
<li>The DOM level 2 Traversal and Range module defined two types that
aid in sequential traversal of a DOM structure. The types,
<code>NodeIterator</code> and <code>TreeWalker</code>, perform
depth-first traversals of a DOM structure given a certain starting
point</li>
<li><code>NodeIterator</code>
<ul>
<li>The NodeIterator type can be instantiated using the
<code>document.createNodeIterator(root, whatToShow, filter, entityReferenceExpansion)</code>
method
<ul>
<li><code>root</code> is the node in the tree that you want to start
searching from</li>
<li><code>whatToShow</code> is a numerical code indicating which nodes
should be visited, it can be <code>NodeFilter.SHOW_ALL</code>,
<code>NodeFilter.SHOW_ELEMENT</code>,
<code>NodeFilter.SHOW_ATTRIBUTE</code>,
<code>NodeFilter.SHOW_TEXT</code>,
<code>NodeFilter.SHOW_CDATA_SECTION</code>,
<code>NodeFilter.SHOW_ENTITY_REFERENCE</code>,
<code>NodeFilter.SHOW_ENTITY</code>,
<code>NodeFilter.SHOW_PROCESSING_INSTRUCTION</code>,
<code>NodeFilter.SHOW_COMMENT</code>,
<code>NodeFilter.SHOW_DOCUMENT</code>,
<code>NodeFilter.SHOW_DOCUMENT_TYPE</code>,
<code>NodeFilter.SHOW_DOCUMENT_FRAGMENT</code>,
<code>NodeFilter.SHOW_NOTATION</code></li>
<li><code>filter</code> is a NodeFilter object or a function indicating
whether a particular node should be accepted or rejected</li>
<li><code>entityReferenceExpansion</code> is a boolean indicating
whether entity reference nodes should be expanded or not</li>
</ul></li>
<li>Example usage <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> div = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myDiv&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> iterator = <span class="built_in">document</span>.createNodeIterator(div, NodeFilter.SHOW_ELEMENT, <span class="literal">null</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> prev = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">let</span> node = iterator.nextNode();</span><br><span class="line"><span class="keyword">while</span> (node != <span class="literal">null</span>) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(node.nodeName);</span><br><span class="line">  node = iterator.nextNode();</span><br><span class="line">  prev = node.previousNode();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li><code>TreeWalker</code>
<ul>
<li>TreeWalker is a more advanced version of NodeIterator</li>
<li>Methods: <code>nextNode()</code>, <code>previousNode()</code>,
<code>parentNode()</code>, <code>firstChild()</code>,
<code>lastChild()</code>, <code>nextSibling()</code>,
<code>previousSibling()</code></li>
<li>A TreeWalker object is created using the
<code>document.createTreeWalker(root, whatToShow, filter, entityReferenceExpansion)</code>
method</li>
</ul></li>
</ul></li>
<li>Ranges
<ul>
<li>The DOM level 2 Traversal and Range module defined an interface
called a range to allow for greater control over a page. A range can be
used to select a section of a document regardless of node
boundaries</li>
<li>Create a range object:
<code>let range = document.createRange()</code></li>
<li>Some properties: <code>startContainer</code>,
<code>startOffset</code>, <code>endContainer</code>,
<code>endOffset</code>, <code>commonAncestorContainer</code></li>
<li>Simple selection in DOM ranges <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;p1&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">b</span>&gt;</span> world!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> range1 = <span class="built_in">document</span>.createRange();</span><br><span class="line"><span class="keyword">let</span> range2 = <span class="built_in">document</span>.createRange();</span><br><span class="line"><span class="keyword">let</span> p1 = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;p1&#x27;</span>);</span><br><span class="line">range1.selectNode(p1); <span class="comment">// range1 contains p1 and its contents</span></span><br><span class="line">range2.selectNodeContents(p1); <span class="comment">// range2 contains only contents of p1: &lt;b&gt;Hello&lt;/b&gt; world!</span></span><br></pre></td></tr></table></figure></li>
<li>Complex selection in DOM ranges
<ul>
<li>Creating complex ranges requires the use of
<code>setStart(node, offset)</code> and
<code>setEnd(node, offset)</code> methods <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;p1&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">b</span>&gt;</span> world!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> range1 = <span class="built_in">document</span>.createRange();</span><br><span class="line"><span class="keyword">let</span> range2 = <span class="built_in">document</span>.createRange();</span><br><span class="line"><span class="keyword">let</span> p1 = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;p1&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> p1Index = -<span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> len = p1.parentNode.childNodes.length;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">  <span class="keyword">if</span> (p1.parentNode.childNodes[i] === p1) &#123;</span><br><span class="line">    p1Index = i;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// range1 contains p1 and its contents</span></span><br><span class="line">range1.setStart(p1.parentNode, p1Index); </span><br><span class="line">range1.setEnd(p1.parentNode, p1Index + <span class="number">1</span>);</span><br><span class="line"><span class="comment">// range2 contains only contents of p1: &lt;b&gt;Hello&lt;/b&gt; world!</span></span><br><span class="line">range2.setStart(p1, <span class="number">0</span>);</span><br><span class="line">range2.setEnd(p1, p1.childNodes.length); </span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
</ol>
<h1 id="events">Events</h1>
<ol type="1">
<li>Introduction
<ul>
<li>JavaScript's interaction with HTML is handled through events, which
indicate when particular moments on interest occur in the document or
browser window</li>
<li>Events can be subscribed using listeners(aka handlers) that execute
only when an event occurs. This model, called the observer pattern in
traditional software engineering, allows a loose coupling between the
behavior of a page and the appearance of the page</li>
<li>DOM level 2 was the first attempt to standardize the DOM events API
in a logical way, all modern browsers have implemented the core parts of
DOM level 2 events</li>
</ul></li>
<li>Event flow
<ul>
<li>Event flow describes the order in which events are received on the
page(say, you click a button inside a div, will the button or the div
receive the click event first?). The IE and Netscape developer teams
came up with an almost opposite concept of event flow: IE supports the
event bubbling flow, whereas Netscape Communicator supports the event
capturing flow</li>
<li>Event bubbling
<ul>
<li>The IE event flow is called event bubbling because an event starts
at the most specific element and then flow upward toward the least
specific node</li>
<li>All modern browsers support event bubbling, although implementation
details vary, modern browsers continue event bubbling up to the window
object</li>
</ul></li>
<li>Event capturing
<ul>
<li>The Netscape communicator came up with the event capturing flow, in
which the least specific node should receive the event first and the
most specific node should receive the event last</li>
<li>Event capturing was designed to intercept the event before it
reached the intended target</li>
<li>All modern browsers support event capturing, all of them begin event
capturing at the window-level event despite the fact that the DOM level
2 event specification indicates that the events should begin at
document</li>
</ul></li>
<li>DOM event flow
<ul>
<li>The event flow specified by DOM level 2 events has three phases: the
event capturing phase (providing the opportunity to intercept events if
necessary), at the target, and the event bubbling phase (allowing a
final response to the event)</li>
</ul></li>
</ul></li>
<li>Event handlers
<ul>
<li>Events are certain actions performed either by the user or by the
browser itself. A function that is called in response to an event is
called an event handler (event listener). Event handlers have names
beginning with "on" (onclick)</li>
<li>HTML event handlers
<ul>
<li>Each event supported by a particular element can be assigned using
an HTML attribute with the name of the event handler, and the value of
the attribute should be some JavaScript code to execute
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// Approach 1</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Click me!&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;console.log(&#x27;Clicked!&#x27;)&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">// Approach 2: code executing as an event handler has access to everything in the global scope</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="keyword">function</span> <span class="title">showMessage</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">&quot;Clicked&quot;</span>);</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Click me!&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;showMessage()&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>When the event handler is assigned as a property, you can access the
<code>event</code> local variable (say,
<code>console.log(event.type)</code>), meanwhile, <code>this</code> is
also equivalent to the event's target element (say,
<code>console.log(this.value)</code>)</li>
</ul></li>
<li>DOM level 0 event handlers
<ul>
<li>The traditional way of assigning event handlers in JavaScript is to
assign a function to an event handler property <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&quot;myBtn&quot;</span>);</span><br><span class="line">btn.onclick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Clicked!&quot;</span>);</span><br><span class="line">  alert(<span class="string">&quot;Clicked&quot;</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>.id); <span class="comment">// myBtn, this refers to the element itself</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Since the event handler is considered to be a method of the element
using the DOM level 0 method, the value of <code>this</code> is the
element itself</li>
</ul></li>
<li>DOM level 2 event handlers
<ul>
<li>DOM level 2 events define two methods to deal with the assignment
and removal of event handlers: <code>addEventListener()</code> and
<code>removeEventListener()</code>. These methods exist on all DOM nodes
and accept three arguments: the event name to handle, the event handler
function, and a boolean value indicating whether to call the event
handler during the capture phase (true) or during the bubble
phase(false), the third argument is optional and defaults to false
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// add an onclick event handler in the bubble phase</span></span><br><span class="line"><span class="keyword">let</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&quot;myBtn&quot;</span>);</span><br><span class="line">btn.addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Clicked!&quot;</span>);</span><br><span class="line">&#125;, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Internet Explorer event handlers
<ul>
<li>IE implements methods similar to the DOM called
<code>attachEvent()</code> and <code>detachEvent()</code>, both accepts
two arguments: the event handler name and the event handler
function</li>
<li>IE 8 and earlier support only event bubbling, event handlers added
using <code>attachEvent()</code> are attached on the bubbling phase</li>
<li>A major difference between using <code>attachEvent()</code> and
using the DOM level 0 approach in IE is the scope of the event handler.
When using DOM level 0, the event handler runs with a this value equal
to the element on which it is attached; when using
<code>attachEvent()</code>, the event handler runs in global context, so
this is equivalent to window <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&quot;myBtn&quot;</span>);</span><br><span class="line">btn.attachEvent(<span class="string">&quot;onclick&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Clicked!&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Cross-browser event handler
<ul>
<li>To make sure that the event-handling code works in the most
compatible way possible, you will need it to work only on the bubbling
phase</li>
</ul></li>
</ul></li>
<li>The event object
<ul>
<li>Introduction
<ul>
<li>When an event related to the DOM is fired, all of the relevant
information is gathered and stored on an object called event</li>
<li>The event object contains basic information such as the element that
caused the event, the type of event that occurred, and any other data
that may be relevant to the particular event</li>
<li>All browsers support the event object, though not in the same
way</li>
</ul></li>
<li>The DOM event object
<ul>
<li>In DOM-compliant browsers, the event object is passed in as the sole
argument to an event handler</li>
<li>Some properties:
<ul>
<li><code>event.bubbles</code>: boolean, indicate if the event
bubbles</li>
<li><code>event.currentTarget</code>: element, the element whose event
handler is currently handling the event, equal to this</li>
<li><code>event.target</code>: element, the target of the event</li>
<li><code>event.type</code>: string, the type of event that was
fired</li>
</ul></li>
</ul></li>
<li>The IE event object
<ul>
<li>The legacy IE event object is accessible in different ways, based on
the way in which the event handler was assigned</li>
<li>If the handler is assigned using the DOM level 0 approach, the event
object exists only as a property of the window object
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&quot;myBtn&quot;</span>);</span><br><span class="line">btn.onclick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> event = <span class="built_in">window</span>.event;</span><br><span class="line">  <span class="built_in">console</span>.log(event.typ);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>If the handlers is assigned using attachEvent(), the event object is
passed in as the sole argument to the function <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&quot;myBtn&quot;</span>);</span><br><span class="line">btn.attachEvent(<span class="string">&quot;onclick&quot;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(event.type);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Some properties: <code>event.type</code>,
<code>event.returnValue</code>, <code>event.srcElement</code></li>
</ul></li>
<li>The Cross-browser event object
<ul>
<li>All of the information and capabilities of the IE event object are
present in the DOM object, just in a different form. These parallels
enable easy mapping form one event model to the other</li>
</ul></li>
</ul></li>
<li>Event types
<ul>
<li>DOM level 3 events specify the following event groups:
<ul>
<li>User interface (UI) events: general browser events that may have
some interaction with the BOM</li>
<li>Focus events: fired when an elements gains or loses focus</li>
<li>Mouse events: fired when the mouse is used to perform an action on a
page</li>
<li>Wheel events: fired when a mouse wheel or similar device is
used</li>
<li>Text events: fired when text is input into the document</li>
<li>Keyboard events: fired when the keyboard is used to perform an
action on the page</li>
<li>Composition events: fired when inputting characters for an Input
Method Editor (IME)</li>
</ul></li>
<li>UI events
<ul>
<li>UI events are not necessarily related to user actions</li>
<li>The <code>load</code> event
<ul>
<li>Fired on a window object when the entire page has been loaded,
including all external resources such as images, JS files, and CSS
files</li>
<li><code>onload</code> handler
<ul>
<li>The first approach: define an event handler for the
<code>load</code> event using JavaScript <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Style 1</span></span><br><span class="line"><span class="built_in">window</span>.onload = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Page loaded&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Style 2</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&quot;load&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Page loaded&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
<li>The second approach: add an onload attribute to the
<code>&lt;body&gt;</code> element <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="keyword">function</span> <span class="title">loadHandler</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">&quot;Page loaded&quot;</span>);</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">&quot;loadHandler()&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
<li>The <code>unload</code> event
<ul>
<li>Fired on the window object when a document has completely unloaded,
typically fired when navigating from one page to another and is most
often used to clean up references to avoid memory leaks</li>
<li>Can be assigned using JavaScript or the <code>unload</code>
attribute on the <code>&lt;body&gt;</code> element</li>
</ul></li>
<li>The <code>resize</code> event
<ul>
<li>Fired on the window object when the browser windows is resized to a
new height or width</li>
<li>Can be assigned using JavaScript or the <code>resize</code>
attribute on the <code>&lt;body&gt;</code> element, prefer to use the
JavaScript approach</li>
<li>You should make the resize event handler as simple as possible
<ul>
<li>IE, Safari, Chrome, and Opera fire the resize event as soon as the
browser isw resized by one pixel and then repeatedly as the user resizes
the browser window</li>
<li>Firefox fires the resize event only once when the user stops
resizing the browser window</li>
</ul></li>
</ul></li>
<li>The <code>scroll</code> event
<ul>
<li>Even though the scroll event occurs on the window, it actually
refers to changes in the appropriate page-level element</li>
<li>In quirk mode, the changes are observed using the
<code>scrollLeft</code> and <code>scrollTop</code> of the
<code>&lt;body&gt;</code> element, in standards mode, the changes occur
on the <code>&lt;html&gt;</code> element in all browsers except
Safari</li>
<li>Similar to the resize event, the scroll event is repeatedly
executed, so it should be computationally efficient</li>
</ul></li>
</ul></li>
<li>Focus events
<ul>
<li>Focus events work in concert with the
<code>document.hasFocus()</code> and <code>document.activeElement</code>
properties to give insight as to how the user is navigating the
page</li>
<li>The six focus events
<ul>
<li><code>blur</code>: fired when an element has lost focus, does not
bubble and is supported in all browsers</li>
<li><code>DOMFocusIn</code>: fired when an element has received focus,
this is a bubbling version of the focus HTML event, only Opera supports
this event, DOM level 3 events deprecate DOMFocusIn in favor of
focusin</li>
<li><code>DOMFocusOut</code>: fired when an element has lost focus, this
is a bubbling version of the blur HTML event, only Opera supports this
event, DOM level 3 events deprecate DOMFocusOut in favor of
focusout</li>
<li><code>focus</code>: fired when an element has received focus, does
not bubble and is supported in all browsers</li>
<li><code>focusin</code>: fired when an element has received focus, this
is a bubbling version of the focus HTML event</li>
<li><code>focusout</code>: fired when an element has lost focus, this is
a bubbling version of the blur HTML event</li>
</ul></li>
</ul></li>
<li>Mouse and Wheel events
<ul>
<li>Mouse events are the most commonly used group of events on the Web,
because mouse is the primary navigation device used</li>
<li>There are 9 mouse events defined in DOM level 3 events:
<ul>
<li><code>click</code>: fired when the user clicks the primary mouse
button or when the user presses the Enter key, <code>onclick</code> can
be executed using the keyboard and the mouse</li>
<li><code>dblclick</code>: fired when the user double-clicks the primary
mouse button</li>
<li><code>mousedown</code>: fired when the user pushes any mouse button
down, cannot be fired via the keyboard</li>
<li><code>mouseenter</code>: fired when the mouse cursor is outside of
an element and then the user first moves it inside of the boundaries of
the element, this event does not bubble and is not fired when the cursor
moves over descendant elements</li>
<li><code>mouseleave</code>: fired when the mouse cursor is inside of an
element and then the user moves it outside of the boundaries of the
element, this event does not bubble and is not fired when the cursor
moves over descendant elements</li>
<li><code>mousemove</code>: fired repeatedly as the cursor is being
moved aro7und an element, cannot be fired via the keyboard</li>
<li><code>mouseout</code>: fired when the mouse cursor is over an
element and then the user moves it over another element, the element
moved to may be outside of the bounds of the original element or a child
of the original element, this event cannot be fired via the
keyboard</li>
<li><code>mouseover</code>: fired when the mouse cursor is outside of an
element and then the user first moves it inside of the boundaries of the
element, this event cannot be fired via the keyboard</li>
<li><code>moustup</code>: fired when the user releases a mouse button,
this event cannot be fired via the keyboard</li>
</ul></li>
<li>All elements on a page support mouse, all mouse events bubble except
mouseenter and mouseleave, and they can be canceled, which affects the
default behavior of the browser</li>
<li>There is also a subgroup of mouse events called wheel events: wheel
events are really just a single event, <code>moustwheel</code>, which
monitors interactions of a mouse wheel or a similar device such as the
Mac trackpad</li>
</ul></li>
<li>Keyboard and text events
<ul>
<li>There are 3 keyboard events:
<ul>
<li><code>keydown</code>: fired when the user presses a key on the
keyboard and fired repeatedly while the key is being held down</li>
<li><code>keypress</code>: fired when the user presses a key on the
keyboard that results in a character and fired repeatedly while the key
is being held down, deprecated in DOM level 3 events in favor of the
textInput event</li>
<li><code>keyup</code>: fired when the user releases a key on the
keyboard</li>
</ul></li>
<li>All elements support the 3 keyboard events, when the uses press a
character key, the keydown is fired first, then the keypress, and
finally the keyup event</li>
<li>1 text event: <code>textInput</code>, an augmentation of the
keypress event, fired just before text is inserted into a text box</li>
<li>Key codes: for keydown and keyup events, the
<code>event.keyCode</code> property contains an integer code that maps
to a specific key on the keyboard</li>
<li>Character codes: for keypress events, the
<code>event.charCode</code> property contains an integer code that maps
to a specific character on the keyboard</li>
<li>TextInput properties
<ul>
<li><code>event.data</code>: contains the input text</li>
<li><code>event.inputMethod</code>: contains an integer code that maps
to the input method used to insert the text</li>
</ul></li>
</ul></li>
<li>Composition events
<ul>
<li>Composition events were first introduced in DOM level 3 to handle
complex inpu8t sequences</li>
<li>There are 3 composition events
<ul>
<li><code>compositionstart</code>: fired when the text composition
system of the IME is opened, indicating that input is about to
commence</li>
<li><code>compositionupdate</code>: fired when a new character has been
inserted into the input field</li>
<li><code>compositionend</code>: fired when the text composition system
is closed, indicating a return to normal keyboard input</li>
</ul></li>
</ul></li>
<li>HTML5 events
<ul>
<li>The DOM specification doesn't covert all events that are supported
by all browsers, HTML5 has an exhaustive list of all events that should
be supported by browsers</li>
<li>The <code>contextmenu</code> event
<ul>
<li>Context menu: right click on Windows, Ctrl+click on Mac</li>
<li>The contextmenu event is used to indicate when a context menu is
about to be displayed</li>
<li>The contextmenu event bubbles</li>
</ul></li>
<li>The <code>beforeunload</code> event
<ul>
<li>The beforeunload event is fired on the window and is intended to
give developers a way to prevent the page from being unloaded</li>
<li>This event cannot be canceled</li>
</ul></li>
<li>The <code>DOMContentLoaded</code> event
<ul>
<li>The load event may take a long time because it needs to wait the
entire page to be loaded, while the DOMContentLoaded event is fired when
the DOM tree is completely formed and without regard to other
resources</li>
</ul></li>
<li>The <code>readystatechange</code> event
<ul>
<li>This event is first defined by IE to provide information about the
loading state of the document or of an element</li>
<li>Each object that supports the readystatechange event has a
<code>object.readyState</code> property that can have five possible
string values: <code>uninitialized</code>, <code>loading</code>,
<code>loaded</code>, <code>interactive</code>,
<code>complete</code></li>
</ul></li>
<li>The <code>pageshow</code> and <code>pagehide</code> events
<ul>
<li>Firefox and Opera introduced a feature called the back-forward cache
(bfcache), designed to speed up page transitions when using the
browsers's Back and Forward buttons, the cache effectively keeps the
entire page in memory</li>
<li>The pageshow event is fired whenever a page is displayed, whether
from the bfcache or not. On a newly loaded page, pageshow is fired after
the load event, on a page in the bfcache, pageshow is fired as soon as
the pages's state has been completely restored</li>
<li>The pagehide event is fired whenever a page is unloaded from the
browser, immediately before the unload event</li>
</ul></li>
<li>The <code>hashchange</code> event
<ul>
<li>This event is used as a way to notify developers when the URL hash
has changed</li>
<li>The <code>onhashchnage</code> must be attached to the window object,
and it is called whenever the URL hash changes</li>
<li>The <code>event.oldURL</code> and <code>event.newURL</code>
properties are used during the process</li>
</ul></li>
</ul></li>
<li>Other events
<ul>
<li>Device events</li>
<li>Touch and gesture events</li>
</ul></li>
</ul></li>
<li>Memory and performance
<ul>
<li>Introduction
<ul>
<li>In JavaScript, the number of event handlers on a page directly
relates to the overall performance of the page, there are several
reasons:
<ul>
<li>Each function is an object and takes up memory</li>
<li>The amount of DOM access needed to assign all of the event handlers
up front delays the interactivity of the entire page</li>
</ul></li>
</ul></li>
<li>Event delegation
<ul>
<li>The solution to the too many event handlers issue is called the
event delegation, each delegation takes advantage of event bubbling to
assign a single event handler to manage all events of a particular type
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;myLinks&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;goSomewhere&quot;</span>&gt;</span>Go somewhere<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;doSomething&quot;</span>&gt;</span>Do something<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;sayHi&quot;</span>&gt;</span>Say Hi<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Multiple event handler approach</span></span><br><span class="line"><span class="keyword">let</span> item1 = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;goSomewhere&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> item1 = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;doSomething&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> item1 = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;sayHi&#x27;</span>);</span><br><span class="line"></span><br><span class="line">item1.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  location.href = <span class="string">&quot;https://www.google.com&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">item2.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">document</span>.title = <span class="string">&quot;New Title!&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">item3.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  alert(<span class="string">&quot;Hi!&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Single event handler approach</span></span><br><span class="line"><span class="keyword">let</span> links = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myLinks&#x27;</span>);</span><br><span class="line"></span><br><span class="line">links.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> target = event.target;</span><br><span class="line">  <span class="keyword">if</span> (target.id === <span class="string">&#x27;goSomewhere&#x27;</span>) &#123;</span><br><span class="line">    location.href = <span class="string">&quot;https://www.google.com&quot;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (target.id === <span class="string">&#x27;doSomething&#x27;</span>) &#123;</span><br><span class="line">    <span class="built_in">document</span>.title = <span class="string">&quot;New Title!&quot;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (target.id === <span class="string">&#x27;sayHi&#x27;</span>) &#123;</span><br><span class="line">    alert(<span class="string">&quot;Hi!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Removing event handlers
<ul>
<li>Another way to solve the too many event handlers issue is to remove
event handlers when they are no longer needed</li>
</ul></li>
</ul></li>
<li>Simulating events
<ul>
<li>JavaScript can be used to fire specific events at any time, and
those events are treated the same as events that are created by the
browser. This capability can be extremely useful in testing web
applications</li>
<li>DOM event simulation
<ul>
<li>An event object can be created at any time by using the
<code>document.createEvent(stringEventType)</code> method</li>
<li>The method argument can be <code>UIEvents</code>,
<code>MouseEvents</code>, or <code>HTMLEvents</code></li>
<li>Procedure
<ul>
<li>Create an event of a specific type</li>
<li>Initialize the event with appropriate properties</li>
<li>Fire the event with <code>node.dispatchEvent(event)</code>
method</li>
</ul></li>
</ul></li>
<li>IE event simulation
<ul>
<li>The logic are the same: create an event object, assign the
appropriate information, and then fire the event using the object</li>
<li>Use <code>document.createEventObject()</code> to create an event
object</li>
<li>You need to manually assign the properties of the event</li>
<li>Use <code>node.fireEvent(stringEventType, eventObject)</code> to
fire the event</li>
</ul></li>
</ul></li>
</ol>
<h1 id="animation-and-graphics-with-canvas">Animation and Graphics with
Canvas</h1>
<ol type="1">
<li>Introduction
<ul>
<li>The <code>&lt;canvas&gt;</code> tag introduced in HTML5 designates
an are of page where graphics can be created using JavaScript</li>
<li>All major browsers support <code>&lt;canvas&gt;</code> to some
degree</li>
<li><code>&lt;canvas&gt;</code> is made up of a few API sets, and not
all browsers support all API sets, there is a 2D context with basic
drawing capabilities and a 3D context called WebGL. The latest versions
of the supporting browsers now support both the 2D context and
WebGL</li>
</ul></li>
<li>Using <code>requestAnimationFrame</code>
<ul>
<li>For a long time, timers and intervals have been the state of the art
for JavaScript-based animations, while the
<code>requestAnimationFrame</code> API gained widespread adoption and is
now available across all major browsers</li>
<li>Early animation loops
<ul>
<li>The typical way to create animation in JavaScript is to use
<code>setInterval()</code> to manage all animations</li>
<li>The delay should be short enough to handle a variety of different
types smoothly but long enough so as to produce changes the browsers can
actually render. Since most monitors have a refresh rate of 60Hz, so the
best intervals should be 1000ms/60, or about 17ms</li>
<li>The problems is that the intervals are not precise, and the code may
be delayed</li>
</ul></li>
<li><code>requestAnimationFrame(callback)</code>
<ul>
<li>This method indicates to the browsers that some JavaScript code is
performing an animation, so the browser can optimize appropriately after
running some code</li>
<li>This method accepts a single argument, which is a function to call
prior to repainting the screen, you make appropriate changes to DOM
styles that will be reflected with the next repaint in the function</li>
</ul></li>
<li><code>cancelAnimationFrame(id)</code>: this method accepts a request
ID which can be used to cancel the request of repainting</li>
</ul></li>
<li>Basic canvas usage
<ul>
<li>The canvas element requires at least its <code>width</code> and
<code>height</code> attributes to be set in order to indicate the size
of the drawing to be created. Any content between the opening tag and
the closing tag is the backup data that is displayed only if the canvas
element is not supported <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">&quot;myDrawing&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200ox&quot;</span>&gt;</span>A drawing of nonsense! <span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>You need to retrieve a drawing context to begin drawing, you should
pass "2d" as the argument to retrieve 2D context <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> drawing = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myDrawing&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> context = drawing.getContext(<span class="string">&#x27;2d&#x27;</span>);</span><br></pre></td></tr></table></figure></li>
<li>Image created by canvas can be exported using the
<code>toDataURL()</code> method, the exported image is PNG by default,
you can use <code>drawing.toDataURL("image/jpeg")</code> to export a
JPEG for example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> drawing = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myDrawing&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> context = drawing.getContext(<span class="string">&#x27;2d&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (context) &#123;</span><br><span class="line">  <span class="keyword">let</span> image = drawing.toDataURL();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>The 2D context
<ul>
<li>Introduction
<ul>
<li>The 2D drawing context provides methods for drawing simple 2D
shapes</li>
<li>The coordinates in a 2D context begin at the upper-left corner of
the canvas element, which is considered to be (0, 0), with x increasing
to the right and y increasing toward to the bottom</li>
<li>The width and height indicate how many pixels are available in each
direction</li>
</ul></li>
<li>Fills and strokes
<ul>
<li>Fills and strokes are the two basic drawing operations</li>
<li>Fills automatically fills in the shape with specific color, strokes
colors only the edges</li>
<li>Fills and strokes are displayed based on the
<code>context.fillStyle</code> and <code>context.strokeStyle</code>
properties, both of which can be set using a string, a gradient object
or a pattern object</li>
</ul></li>
<li>Drawing rectangles:
<code>context.fillRect(x, y, width, height)</code>,
<code>strokeRect(x, y, width, height)</code>,
<code>clearRect(x, y, width, height)</code></li>
<li>Drawing paths:
<code>arc(x, y, radius, startAngle, endAngle, counterclockwise)</code>,
<code>arcTo(x1, y1, x2, y2, radius)</code>,
<code>bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y)</code>,
<code>ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise)</code>,
<code>lineTo(x, y)</code>, <code>moveTo(x, y)</code>,
<code>quadraticCurveTo(cpx, cpy, x, y)</code>,
<code>rect(x, y, width, height)</code></li>
<li>Drawing text: <code>fillText(text, x, y)</code>,
<code>strokeText(text, x, y)</code>, <code>measureText(text)</code></li>
<li>Transformations: <code>rotate(angle)</code>,
<code>scale(x, y)</code>, <code>translate(x, y)</code></li>
<li>Drawing images: <code>drawImage(image, x, y)</code></li>
<li>Shadows: <code>context.shadowColor</code>,
<code>context.shadOffsetX</code>, <code>context.shadowOffsetY</code>,
<code>context.shadowBlur</code></li>
</ul></li>
<li>The WebGL
<ul>
<li>WebGL is a 3D context for canvas, it's a web version of OpenGL ES
2.0</li>
<li>The context <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> drawing = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myDrawing&#x27;</span>);</span><br><span class="line"><span class="comment">// option is an object containing some properties, such as `alpha`, `depth`, `stencil`, `antialias`</span></span><br><span class="line"><span class="keyword">let</span> gl = drawing.getContext(<span class="string">&#x27;webgl&#x27;</span>, options);</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ol>
<h1 id="scripting-forms">Scripting Forms</h1>
<ol type="1">
<li>Form basics
<ul>
<li>Web forms are represented by the <code>&lt;form&gt;</code> element
in HTML and by the <code>HTMLFormElement</code> type (this type inherits
the <code>HTMLElement</code> type) in JavaScript</li>
<li>Some properties and methods
<ul>
<li><code>acceptCharset</code>: the character sets that the server can
process, HTML <code>accept-charset</code> attribute</li>
<li><code>action</code>: the URL to send the request to, HTML
<code>action</code> attribute</li>
<li><code>elements</code>: an HTMLCollection of all controls in the
form</li>
<li><code>enctype</code>: the encoding type of the request, HTML
<code>enctype</code> attribute</li>
<li><code>length</code>: the number of controls in the form</li>
<li><code>method</code>: the type of HTTP request to send, HTML
<code>method</code> attribute</li>
<li><code>name</code>: the name of the form, HTML <code>name</code>
attribute</li>
<li><code>reset()</code>: resets all form fields to their default
values</li>
<li><code>submit()</code>: submits the form</li>
<li><code>target</code>: the name of the window to use for sending the
request and receiving the response, HTML <code>target</code>
attribute</li>
</ul></li>
<li>Get a specific form
<ul>
<li>Using form id: <code>document.getElementById('myForm')</code></li>
<li>Using form index: <code>document.forms[index]</code></li>
<li>Using form name: <code>document.forms[name]</code></li>
</ul></li>
<li>Submitting forms
<ul>
<li>Forms are submitted when the user clicks the submit button</li>
<li>Submit methods:
<ul>
<li>Via input:
<code>&lt;input type="submit" value="Submit"&gt;</code></li>
<li>Via button:
<code>&lt;button type="submit"&gt; Submit &lt;/button&gt;</code></li>
<li>Via image:
<code>&lt;input type="image" src="submit.gif" alt="Submit"&gt;</code></li>
</ul></li>
<li>When a form is submitted, the submit event is fired before the
request is sent to the server, this gives you the opportunity to
validate the form data and decide whether to allow the form submission
to occur <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> form = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myForm&#x27;</span>);</span><br><span class="line">form.addEventListener(<span class="string">&#x27;submit&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 1. Prevent the form from being submitted first</span></span><br><span class="line">  event.preventDefault();</span><br><span class="line">  <span class="comment">// 2. Validate form inputs</span></span><br><span class="line">  <span class="comment">// some code here</span></span><br><span class="line">  <span class="comment">// 3. Submit the form</span></span><br><span class="line">  form.submit();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Resetting forms
<ul>
<li>Forms are rest when the user clicks the reset button</li>
<li>Reset methods
<ul>
<li>Via input:
<code>&lt;input type="reset" value="Reset"&gt;</code></li>
<li>Via button:
<code>&lt;button type="reset"&gt; Reset &lt;/button&gt;</code></li>
</ul></li>
<li>When a form is reset, the reset event is fired, which gives you the
opportunity to cancel the reset if necessary <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> form = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myForm&#x27;</span>);</span><br><span class="line">form.addEventListener(<span class="string">&#x27;reset&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 1. Prevent the form from being reset first</span></span><br><span class="line">  event.preventDefault();</span><br><span class="line">  <span class="comment">// 2. Validate form inputs</span></span><br><span class="line">  <span class="comment">// some code here</span></span><br><span class="line">  <span class="comment">// 3. Reset the form</span></span><br><span class="line">  form.reset();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Form fields
<ul>
<li>All form fields are parts of an <code>elements</code> collection
that is a property of each form, the elements collection is an ordered
list</li>
<li>Retrieve form fields <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> form = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myForm&#x27;</span>);</span><br><span class="line"><span class="comment">// get the first form field</span></span><br><span class="line"><span class="keyword">let</span> input0 = form.elements[<span class="number">0</span>];</span><br><span class="line"><span class="comment">// get the form field whose name is `myField`</span></span><br><span class="line"><span class="keyword">let</span> input1 = form.elements.myField;</span><br><span class="line"><span class="comment">// get the amount of form fields</span></span><br><span class="line"><span class="keyword">let</span> inputCount = form.elements.length;</span><br></pre></td></tr></table></figure> <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">id</span>=<span class="string">&quot;myForm&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;color&quot;</span> <span class="attr">value</span>=<span class="string">&quot;red&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;color&quot;</span> <span class="attr">value</span>=<span class="string">&quot;green&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;color&quot;</span> <span class="attr">value</span>=<span class="string">&quot;blue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> form = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myForm&#x27;</span>);</span><br><span class="line"><span class="comment">// since multiple fields have the same name, this return an HTMLCollection</span></span><br><span class="line"><span class="keyword">let</span> colors = form.elements[<span class="string">&quot;color&quot;</span>];</span><br><span class="line"><span class="comment">// this return the first field</span></span><br><span class="line"><span class="keyword">let</span> firstFormField = form.elements[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">let</span> colorFields = colors[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">let</span> firstColorField = colors[<span class="number">0</span>];</span><br><span class="line"><span class="built_in">console</span>.log(firstColorField == firstFormField); <span class="comment">// true</span></span><br></pre></td></tr></table></figure></li>
<li>Common form-field properties: <code>disabled</code> boolean,
<code>form</code> read-only, <code>name</code>, <code>readOnly</code>
boolean, <code>tabIndex</code>, <code>type</code>,
<code>value</code></li>
<li>The type property
<ul>
<li>For input elements, the type is equal to the HTML type
attribute</li>
<li>For other elements, the type is one of these:
<code>select-one</code>, <code>select-multiple</code>,
<code>submit</code>, <code>button</code>, <code>reset</code>,
<code>submit</code></li>
</ul></li>
<li>Common form-field methods: <code>focus()</code>,
<code>blur()</code></li>
<li>Common form-field events: <code>blur</code>, <code>change</code>,
<code>focus</code></li>
</ul></li>
</ul></li>
<li>Scripting text boxes
<ul>
<li>Two ways to represent text boxes in HTML: a single-line version
using <code>&lt;input&gt;</code> and a multiline version using
<code>&lt;textarea&gt;</code></li>
<li>The <code>&lt;input&gt;</code> text boxes
<ul>
<li>Default type is <code>text</code></li>
<li>The <code>size</code> attribute specifies the width of the text
box</li>
<li>The <code>value</code> attribute specifies the initial value of the
text box</li>
<li>The <code>maxlength</code> attribute specifies the maximum number of
characters allowed in the text box</li>
</ul></li>
<li>The <code>&lt;textarea&gt;</code> text boxes
<ul>
<li>The <code>rows</code> and <code>cols</code> attribute specifies the
size of the text boxes in number of characters'</li>
<li>The initial value is between <code>&lt;textarea&gt;</code> and
<code>&lt;/textarea&gt;</code></li>
<li>You cannot specify a <code>maxlength</code> attribute for
<code>&lt;textarea&gt;</code></li>
</ul></li>
<li>Text selection
<ul>
<li>Both text boxes support the <code>select()</code> method, which
selects all of the text in a text box, this method only selects the
text, it does not return the selected text</li>
<li>There is also a <code>select</code> event, which is fired when the
text is selected in a text box</li>
<li>There are two integer properties that can be used to determine the
selection range: <code>selectionStart</code> and
<code>selectionEnd</code></li>
</ul></li>
<li>HTML5 constraint validation API
<ul>
<li>HTML5 introduces the ability for browsers to validate data in forms
before submitting to the server, this capability enables basic
validation even when JavaScript is unavailable or fails to load</li>
<li>Required fields
<ul>
<li>Use the <code>required</code> attribute</li>
<li>Check if the browser supports the required attribute:
<code>"required" in document.createElement("tagName");</code></li>
<li>Different browsers behave differently when a form field is required
<ul>
<li>Chrome, Firefox, IE, and Opera prevent the form from submitting and
opo up a help box beneath the field</li>
<li>Safari does nothing and doesn't prevent the form from
submitting</li>
</ul></li>
</ul></li>
<li>Alternate input types
<ul>
<li>HTML5 introduces the ability to use different input types, for
example <code>email</code>, <code>password</code>, <code>url</code></li>
<li>These type attributes not only provide additional information about
the type of data expected but also provide some default validation</li>
<li>Check if certain type is supported <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> input = <span class="built_in">document</span>.createElement(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">input.type = <span class="string">&quot;typeName&quot;</span>;</span><br><span class="line"><span class="comment">// if the type is not supported, the type property will be `text`</span></span><br><span class="line"><span class="built_in">console</span>.log(input.type == <span class="string">&quot;typeName&quot;</span>);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Numeric ranges
<ul>
<li>Type values: <code>number</code>, <code>range</code>,
<code>datetime</code>, <code>datetime-local</code>, <code>date</code>,
<code>month</code>, <code>week</code>, <code>time</code></li>
<li>For these numeric types, you can specify the range and step using
the <code>min</code>, <code>max</code> and <code>step</code>
attributes</li>
<li>Some browsers do not support the above types, you should check
carefully before you use them</li>
</ul></li>
<li>Input patterns: use the <code>pattern</code> attribute to specify a
regular expression that the input must match</li>
<li>Checking validity
<ul>
<li>Use the <code>checkValidity()</code> method to check if any given
field on the form is valid</li>
<li>This method is provided on all elements and returns a boolean
value</li>
</ul></li>
<li>Disabling validation: use the <code>novalidate</code> attribute on
the form to disable validation</li>
</ul></li>
</ul></li>
<li>Scripting select boxes
<ul>
<li>Select boxes are created using the <code>&lt;select&gt;</code> and
<code>&lt;option&gt;</code> elements</li>
<li>The HTMLSelectElement type provides the following properties and
methods in addition to those that are available for all form fields
<ul>
<li><code>add(newOption, relOption)</code>: add a new option before the
related option</li>
<li><code>multiple</code>: a boolean value indicating if multiple
selections are allowed, equal to the HTML <code>multiple</code>
attribute</li>
<li><code>options</code>: an HTMLCollection of option elements in the
control</li>
<li><code>remove(index)</code>: removes the option in the given
position</li>
<li><code>selectedIndex</code>: 0-based index of the selected option or
-1 if no options are selected</li>
<li><code>size</code>: the number of rows visible in the select box,
equal to the HTML <code>size</code> attribute</li>
</ul></li>
<li>The type of a select box is either <code>select-one</code> or
<code>select-multiple</code></li>
<li>The value of the select box is determined using the following rules
<ul>
<li>If no option is selected, the value of the select box is an empty
string</li>
<li>If one option is selected and has a value attribute, then the value
of the select box is the value of the selected option</li>
<li>If one option is selected but does not have a value attribute, then
the value of the select box is the text of the selected option</li>
<li>If multiple options are selected, the value of the select box is the
value taken from the first option according to the rules above</li>
</ul></li>
<li>The <code>&lt;option&gt;</code> element
<ul>
<li>Each option element is represented in the DOM by an
HTMLOptionElement object</li>
<li>Properties: <code>index</code>, <code>value</code>,
<code>text</code>, <code>label</code>, <code>selected</code></li>
</ul></li>
<li>Getting the selected option <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> select = <span class="built_in">document</span>.getElementById(<span class="string">&quot;mySelect&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> selectedOption = select.options[select.selectedIndex];</span><br><span class="line"><span class="built_in">console</span>.log(selectedOption.text);</span><br></pre></td></tr></table></figure></li>
<li>Adding options <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> select = <span class="built_in">document</span>.getElementById(<span class="string">&quot;mySelect&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> newOption = <span class="built_in">document</span>.createElement(<span class="string">&quot;option&quot;</span>);</span><br><span class="line">newOption.text = <span class="string">&quot;New option&quot;</span>;</span><br><span class="line">newOption.value = <span class="string">&quot;new-value&quot;</span>;</span><br><span class="line">select.appendChild(newOption);</span><br></pre></td></tr></table></figure></li>
<li>Removing options <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> select = <span class="built_in">document</span>.getElementById(<span class="string">&quot;mySelect&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> optionToRemove = select.options[removeIndex];</span><br><span class="line">select.removeChild(optionToRemove);</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ol>
<h1 id="javascript-api">JavaScript API</h1>
<ol type="1">
<li><code>Atomics</code> and <code>SharedArrayBuffer</code>
<ul>
<li>A SharedArrayBuffer features an identical API to an ArrayBuffer, the
primary difference is that a reference to an ArrayBuffer must be handed
off between execution contexts, a reference to a SharedArrayBuffer can
be used simultaneously by any number of execution contexts</li>
<li>Sharing memory between multiple execution contexts means that
concurrent thread operations are possible, thus race condition is a
problem</li>
<li>The Atomics API was introduced to allow for thread-safe JavaScript
operations on a SharedArrayBuffer</li>
<li>Atomics basics
<ul>
<li>The Atomics object exists on all global contexts, and it exposes a
suite of static methods for performing thread-safe operations</li>
<li>The Atomics API offers a simple suite of methods for performing an
in-place modification called AtomicReadModifyWrite operations: read from
a location in the SharedArrayBuffer, modify the value at that location,
and write the new value back to the same location in the
SharedArrayBuffer</li>
<li>Methods: <code>Atomics.add</code>, <code>Atomics.sub</code>,
<code>Atomics.or</code>, <code>Atomics.and</code>,
<code>Atomics.xor</code>, ...</li>
<li>Atomic exchange: <code>Atomics.exchange</code>,
<code>Atomics.compareExchange</code></li>
</ul></li>
</ul></li>
<li>Cross-context messaging
<ul>
<li>Cross-document messaging (XDM), is the capability to pass
information between different execution contexts</li>
<li>The core method of XDM is the
<code>postMessage(msg, recipient[, options])</code> method
<ul>
<li><code>msg</code> is a string message</li>
<li><code>recipient</code> is a string indicating the intended recipient
origin</li>
<li><code>option</code>: an optional array of transferable objects</li>
</ul></li>
<li>The <code>message</code> event
<ul>
<li>The event is fired asynchronously on the window object when an XDM
message is received</li>
</ul></li>
</ul></li>
<li>Encoding API
<ul>
<li>The encoding API allows for converting between strings and typed
arrays</li>
<li>Related classes for conversions: <code>TextEncoder</code>,
<code>TextEncoderStream</code>, <code>TextDecoder</code>,
<code>TextDecoderStream</code></li>
<li>Encoding text
<ul>
<li>Two ways to convert a string into its typed array binary equivalent:
a <code>bulk</code> encoding, and a <code>stream</code> encoding</li>
<li>The encoder always uses UTF-8</li>
<li>Bulk encoding: the JavaScript engine synchronously encodes the
entire string</li>
<li>Bulk encoding is accomplished using an instance of a TextEncoder
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> textEncoder = <span class="keyword">new</span> TextEncoder();</span><br><span class="line"><span class="keyword">const</span> decodedText = <span class="string">&quot;foo&quot;</span>;</span><br><span class="line"><span class="comment">// this method returns an Unit8Array</span></span><br><span class="line"><span class="keyword">const</span> encodedText = textEncoder.encode(decodedText);</span><br><span class="line"><span class="comment">// returns an object with two properties</span></span><br><span class="line"><span class="comment">// res.read: the amount of characters encoded from decodedText</span></span><br><span class="line"><span class="comment">// res.written: the amount of characters encoded into encodedText</span></span><br><span class="line"><span class="keyword">const</span> res = textEncoder.encodeInto(decodedText, encodedText);</span><br></pre></td></tr></table></figure></li>
<li>Stream encoding: it accepts a decoded text stream into the
TextEncoderStream (it's simply a TextEncoder in the form of
TransformStream) and yields a stream of encoded text chunks</li>
</ul></li>
<li>Decoding text
<ul>
<li>Two ways to convert a typed array into its string equivalent: a
<code>bulk</code> decoding, and a <code>stream</code> decoding</li>
<li>Unlike the encoder classes, when going from typed array to string,
the decoder supports a large number of string encoding</li>
<li>Bulk decoding: the JavaScript engine synchronously decode the entire
string</li>
<li>Bulk decoding is accomplished using an instance of a DecoderEncoder
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> textDecoder = <span class="keyword">new</span> TextDecoder();</span><br><span class="line"><span class="comment">// f encoded in utf-8 is 0x66 (102), o encoded in utf-8 is 0x6f (111)</span></span><br><span class="line"><span class="keyword">const</span> encodedText = Unit8Array.of(<span class="number">102</span>, <span class="number">111</span>, <span class="number">111</span>);</span><br><span class="line"><span class="comment">// this method returns a string</span></span><br><span class="line"><span class="keyword">const</span> decodedText = textDecoder.decode(encodedText);</span><br><span class="line"><span class="comment">// returns an object with two properties</span></span><br><span class="line"><span class="comment">// res.read: the amount of characters decoded from encodedText</span></span><br><span class="line"><span class="comment">// res.written: the amount of characters decoded into decodedText</span></span><br><span class="line"><span class="keyword">const</span> res = textDecoder.decodeInto(encodedText, decodedText);</span><br></pre></td></tr></table></figure></li>
<li>Stream decoding: it accepts an encoded text stream into the
TextDecoderStream (it's simply a TextDecoder in the form of
TransformStream) and yields a stream of decoded text chunks</li>
</ul></li>
</ul></li>
<li>Blob and File APIs
<ul>
<li>History of interaction with file
<ul>
<li>The legacy way to interact with file in a form is to use the
<code>&lt;input type="file"&gt;</code> element</li>
<li>The Blob and File API were designed to allow web developers access
to files on the client computer in a secure manner that allows for
better interaction with those files</li>
</ul></li>
<li>The <code>File</code> type
<ul>
<li>The File API is still based on the file input filed of a form but
adds the ability to access the file information directly</li>
<li>The <code>files</code> collection in HTML5 contains a sequence of
<code>File</code> object, each object has several read-only attributes:
<code>name</code>, <code>size</code>, <code>type</code>,
<code>lastModifiedDate</code> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fileList = <span class="built_in">document</span>.getElementById(<span class="string">&quot;myFile&quot;</span>);</span><br><span class="line">fileList.addEventListener(<span class="string">&quot;change&quot;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> files = event.target.files;</span><br><span class="line">  <span class="keyword">let</span> n = files.length;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> file <span class="keyword">of</span> files) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;file.name&#125;</span> <span class="subst">$&#123;file.size&#125;</span> <span class="subst">$&#123;file.type&#125;</span> <span class="subst">$&#123;file.lastModifiedDate&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>The <code>FileReader</code> type
<ul>
<li>The FileReader type represents an asynchronously file-reading
mechanism</li>
<li>Related methods: <code>readAsText(file, encoding)</code>,
<code>readAsDataURL(file)</code>, <code>readAsBinaryString(file)</code>,
<code>readAsArrayBuffer(file)</code></li>
<li>Because the read happens asynchronously, there are events published
by each FileReader: <code>progress</code>, <code>error</code>,
<code>load</code>
<ul>
<li>The progress event is fired roughly every 50 ms and has the
following properties: <code>lengthComputable</code>,
<code>loaded</code>, <code>total</code> and <code>result</code></li>
<li>The <code>error</code> events is fired if the file cannot be read
for some reason</li>
<li>The <code>load</code> event is fired when the file has been
successfully loaded and will not be fired if the error event has already
been fired</li>
</ul></li>
<li>You can use the <code>abort()</code> method to stop a read
progress</li>
</ul></li>
<li>The <code>FileReaderSync</code> type: the FileReaderSync is the
synchronous version (blocking read) of the FileReader type</li>
<li>Blobs and Partial reads
<ul>
<li>Use the <code>file.slice(startByte, byteAmount)</code> to create a
Blob object to read part of the file</li>
<li>A blob (binary large object) object, is a JavaScript wrapper for
immutable binary data, it is the super type of File</li>
<li>Blobs can be created from an array containing strings, ArrayBuffers,
ArrayBufferViews, or even other blobs <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> Blob([<span class="string">&quot;test&quot;</span>, <span class="string">&quot;abc&quot;</span>])); <span class="comment">// Blob &#123;size: 7, type: &quot;&quot;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> Blob([<span class="string">&quot;test&quot;</span>], &#123;<span class="attr">type</span>: <span class="string">&quot;testType&quot;</span>&#125;)); <span class="comment">// Blob &#123;size: 4, type: &quot;testType&quot;&#125;</span></span><br></pre></td></tr></table></figure></li>
<li>Useful blob properties and methods: <code>size</code>,
<code>type</code>, <code>slice()</code></li>
</ul></li>
</ul></li>
<li>Media elements
<ul>
<li>HTML5 introduces two media-related elements to enable cross-browser
audio and video embedding into a browser baseline without any plug-ins:
<code>&lt;audio&gt;</code> and <code>&lt;video&gt;</code></li>
<li>Each of the elements requires a <code>src</code> attribute to
specify the source of the media</li>
<li>You may optionally specify multiple different media sources because
not all browsers support all media formats: omit the src attribute from
the element and instead include on or more <code>&lt;source&gt;</code>
elements</li>
<li>Properties: <code>autoplay</code> boolean, <code>buffered</code>
time range, <code>duration</code> float amount of seconds,
<code>loop</code> boolean, <code>muted</code> boolean,
<code>paused</code> boolean, <code>played</code> time range,
<code>volume</code> float between 0.0 and 1.0, ...</li>
<li>Events: <code>abort</code> downloading has been aborted,
<code>canplay</code> playback can begin, <code>error</code>,
<code>ended</code>, <code>play</code>, <code>pause</code>, ...</li>
<li>Custom media players: you can manually control the playback of a
media file, using the <code>play()</code> and <code>pause()</code>
methods</li>
</ul></li>
<li>Notifications API
<ul>
<li>The Notifications API provides greater degree of customizability
than the alert() dialogue boxes</li>
<li>Notification permissions
<ul>
<li>Two security features are enforced to prevent potential abuse
<ul>
<li>Notifications can be triggered only by code executing in a secure
context</li>
<li>Notifications must be explicitly allowed by the user on a per-origin
basis</li>
</ul></li>
<li>The user grants notification permission to an origin insider a
browser dialogue box</li>
<li>Unless the user does explicit allow or deny permission, the browser
will remember the decision and will not ask again for the same
origin</li>
</ul></li>
<li>Showing and hiding notification
<ul>
<li>Use the constructor to create and show notifications:
<code>new Notification(title[, options])</code>, the title argument is
the title of the notification dialogue box, the options is an object
containing specification information</li>
<li>Use the <code>notification.close()</code> method to close an
notification <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> notification = <span class="keyword">new</span> Notification(<span class="string">&quot;Notification title&quot;</span>, &#123;</span><br><span class="line">    lang: <span class="string">&quot;en-US&quot;</span>,</span><br><span class="line">    body: <span class="string">&quot;Notification body&quot;</span>,</span><br><span class="line">    tag: <span class="string">&quot;notification-tag&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    notification.close();</span><br><span class="line">&#125;, <span class="number">5000</span>);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Notification lifecycle callbacks
<ul>
<li>Notification aren't always just for displaying text strings, they
are also designed to be interactive</li>
<li>Callbacks
<ul>
<li><code>onshow</code>: triggered when the notification is
displayed</li>
<li><code>onclick</code>: triggered when the notification is
clicked</li>
<li><code>onclose</code>: triggered when the notification is dismissed
or closed via close();</li>
<li><code>onerror</code>: triggered when an error occurs that prevents
the notification from being displayed</li>
</ul></li>
</ul></li>
</ul></li>
<li>Page visibility API
<ul>
<li>When a page is minimized or hidden behind another tab, it may not
take sense to continue functionality of the page, the Page Visibility
API</li>
<li>Three parts of the Page Visibility API
<ul>
<li><code>document.visibilityState</code>: a string value, can be one of
<code>hidden</code>, <code>visible</code>, <code>prerender</code></li>
<li><code>visibilitychange</code> event: fired when a document changes
from visible to hidden, or vice versa</li>
<li><code>document.hidden</code>: a boolean value indicating if the page
is hidden from view</li>
</ul></li>
</ul></li>
<li>Streams API
<ul>
<li>The streams API solves the problem of web applications consuming
information in sequential chunks rather than in bulk</li>
<li>Application situations
<ul>
<li>High-level concepts:
<ul>
<li>A block of data may not be available all at once</li>
<li>A block of data can be processed in small portions</li>
</ul></li>
<li>Concrete examples:
<ul>
<li>Handle network request</li>
<li>Read/write to disk</li>
</ul></li>
</ul></li>
<li>Introduction to streams
<ul>
<li>Three types of streams
<ul>
<li>Readable streams: streams from which chunks can be read via a public
interface, data enters the stream internally from an underlying source
and is processed by a consumer</li>
<li>Writable streams: streams to which chunks can be written via a
public interface, a producer writes data into the stream, and the data
is passed internally in an underlying sink</li>
<li>Transform streams: made up of two streams: a writable stream to
accept input data, and a readable stream to emit output data</li>
</ul></li>
<li>The fundamental unit in streams is the chunk, a chunk can be of any
data type, but frequently it will take the form of a typed array. The
size and arrival time of different chunks can also be different</li>
<li>The ideal stream has approximately the same size and arrive at
approximately regular intervals, the entrance and exit of an ideal
stream are also in equilibrium</li>
</ul></li>
<li>Readable streams <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span>* <span class="title">ints</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="built_in">setTimeout</span>(resolve, <span class="number">1000</span>, i));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Create a readable stream using the ReadableStream constructor</span></span><br><span class="line"><span class="keyword">const</span> readableStream = <span class="keyword">new</span> ReadableStream(</span><br><span class="line">  <span class="comment">// the first argument is the underlyingSource, the start function inside has</span></span><br><span class="line">  <span class="comment">// a controller object as its sole argument, the controller object is an instance</span></span><br><span class="line">  <span class="comment">// of the ReadableStreamDefaultController class</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">start</span>(<span class="params">controller</span>)</span> &#123;</span><br><span class="line">      <span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">let</span> chunk <span class="keyword">of</span> ints()) &#123;</span><br><span class="line">        <span class="comment">// add the chunk to the stream</span></span><br><span class="line">        controller.enqueue(chunk);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// signal the end of the stream</span></span><br><span class="line">      controller.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// read the stream using the readableStreamReader instance</span></span><br><span class="line"><span class="keyword">const</span> readableStreamReader = readableStream.getReader();</span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; done, value &#125; = <span class="keyword">await</span> readableStreamReader.read();</span><br><span class="line">  <span class="keyword">if</span> (done) &#123;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;</span><br><span class="line">readableStreamReader.releaseLock();</span><br></pre></td></tr></table></figure></li>
<li>Writable streams <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span>* <span class="title">ints</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="built_in">setTimeout</span>(resolve, <span class="number">1000</span>, i));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> writableStream = <span class="keyword">new</span> WritableStream(</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">write</span>(<span class="params">value</span>)</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// producer</span></span><br><span class="line"><span class="keyword">const</span> writableStreamWriter = writableStream.getWriter();</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">let</span> chunk <span class="keyword">of</span> ints()) &#123;</span><br><span class="line">  <span class="keyword">await</span> writableStreamWriter.write(chunk);</span><br><span class="line">&#125;</span><br><span class="line">writableStreamWriter.close();</span><br></pre></td></tr></table></figure></li>
<li>Transform streams <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span>* <span class="title">ints</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="built_in">setTimeout</span>(resolve, <span class="number">1000</span>, i));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> &#123;writable, readable&#125; = <span class="keyword">new</span> TransformStream(</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">transform</span>(<span class="params">chunk, controller</span>)</span> &#123;</span><br><span class="line">      controller.enqueue(chunk * <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> transformStreamReader = transformStream.readable.getReader();</span><br><span class="line"><span class="keyword">const</span> transformStreamWriter = transformStream.writable.getWriter();</span><br><span class="line"></span><br><span class="line"><span class="comment">// consumer</span></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; done, value &#125; = <span class="keyword">await</span> transformStreamReader.read();</span><br><span class="line">  <span class="keyword">if</span> (done) &#123;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// producer</span></span><br><span class="line"><span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">let</span> chunk <span class="keyword">of</span> ints()) &#123;</span><br><span class="line">  <span class="keyword">await</span> transformStreamWriter.ready;</span><br><span class="line">  transformStreamWriter.write(chunk);</span><br><span class="line">&#125;</span><br><span class="line">transformStreamWriter.close();</span><br></pre></td></tr></table></figure></li>
<li>Piping streams
<ul>
<li>The ReadableStream can be piped into a TransformStream using the
<code>pipeThrough()</code> method</li>
<li>The ReadableStream can also be piped into a WritableStream using the
<code>pipeTo()</code> method</li>
</ul></li>
</ul></li>
<li>Timing APIs
<ul>
<li><p>Page performance is an area of concern for web developers, the
interface on the <code>window.performance</code> object provides a way
to measure the performance of a web page</p></li>
<li><p>Several timing APIs involved:
<code>High Resolution Time API</code>,
<code>Performance Timeline API</code>,
<code>Navigation Timing API</code>, <code>User Timing API</code>,
<code>Resource Timing API</code>, <code>Paint Timing API</code></p></li>
<li><p>High Resolution Time API</p>
<ul>
<li>Issues with <code>Date.now()</code> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> to = <span class="built_in">Date</span>.now();</span><br><span class="line"><span class="comment">// some function here;</span></span><br><span class="line"><span class="keyword">const</span> t1 = <span class="built_in">Date</span>.now();</span><br><span class="line"><span class="keyword">const</span> diff = t1 - t0;</span><br><span class="line"><span class="comment">// diff can be 0 (when the difference is less than 1ms), negative (when </span></span><br><span class="line"><span class="comment">// the system clock is set backwards), or very large (when the system clock</span></span><br><span class="line"><span class="comment">// is set forwards)</span></span><br><span class="line"><span class="built_in">console</span>.log(diff);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li><p>Use of the <code>window.performance.now()</code></p>
<ul>
<li>It returns a floating point number with up to microseconds
precision</li>
<li>It's also a relative time, the 0 value is when its execution context
is spawned, so it's not possible to compare values in different
execution contexts</li>
</ul></li>
<li><p>Performance Timeline API</p>
<ul>
<li>This performance information is stored in different PerformanceEntry
objects, all entry records can be get using the
<code>window.performance.getEntries()</code> method</li>
<li>Entry properties: <code>name</code>, <code>entryType</code>,
<code>startTime</code>, <code>duration</code>, ...</li>
</ul></li>
</ul></li>
<li>Web Cryptography API
<ul>
<li>Random number generation
<ul>
<li><code>Math.random()</code> uses the PosudoRandom Number Generation
algorithm (PRNG), it's not fully random, the web browser simply applies
a fixed algorithm on an internal state to emulate randomness</li>
<li>The Cryptographically secure PRNG (PSRNG) incorporates a source of
entropy as its input, so it's slower than the normal PRNG, but it's
emited values are more difficult to predict</li>
<li>The Cryptography API provides a CSPRNG that can be accessed on the
global Crypto object via
<code>crypto.getRandomValues(typedArray)</code></li>
</ul></li>
</ul></li>
</ol>
<h1 id="error-handling-and-debugging">Error handling and Debugging</h1>
<ol type="1">
<li>Browser error reporting
<ul>
<li>Desktop consoles: all modern desktop web browsers expose errors
through their web console</li>
<li>Mobile consoles:
<ul>
<li>Mobile phonse will not offer a console interface directly on the
device</li>
<li>Chrome and Safari come bundled with utilities that allow you to
connect the device to a host operating system running that same browser,
and ytou can then view the errors through the paired desktop
browsers</li>
<li>It's also possible to use a third-party utility to debug directly on
the mobile device</li>
</ul></li>
</ul></li>
<li>Error handling
<ul>
<li>Introduction
<ul>
<li>Greate care is usually taken by the server-side team to defined an
error-logging mechanism that categories erros by type, frequency, and
any other metric that may be important</li>
<li>Error handling on the browser side of web applications has slowly
been adopted</li>
</ul></li>
<li>The try-catch statement
<ul>
<li>Syntax <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="comment">// code that may throw an error</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">  <span class="comment">// code to handle the error</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>The finally clause <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="comment">// code that may throw an error</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">  <span class="comment">// code to handle the error</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">  <span class="comment">// code to run regardless of whether an error occurred or not</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Error types: <code>Error</code>, <code>InternalError</code>,
<code>EvalError</code>, <code>RangeError</code>,
<code>ReferenceError</code>, <code>SyntaxError</code>,
<code>TypeError</code>, <code>URIError</code></li>
</ul></li>
<li>Throwing errors
<ul>
<li>The <code>throw</code> operator can be used to throw custom erros at
any point in time</li>
<li>The throw operator must be used with a value but places no
limitation on the type of value that can be thrown</li>
</ul></li>
<li>The error event
<ul>
<li>Any error that is not handled by a try-catch causes the error event
to be fired on the window object</li>
<li>Arguments of the error handler function: the error message, the URL
on which the error occured, the line number <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.onerror = <span class="function">(<span class="params">msg, url, line</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(msg, url, line);</span><br><span class="line">  <span class="comment">// By returning false, this function actually becomes a try-catch </span></span><br><span class="line">  <span class="comment">// statement for the entire document</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Error handling strategies
<ul>
<li>Identify where errors might occur: type coerciosn erros, data type
erros, communication errors</li>
<li>Distinguishing between fatal and nonfatal errors</li>
<li>Log errors to the server</li>
</ul></li>
</ul></li>
<li>Debuggin techniques
<ul>
<li>Logging messages to a console
<ul>
<li>Methods: <code>console.error(msg)</code>,
<code>console.warn(msg)</code>, <code>console.info(msg)</code>,
<code>console.log(msg)</code>, <code>console.debug(msg)</code></li>
</ul></li>
<li>Understanding the console runtime： a REPL</li>
<li>Using the JavaScript debugger: <code>debugger</code> keyword</li>
<li>Loggin message to the page</li>
</ul></li>
</ol>
<h1 id="xml-in-javascript">XML in JavaScript</h1>
<ol type="1">
<li>XML DOM support in browsers
<ul>
<li>DOM level 2 core <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create a blank XML document</span></span><br><span class="line"><span class="keyword">let</span> xmldom = docuemnt.implementation.createDocument(namespaceUri, root, doctype);</span><br></pre></td></tr></table></figure></li>
<li>tHE DOMParser type <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> parser = <span class="keyword">new</span> DOMParser();</span><br><span class="line"><span class="keyword">let</span> xmlDoc = parser.parseFromString(xmlString, <span class="string">&quot;text/xml&quot;</span>);</span><br></pre></td></tr></table></figure></li>
<li>The XMLS erializer type <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> serializer = <span class="keyword">new</span> XMLSerializer();</span><br><span class="line"><span class="keyword">let</span> xmlString = serializer.serializeToString(xmlDoc);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>XPath support in browsers
<ul>
<li>XPath was created as a way to locate specific nodes within a DOM
document</li>
<li>DOM level 3 XPath
<ul>
<li>Determine if a browser supports DOM level 3 XPath
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">document</span>.implementation.hasFeature(<span class="string">&quot;XPath&quot;</span>, <span class="string">&quot;3.0&quot;</span>)) &#123;</span><br><span class="line">  <span class="comment">// do something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Use the <code>XPathEvaluator</code> to evaluate Xpath expressions
with a specific context</li>
<li>Use the <code>XPathResult</code> tp get the result of the
evaluation</li>
</ul></li>
</ul></li>
<li>XSLT support in browsers
<ul>
<li>XSLT is a companion technology to XML that makes use of XPath to
transform one document representation into another</li>
<li>The XSLTProcessor type
<ul>
<li>The XSLTProcessor type allows developers to transform XML documents
by using XSLT in a manner similar to XSL processor in IE</li>
</ul></li>
</ul></li>
</ol>
<h1 id="json">JSON</h1>
<ol type="1">
<li>Introduction
<ul>
<li>XML was the de facto standard for transmitting structured data over
the internet</li>
<li>JSON is a strict subset of JavaScript, making use of several
patterns found in JavaScript to represent structured data</li>
<li>The most important thing is that JSON is that it is a data format,
not a programming language</li>
</ul></li>
<li>Syntax
<ul>
<li>Three types of values represented by JSON
<ul>
<li>Simple values: strings, numbers, booleans, null; undefined is not
supported by JSON</li>
<li>Objects</li>
<li>Arrays</li>
</ul></li>
<li>Variables, functions, or object instances are not supported in
JSON</li>
<li>Simple values: JSON strings must be enclosed in double quotes</li>
<li>Objects: JSON properties are named with double quotes</li>
<li>Arrays: arrays are represented in JSON using array literal</li>
</ul></li>
<li>Parsing and serialization
<ul>
<li>JSON can be parsed into a usable object in JavaScript, but XML must
be parsed into a DOM document first</li>
<li>The JSON object
<ul>
<li>Use the <code>JSON.stringify(obj)</code> method to convert a
JavaScript object into a JSON string</li>
<li>Use the <code>JSON.parse(jsonString)</code> method to convert a JSON
string into a JavaScript object</li>
<li>The JSON string is inside a pair of single quotes</li>
</ul></li>
<li>Serialization options
<ul>
<li>The <code>JSON.stringify(obj, replacer, space)</code> method can be
used to specify a replacer and/or a space argument</li>
<li>The replacer is an array of strings that specify the names of the
properties to be included in the serialization</li>
<li>The space is a string or number: if the space is a number, it
indicates the amount of white space characters used for indention, if
the space is a string, the string is used as white space</li>
<li>The <code>toJSON()</code> method: this method can be added to
JavaScript objects to introduce customized serialization, and is called
when JSON.stringify() is called on an object</li>
</ul></li>
<li>Parsing options
<ul>
<li>The <code>JSON.parse(jsonString, reviver)</code> method can be used
to specify a reviver function</li>
<li>The reviver function has two arguments: the key and the related
value, it also needs to return a value</li>
<li>A very common use of the reviver function is to turn date strings
into Date objects</li>
</ul></li>
</ul></li>
</ol>
<h1 id="network-requests-and-remove-resources">Network Requests and
Remove Resources</h1>
<ol type="1">
<li>Introduction
<ul>
<li>AJAX (asynchronous JavaScript + XML) allows making server requests
for additional data without reloading the web page</li>
<li>AJAX uses XMLHttpRequest (XHR) to makes request to the server</li>
<li>An XHR object could be used to retrieve the data and then the data
could be inerted into the page using the DOM</li>
</ul></li>
<li>The XMLHttpRequest object
<ul>
<li>IE 5 was the first browser to introduce the XHR object</li>
<li>All modern browsers support a native XHR object that can be created
using the XMLHttpRequest constructor:
<code>let xhr = new XMLHttpRequest();</code></li>
<li>XHR usage
<ul>
<li>The <code>open(type, URL, async)</code> method is used to open a
connection to the server
<ul>
<li><code>type</code>: can be either <code>get</code>,
<code>post</code>, ...</li>
<li><code>URL</code>: the URL of the server to connect to</li>
<li><code>async</code>: a boolean value indicating whether the request
should be sent asynchronously or not</li>
</ul></li>
<li>To send a specific request, use the <code>send(body)</code> method
<ul>
<li>The <code>body</code> can be a document, an XMLHttpRequestBodyInit
object, or null</li>
</ul></li>
<li>XHR response related properties
<ul>
<li><code>xhr.responseText</code>: the text taht was returned as the
body of the response</li>
<li><code>xhr.responseXML</code>: contains an XML DOM document with
response data if the response has a context type of "text/xml" or
"application/xml"</li>
<li><code>xhr.status</code>: the HTTP status of the response</li>
<li><code>xhr.statusText</code>: the description of the HTTP status
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.status &lt; <span class="number">300</span> || xhr.status == <span class="number">304</span>) &#123;</span><br><span class="line">  <span class="comment">// do something with successful response</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">// do something with error response</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>XHR <code>readyState</code> property
<ul>
<li>Integer value indicating the phase of the request/response
cycle</li>
<li>0 : Uninitialized, the <code>open()</code> method has not been
called yet</li>
<li>1: Open,the <code>open()</code> method has been called, but the
<code>send()</code> method has not been called yet</li>
<li>2: Sent, the <code>send()</code> method has been called, but no
response ahs been received</li>
<li>3: Receiving: some response data has been retrieved</li>
<li>4: Complete, all of the response data has been retrieved and is
available</li>
</ul></li>
</ul></li>
<li>HTTP Headers
<ul>
<li>The XHR objects expose both the HTTP request headers and the HTTP
response headers</li>
<li>Related headers sent in an XHR request is sent: <code>Accept</code>,
<code>Accept-Charset</code>, <code>Accept-Encoding</code>,
<code>Accept-Language</code>, <code>Connection</code>,
<code>Cookie</code>, <code>Host</code>, <code>Referer</code>,
<code>User-Agent</code></li>
<li>Use the <code>xhr.setRequestHeader(header, value)</code> method
after the <code>xhr.open()</code> and before the <code>xhr.send()</code>
method to set the value of a request header</li>
<li>Use the <code>xhr.getResponseHeader(header)</code> method to get the
value of a response header</li>
</ul></li>
<li>GET requests
<ul>
<li>The query string must be present and encoded correctly on the URL
that is passed to the open() method</li>
<li>Each query-string name and value msut be encoded using the
<code>encodeURIComponent()</code> before being attached to the URL, and
all of the name-value pairs must be separated by an ampersand
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addURLParam</span>(<span class="params">url, name, value</span>) </span>&#123;</span><br><span class="line"><span class="comment">// for the first name-value pair, add the ? first, for other pairs, and </span></span><br><span class="line"><span class="comment">// an &amp; first</span></span><br><span class="line">url += (url.indexOf(<span class="string">&quot;?&quot;</span>) == -<span class="number">1</span> ? <span class="string">&quot;?&quot;</span> : <span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line"><span class="comment">// encode the name and value, and append the pair to the URL</span></span><br><span class="line">url += <span class="built_in">encodeURIComponent</span>(name) + <span class="string">&quot;=&quot;</span> + <span class="built_in">encodeURIComponent</span>(value);</span><br><span class="line"><span class="keyword">return</span> url;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>POST requests
<ul>
<li>The body of the post request can contain large amount of data of any
format</li>
<li>You can pass XML DOM document or a string as the argument in the
send() method</li>
<li>Mimic form submission using post request <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xhr.open(<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;URL&quot;</span>, ture);</span><br><span class="line"><span class="comment">// add this header to tell the server to submit a form</span></span><br><span class="line">xhr.setRequestHeader(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> form = <span class="built_in">document</span>.getElementById(<span class="string">&quot;form&quot;</span>);</span><br><span class="line"><span class="comment">// the form should be serialized </span></span><br><span class="line">xhr.send(serializeForm(form));</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>XMLHttpRequest level 2
<ul>
<li>Not all browsers implemented all parts of the level 2 specification,
but all browsers have implemented some of the functionality</li>
<li>The <code>FormData</code> type <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> data = <span class="keyword">new</span> FormData();</span><br><span class="line"><span class="comment">// append a namme-value pair to the form</span></span><br><span class="line">data.append(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// pass the form data to the xhr send method</span></span><br><span class="line"><span class="keyword">let</span> form = <span class="built_in">document</span>.getElementById(<span class="string">&quot;form&quot;</span>);</span><br><span class="line">xhr.send(<span class="keyword">new</span> FormData(form));</span><br></pre></td></tr></table></figure></li>
<li>Timeouts
<ul>
<li>All browsers support the <code>timeout</code> event and the
<code>ontimeout</code> event handler <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xhr.timeout = <span class="number">1000</span>; <span class="comment">// 1 second</span></span><br><span class="line">xhr.ontimeout = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="comment">// do something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
</ul></li>
<li>Progress events
<ul>
<li>The Progress Events specification is a W3C Wroking Draft defining
events for client-server communication</li>
<li>The events were first targeted at XHR explicitly but have now also
made their way into other similar APIs</li>
<li>The 6 progress events
<ul>
<li><code>laodstart</code>: fired when the first byte of the response
has been received</li>
<li><code>progress</code>: fired repeatedlty as a response is being
received</li>
<li><code>error</code>: fired when there was an eror attempting the
request</li>
<li><code>abort</code>: fired when the connection was terminated by
calling abort() method</li>
<li><code>load</code>: fired when the response has been fully
received</li>
<li><code>loaded</code>: fired when the communication is complete and
after firing, abort, or loade</li>
</ul></li>
</ul></li>
<li>Cross-origin resource sharing
<ul>
<li>One of the major limitations of Ajax communication via XHR is the
cross-origin security policy: by default, XHR objects can access
resources only on the domain from which the containing web page
originates</li>
<li>CORS (cross-origin-resource-sharing) defines how the browser and
server must communicate when accessing sources across origins</li>
<li>The basic idea behind CORS is to use custom HTTP headers to allow
both the browser and the server to know enough about each other to
determine if the request or response should succeed or fail</li>
<li>Modern browsers support CORS natively throught the XMLHttpRequest
object
<ul>
<li>The open method specifies the URL of the reources to be
accessed</li>
<li>CORS allows access to the status, statusText properties, and
synchronous requests</li>
<li>There are also some limitations on CORS XHR object for security
reason:
<ul>
<li>Custom headers cannot be set using setRequestHeader() method</li>
<li>Cookies are neither sent nor received</li>
<li>The getResponseHeaders() method always returns an empty string</li>
</ul></li>
</ul></li>
<li>Preflighted requests
<ul>
<li>CORS allows the use of custom headers, methods other than GET or
POST, and different body content types through a transparent mechanism
of server verification called preflighted requests</li>
<li>When the browser tries to make a request with one of the advanced
options, a preflight request is made to the server</li>
<li>The server can determine whether or not it will allow requests of
this type by sending a response with appropriate headers</li>
</ul></li>
<li>Credentialed requests
<ul>
<li>By default, CORS requests do no provide credentials, you can specify
that a request should send credentials by setting the
<code>with-Credentials</code> property to true</li>
<li>If the server allows credentialed requests, then it responds with
the following HTTP header:
<code>Allow-Control-Allow-Credentials</code></li>
<li>If a credentialed request is sent and this header is not sent as
part of the response, then the browser doesn't pass the response to
JavaScript</li>
</ul></li>
</ul></li>
<li>Alternate cross-domain techniques
<ul>
<li>Image pings
<ul>
<li>Images can be loaded cross-domain by any page without restrictions,
this is the main way that online advertisements track views</li>
<li>You can dynamically create images and use their onload and onerror
event handlers to tell you when the response has been received</li>
<li>Image pings are simple, cross-domain, one-way communication with the
server. The data is sent via query-string arguments and the response can
be anything</li>
<li>The browser cannot get any specification data back from an image
ping but it can tell whether the response has been received by listening
for the load and error events</li>
<li>Image pings are frequently used for tracking user clicks on a page
or dynamic ad impressions</li>
</ul></li>
<li>JSONP
<ul>
<li>JSONP is short for JSON with padding and is a special variant of
JSON that has become popular for web services</li>
<li>JSONP looks like JSON except that the data is wrapped within what
looks like a function call</li>
<li>JSONP format is made up of two parts: the callback and the data
<ul>
<li>The callback is the function that should be called on the page when
the response has been received</li>
<li>The data is simply the JSON data to pass to the function</li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params">&#123;<span class="string">&quot;k1&quot;</span>: <span class="string">&quot;v1&quot;</span>, <span class="string">&quot;k2&quot;</span>, <span class="string">&quot;v2&quot;</span>&#125;</span>)</span>;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>JSONP is sued through dynamic <code>&lt;script&gt;</code> elements
assigning the src to a cross-domain URL <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// this is in the server domain, the file is called jsonp.js</span></span><br><span class="line"><span class="comment">// this is the jsonp callback function</span></span><br><span class="line">callbackFun(&#123;<span class="string">&quot;k1&quot;</span>: <span class="string">&quot;v1&quot;</span>, <span class="string">&quot;k2&quot;</span>, <span class="string">&quot;v2&quot;</span>&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// this is in the browser domain, which is different from the server domain</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="keyword">function</span> <span class="title">callbackFun</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(data);</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;jsonp.js&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>Limitations of JSONP
<ul>
<li>Some executable code is pulled into the page from another domain,
and this may cause security issues</li>
<li>There is no easy way to determine that a JSONP request has
failed</li>
</ul></li>
</ul></li>
</ul></li>
<li>The <code>fetch</code> API
<ul>
<li>The Fetch API can perform all tasks as an XMLHttpRequest, but is
much easier to use, has a more modern interface, and is able to be used
by modern web tools</li>
<li>The XMLHttpRequest is optionally asynchronous, but the Fetch API are
strictly asynchronous</li>
<li>Basic API utilization
<ul>
<li>Dispatching a request: <code>let r = fetch(URL);</code></li>
<li>Reading a response <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fetch(URL)</span><br><span class="line">  .then(<span class="function">(<span class="params">response</span>) =&gt;</span> response.text())</span><br><span class="line">  .then(<span class="function">(<span class="params">data</span>) =&gt;</span> <span class="built_in">console</span>.log(data));</span><br></pre></td></tr></table></figure></li>
<li>Handling status codes and request failuers <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fetch(URL)</span><br><span class="line">  .then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (response.ok) &#123;</span><br><span class="line">      <span class="keyword">return</span> response.text();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(response.statusText);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">data</span>) =&gt;</span> <span class="built_in">console</span>.log(data))</span><br><span class="line">  .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> <span class="built_in">console</span>.log(error));</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Common fetch patterns
<ul>
<li>Sending JSON data <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fetch(URL, &#123;</span><br><span class="line">  method: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">  body: <span class="built_in">JSON</span>.stringify(data),</span><br><span class="line">  headers: &#123;</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
<li>Sending parameters in a request body <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> info = <span class="string">&quot;foo=bar&amp;baz=qux&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> paramHeaders = <span class="keyword">new</span> Headers(&#123;</span><br><span class="line">  <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line">fetch(URL, &#123;</span><br><span class="line">  method: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">  body: info,</span><br><span class="line">  headers: paramHeaders</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Sending a file <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> formData = <span class="keyword">new</span> FormData();</span><br><span class="line">formData.append(<span class="string">&quot;file&quot;</span>, file);</span><br><span class="line"></span><br><span class="line">fetch(URL, &#123;</span><br><span class="line">  method: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">  body: formData</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>Sending a cross-origin request <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fetch(URL, &#123;</span><br><span class="line">  method: <span class="string">&quot;no-cors&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">&#125;)</span></span><br><span class="line"><span class="string">.then((response) =&gt; response.text())</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>The Headers object
<ul>
<li>The Headers object is used as a container for all outgoing request
and incoming response headers</li>
<li>Basic usage <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> h = <span class="keyword">new</span> Headers();</span><br><span class="line">h.set(<span class="string">&quot;key&quot;</span>: <span class="string">&quot;value&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(h.has(<span class="string">&quot;key&quot;</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(h.get(<span class="string">&quot;key&quot;</span>)); <span class="comment">// value</span></span><br></pre></td></tr></table></figure></li>
<li>Header guards
<ul>
<li>In some cases, no all HTTP headers are mutable by the client, and
the headers object uses guards to enfore how set(), append(), and
delete() behave</li>
<li>Violating the guard restriction will throw a TypeError</li>
</ul></li>
</ul></li>
<li>The Request object
<ul>
<li>Creating request object <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> request = <span class="keyword">new</span> Request(<span class="string">&quot;URL&quot;</span>, options);</span><br></pre></td></tr></table></figure></li>
<li>Cloning request object
<ul>
<li>The request constructor does not always create the exact copy of a
request <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r1 = <span class="keyword">new</span> Request(<span class="string">&quot;URL&quot;</span>m &#123;<span class="attr">method</span>: <span class="string">&quot;GET&quot;</span>&#125;);</span><br><span class="line"><span class="keyword">let</span> r2 = <span class="keyword">new</span> Request(r1, &#123;<span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>&#125;);</span><br></pre></td></tr></table></figure></li>
<li>The <code>clone()</code> method <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r1 = <span class="keyword">new</span> Request(<span class="string">&quot;URL&quot;</span>m &#123;<span class="attr">method</span>: <span class="string">&quot;GET&quot;</span>&#125;);</span><br><span class="line"><span class="keyword">let</span> r2 = r1.clone();</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Using request objects with fetch
<ul>
<li>You can pass a request object to the fetch() method, and the options
in fetch() method will override the options in the request object
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// request object with method set to GET</span></span><br><span class="line"><span class="keyword">let</span> req = <span class="keyword">new</span> Request(<span class="string">&quot;URL&quot;</span>, &#123;<span class="attr">method</span>: <span class="string">&quot;GET&quot;</span>&#125;);</span><br><span class="line"><span class="comment">// the method is overridden to POST</span></span><br><span class="line">fetch(req, &#123;<span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>&#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">response</span>) =&gt;</span> response.text())</span><br><span class="line">  .then(<span class="function">(<span class="params">data</span>) =&gt;</span> <span class="built_in">console</span>.log(data));</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
<li>The Response object
<ul>
<li>Creating response object
<ul>
<li>Use the response constructor <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> response = <span class="keyword">new</span> Response();</span><br></pre></td></tr></table></figure></li>
<li>The most common way is to use the fetch() method, which returns a
promise that resolves to a response object that does represent an actual
HTTP response <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fetch(<span class="string">&quot;URL&quot;</span>)</span><br><span class="line">  .then(<span class="function">(<span class="params">response</span>) =&gt;</span> <span class="built_in">console</span>.log(response));</span><br></pre></td></tr></table></figure></li>
<li>The <code>Response.redirect("url", statusCode)</code> generates a
redirected response object</li>
<li>The <code>Response.error()</code> method produces a response that
you would except from a network error, which would cause a fetch promise
to reject</li>
</ul></li>
<li>Cloning response object
<ul>
<li>Use the <code>clone()</code> method to create an exact copy with no
opportunity to override any values <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r1 = <span class="keyword">new</span> Response(<span class="string">&quot;data&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> r2 = r1.clone();</span><br></pre></td></tr></table></figure></li>
<li>Use the response constructor can also do pseudo-cloning
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r1 = <span class="keyword">new</span> Response(<span class="string">&quot;data&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> r2 = <span class="keyword">new</span> Response(r1);</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
</ul></li>
<li>The Beacon API
<ul>
<li>To maximize the amount of information transmitted about a page, many
analytical tools send data to a server as late in the page's lifecycle
as possible. As a result, the optimal pattern its to send a network
request on the brwoser's unload event</li>
<li>During the unload event, the browsers is being discarded, so any
pending network requests like asynchronous requests created by
XMLHttpRequest or fetch() are cancelled. But the analytics tools still
need to cease collecting information and ship off what they have to the
server</li>
<li>Solution 1: analytics use synchronous XMLHttpRequest to force
delivery of the request, but doing so causes the browser to pause
waiting for the request</li>
<li>Solution 2: use the Beacon API
<ul>
<li>The <code>navigator.sendBeacon(url, payload)</code> sends a POST
request to the server with a data payload. Returns a boolean value
indicating whether the request was successfully sent</li>
<li>The sendBeacon() method can be called at anytime during the
browsers' lifecycle</li>
<li>Once the method is called, the browsers adds the requests to an
internal request queue, and eagerly attempt to send requests in the
queue</li>
<li>The browsers guarantees it will attempt to send the request</li>
</ul></li>
</ul></li>
<li>Web sockets
<ul>
<li>The goal of Web Socket is to provide full-duplex, bidirectional
communication with teh server over a single, long-lasting
connection</li>
<li>Create a Web Socket in JavaScript
<ul>
<li>An HTTP request is sent to the server to initiate a connection</li>
<li>When the server responds, the connection uses the HTTP Upgrade
header to switch from HTTTP to Web Socket protocol</li>
<li>This means the Web Sockets cannot be implemented with a standard
HTTP server and must use a specialized server supporting the protocol to
work properly</li>
</ul></li>
<li>The url scheme for web socket does not begin with
<code>hppt://</code> or <code>https://</code>, but instead begins with
<code>ws://</code> or <code>wss://</code></li>
<li>The API
<ul>
<li>Creating a web socket
<ul>
<li>The url in the constructor must be an absolute url</li>
<li>THe same-origin policy does not apply to web socket
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">&quot;ws://**********&quot;</span>);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>The <code>readyState</code> property for a web socket instance
<ul>
<li><code>WebSocket.OPENING(0)</code>: the connection is being
established</li>
<li><code>WebSocket.OPEN(1)</code>: the connection has been
established</li>
<li><code>WebSocket.Closing(2)</code>: the connection is beginning to
close</li>
<li><code>WebSocket.CLOSE(3)</code>: the connection is closed</li>
<li>There is no readystatechange event</li>
</ul></li>
<li>Close a websocket: <code>we.close()</code></li>
<li>Sending/receiving data <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">&quot;ws://**********&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> stringData = <span class="string">&quot;Hello World&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> arrayBufferData = <span class="built_in">Uint8Array</span>.from([<span class="string">&quot;f&quot;</span>, <span class="string">&quot;o&quot;</span>, <span class="string">&quot;o&quot;</span>]);</span><br><span class="line"><span class="keyword">let</span> blobData = <span class="keyword">new</span> Blob([<span class="string">&quot;f&quot;</span>, <span class="string">&quot;o&quot;</span>, <span class="string">&quot;o&quot;</span>]);</span><br><span class="line">ws.send(stringData);</span><br><span class="line">ws.send(arrayBufferData);</span><br><span class="line">ws.send(blobData);</span><br></pre></td></tr></table></figure></li>
<li>Other events
<ul>
<li><code>open</code>: fired when teh connection has been successfully
made</li>
<li><code>error</code>: fired when an error occurs, the connection is
unable to persist</li>
<li><code>close</code>: fired when the connection is closed</li>
</ul></li>
</ul></li>
</ul></li>
</ol>
<h1 id="client-side-storage">Client-Side Storage</h1>
<ol type="1">
<li>Cookies
<ul>
<li>HTTP cookies were originally intended to store session information
on the clicent</li>
<li>A server sends a <code>Set-Cookie</code> HTTP header containing
session information as part of any response to an HTTP request. Browsers
store such session information and send it back to the server via the
<code>Cookie</code> HTTP header for every request after that point to
uniquely identify the client from which the request was sent</li>
<li>Restrictions
<ul>
<li>Cookies are tied to a specific domain, when a cookie is set, it is
sent along with requests to the same domain from which it was
created</li>
<li>Other restrictions
<ul>
<li>300 cookies in total</li>
<li>4096 bytes per cookie</li>
<li>20 cookies per domain</li>
<li>81920 bytes per domain</li>
</ul></li>
</ul></li>
<li>Cookie parts
<ul>
<li>Name: unique name to identify the cookie, case-insensitive, the name
must be URL-encoded</li>
<li>Value: stirng value, must be URL-encoded</li>
<li>Domain: domain for which the cookie is valid, all requests sent from
a resource at this domain will include the cookie information</li>
<li>Path: path within the specified domain for which the cookie should
be sent to the server</li>
<li>Expiration: timee stamp indicating when the cookie should be
deleted, by default, all cookies are deleted when the browsers session
ends, but it is possible to set another time for the deletion. The value
is in GMT format (DD-Mon-YYYY HH:MM:SS GMT)</li>
<li>Secure flag: when specified, the cookie information is sent to the
server only if an SSL connection is used</li>
</ul></li>
<li>Cookies in JavaScript
<ul>
<li><code>document.cookie</code>: returns a string containing a series
of name-value pairs separated by semicolons, each name and each value is
separated by an equal sign</li>
<li>The name and value should be URL-encoded <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.cookie = <span class="built_in">encodeURIComponent</span>(<span class="string">&quot;name&quot;</span>) + <span class="string">&quot;=&quot;</span> + <span class="built_in">encodeURIComponent</span>(<span class="string">&quot;value&quot;</span>);</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Subcookies
<ul>
<li>Subcookies are smaller pieces of data stored within a single
cookie</li>
<li>The idea is to use the cookie's value to store multiple name-value
pairs within a single cookie</li>
</ul></li>
</ul></li>
<li>Web Storage
<ul>
<li>The Web storage is intent to overcome some of the limitations
imposed by cookies when data is needed strictly on the client, with no
need to continuously send data back to the server</li>
<li>The are two primary goals of the Web Storage specification
<ul>
<li>To provide a way to store session data oustide of cookies</li>
<li>To provide a mechanism for storing large amounts of data that
persists across sessions</li>
</ul></li>
<li>All major browsers support the following two storage objects as
properties of the window object:
<ul>
<li><code>localStorage</code>: the permanent storage mechanism</li>
<li><code>sessionStorage</code>: the session-scoped storage
mechanism</li>
</ul></li>
<li>The <code>Storage</code> type
<ul>
<li>The Storage type is designed to hold name-value pairs up to a
maximum size</li>
<li>Related methods
<ul>
<li><code>clear()</code>: removes all values, not implemented in
Firefox</li>
<li><code>getItem(name)</code>: retrieves the value for the given
name</li>
<li><code>key(index)</code>: retrieves the name fo the value in the
given numeric position</li>
<li><code>removeItem(name)</code>: removes the name-value pair
identified by name</li>
<li><code>setItem(name, value)</code>: sets the value for the given
name, you can also do <code>sotrage.name = value</code></li>
</ul></li>
<li>The <code>sessionStorage</code> object
<ul>
<li>This object stores data only for a session, meaning that the data is
stored until the browser is closed</li>
<li>Data stored on sessionStorage is accessible only from the page that
initially placed the data onto the object, making it of limited use for
multipage applications</li>
<li>All modern browsers implement storage writing as a blocking
synchronous action, so data added to storage can immediately be read.
Older IE implementations write data asynchronously so there may be a
lag, you can use <code>sessionStorage.begin()</code> and
<code>sessionStorage.commit()</code> to ensure that all assignments have
been made <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> sessionStorage) &#123;</span><br><span class="line">  <span class="keyword">let</span> value = sessionStorage.getItem(key);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span> = <span class="subst">$&#123;value&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>The <code>localStorage</code> object
<ul>
<li>In the revised HTML5 specification, the localStorage object
superceded globalStorage as a way to store persistent client-side
data</li>
<li>In order to access the same localStorage object, pages must be
served from the same domain, using the same protocol, and on the same
ports</li>
<li>The localStorage object can use all methods from the storage
objects</li>
</ul></li>
<li>The storage event
<ul>
<li>Whenever a change is made to a Storage object, the storage event is
fired on the document</li>
<li>The event object has the following four properties
<ul>
<li><code>domain</code>: the domain for which the storage changed</li>
<li><code>key</code>: the key that was set or removed</li>
<li><code>newValue</code>: the value that the key was set to, or null if
the key was removed</li>
<li><code>oldValue</code>: the value prior to the key being changed</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li>IndexedDB
<ul>
<li>The Indexed Database API (IndexedDB), is a structured data store in
the browser, the idea is to create an API that easily allowed the
storing and retrieval of JavaScript objects while still allowing
querying and searching</li>
<li>IndexedDB is designed to be almost completely asynchronous</li>
<li>Databases
<ul>
<li>The IndexedDB is an example of the NoSQL databases</li>
<li>Connecting to a database <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> db = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">let</span> request = <span class="built_in">window</span>.indexedDB.open(<span class="string">&quot;dbName&quot;</span>, version);</span><br><span class="line">request.onerror = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  alert(<span class="string">`Failed to open database: <span class="subst">$&#123;event.target.errorCode&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line">request.onsuccess = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  db = event.target.result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Object stores <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> user = &#123;</span><br><span class="line">  username: <span class="string">&quot;007&quot;</span>,</span><br><span class="line">  firstName: <span class="string">&quot;James&quot;</span>,</span><br><span class="line">  lastName: <span class="string">&quot;Bond&quot;</span>,</span><br><span class="line">  password: <span class="string">&quot;secret&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">request.onupgradeneeded = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> db = event.target.result;</span><br><span class="line">  <span class="keyword">if</span> (db.objectStoreNames.contains(<span class="string">&quot;users&quot;</span>)) &#123;</span><br><span class="line">    db.deleteObjectStore(<span class="string">&quot;users&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  db.createObjectStore(<span class="string">&quot;users&quot;</span>, &#123;</span><br><span class="line">    keyPath: <span class="string">&quot;username&quot;</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>Transactions
<ul>
<li>Create transactions:
<code>let transcation = db.transaction();</code></li>
<li>Create transactions with different objects:
<code>let transcation = db.transaction(["users"]);</code></li>
<li>Use the <code>objectStore(storeName)</code> method to access a
particular object store, use <code>add()</code>, <code>put()</code>,
<code>get()</code>, and <code>delete()</code> on the store object to
conduct CRUD operations</li>
</ul></li>
<li>Insertion
<ul>
<li>Use <code>add(obj)</code> and <code>put(pbj)</code> to insert data
into the database</li>
<li>The difference occurs only when an object with the same key already
exists in the object store, add() will cause an error while put() will
simply overwrite the object</li>
</ul></li>
<li>Querying with cursors
<ul>
<li>Transactions can be used directly to retrieve a single item with a
known key, when you want to retrieve multiple items, you need to create
a cursor with the transaction</li>
<li>A cursor is a pointer to a result set</li>
<li>IDBCursor instance properties and methods
<ul>
<li><code>direction</code>: the direction of the cursor, can be
<code>next</code>, <code>nextunique</code>, <code>prev</code>,
<code>prevunique</code></li>
<li><code>key</code>: the key of the object</li>
<li><code>value</code>: the value of the object</li>
<li><code>primaryKey</code>: the key being used by the cursor, could be
the object key or an index key</li>
<li><code>continue([key])</code>: moves to the next item in the result
set, if the optional argument key is specified, moves to the specified
key</li>
<li><code>advance(count)</code>: moves the cursor ahead by count number
of items <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> transaction = db.transaction(<span class="string">&quot;users&quot;</span>);</span><br><span class="line">store = transaction.objectStore(<span class="string">&quot;users&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> request = store.openCursor();</span><br><span class="line">request.onsuccess = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> cursor = event.target.result;</span><br><span class="line">  <span class="keyword">if</span> (cursor) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(cursor.value);</span><br><span class="line">    cursor.continue();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">request.onerror = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Failed to open cursor: <span class="subst">$&#123;event.target.errorCode&#125;</span>`</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
<li>Key ranges
<ul>
<li>Key ranges are used to make working with cursors a little more
efficient, a key range is represented by an instance of
<code>IDBKeyRange</code></li>
<li>Use the only method and retrives values with the specified key:
<code>const onlyRange = IDBKeyRange.only("keyName")</code></li>
<li>Use the lower bound method to defines a lower bound for the result
set (where the cursor should start):
<ul>
<li>Starts at a specific
key:<code>const lowerRange = IDBKeyRange.lowerBound("keyName")</code></li>
<li>Starts after a specific key:
<code>const lowerRange = IDBKeyRange.lowerBound("keyName", true)</code></li>
</ul></li>
<li>Use the upper bound method to defines an upper bound for the result
set (where the cursor should end):
<ul>
<li>Ends at a specific key:
<code>const upperRange = IDBKeyRange.upperBound("keyName")</code></li>
<li>Ends before a specific key:
<code>const upperRange = IDBKeyRange.upperBound("keyName", true)</code></li>
</ul></li>
<li>Use the bound method to specifies both lower bound and upper bound
<ul>
<li>Starts at key1, ends at key2:
<code>const boundRange = IDBKeyRange.bound("key1", "key2")</code></li>
<li>Starts after key1, ends at key2:
<code>const boundRange = IDBKeyRange.bound("key1", "key2", true)</code></li>
<li>Starts after key1, ends before key2:
<code>const boundRange = IDBKeyRange.bound("key1", "key2", true, true)</code></li>
<li>Starts at key1, ends before key2:
<code>const boundRange = IDBKeyRange.bound("key1", "key2", false, true)</code></li>
</ul></li>
<li>Use key range in the cursor <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = db.transaction(<span class="string">&quot;users&quot;</span>).objectStore(<span class="string">&quot;users&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> range = IDBKeyRange.only(<span class="string">&quot;007&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> request = store.openCursor(range);</span><br><span class="line">request.onsuccess = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> cursor = event.target.result;</span><br><span class="line">  <span class="keyword">if</span> (cursor) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(cursor.value);</span><br><span class="line">    cursor.continue();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Concurrency issues
<ul>
<li>Although IndexedDB is an asynchronous API inside of a web page,
there still can be concurrency issues: if the same web page is open in
two different browser tabs at the same time, it's possible that one may
attempt to upgrade the database before the other is ready</li>
<li>You should assign an <code>oversionchange</code> event handler to
tackle the concurrency issues, the best response to this event is to
immediately close the databse so that the version upgrade can be
completed <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> request, database;</span><br><span class="line"></span><br><span class="line">request = indexedDB.open(<span class="string">&quot;dbName&quot;</span>, <span class="number">1</span>);</span><br><span class="line">request.onsuccess = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  database = event.target.result;</span><br><span class="line">  database.onversionchange = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    database.close();</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
</ol>
<h1 id="modules">Modules</h1>
<ol type="1">
<li>Understanding the module pattern
<ul>
<li>Module pattern ideas
<ul>
<li>Break logic into pieces that are totally encapsulated from the rest
of the code</li>
<li>Allow each piece to explicitly define what parts of itself are
exposed to external pieces</li>
<li>Allow each piece to explicitly define what external pieces it needes
to execute</li>
</ul></li>
<li>Module identifiers
<ul>
<li>Module systems are essentially key-value entities, where each module
has anidentifier that can be used to reference it</li>
<li>The module identifier can be a string, or an actual path to a module
file</li>
<li>Native browser module identifiers must provide a path to an actual
JavaScript file. In addition, NodeJS will perform a search for module
matches in side the <code>node_modules</code> directory, and can also
match an identifier to a directory containing <code>index.js</code></li>
</ul></li>
<li>Module dependencies
<ul>
<li>The local module declares to the module system a list of external
dependencies</li>
<li>The module system inspects the dependencies and in turn guarantees
that these modules will be loaded and initialized by the time the local
module executes</li>
</ul></li>
<li>Module loading
<ul>
<li>When an external module is specified as a dependency, the local
moduel excepts that when it is executed, the dependencies will be ready
and initialized</li>
<li>In the context of browsers, all dependencies should be sent to the
browsers and loaded before the local module executes</li>
</ul></li>
<li>Entry points
<ul>
<li>A network of modules that depend upon each other must specify a
single module as the entry point, where the path of execution will
begin</li>
<li>Dependencies between modules in an application can be represented as
a directed graph</li>
</ul></li>
<li>Asynchronous dependencies: it is useful to laod modules on demand by
allowing JavaScript code to instruct the module system to load a new
module, and provide the module to a callback once it is ready</li>
<li>Programmatic dependencies
<ul>
<li>Some module systems requier you to specify all dependenciesa at the
beginning of a module, but some module system will allow you to
dynamically add dependencies inside the program structure</li>
<li>Programmatic dependencies allow for more complex dependency
utilization, but make static module analysis more difficult</li>
</ul></li>
<li>Static analysis
<ul>
<li>The JavaScript you build into modules and deliver to the browsers is
often subject to static analysis, where tools will inspect the structure
of your code and reason about how it will behave without performing
program execution</li>
<li>More complicated module behaviro, such as programmatic dependencies,
will make static analysis more difficult</li>
</ul></li>
</ul></li>
<li>Pre-ES6b module loaders
<ul>
<li>Prior to ES6, JavaScript codebases using modules essentially wanted
to use a language feature that was not available by default. Therefore,
codebases would be written in a module syntax that conformed to a
certain specification, and separate module tooling would server to
bridge the gap between the module syntax and the JavaScript runtime</li>
<li>CommonJS
<ul>
<li>The CommonJS specification outlines a convertion for module
definition that uses synchronous declarative dependencies</li>
<li>The specification is primiarily intended for module organization on
the server, but it will also be used on the client side</li>
<li>CommonJS module syntax will not work natively in the browser</li>
<li>Example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> moduleB = <span class="built_in">require</span>(<span class="string">&quot;./moduleB&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.export = &#123;</span><br><span class="line">  stuff: moduleB.doStuff();s</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// equivalent to :</span></span><br><span class="line"><span class="comment">// module.exports.stuff = moduleB.doStuff();</span></span><br></pre></td></tr></table></figure></li>
<li>Modules are always singletons, irrespective of how many times a
module is referenced inside require()</li>
<li>Modules are cached after the first time they are loaded, subsequent
attempts to load a module will retrieve the cached module</li>
<li>Module loading in CommonJs is synchronous, so require() can be
programmatically invoked inlin in a module <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (condition) &#123;</span><br><span class="line">  <span class="built_in">require</span>(<span class="string">&quot;./moduleA&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>NodeJs can use absolute or relative paths to modules, the path to
the module definition might reference a directory, or it might be a
single JavaScript file</li>
</ul></li>
<li>Asynchronous Module Definition (AMD)
<ul>
<li>CommonJs is targeted at a server execution model, all loading of
modules is synchronous, the AMD system is targeted at browser execution
model, where there are penalties from increased network latency</li>
<li>The strategy for AMD is for modules to declare their dependencies,
and the module system runninng in the browsers will fetch the
dependencies on demand and execute the module that depends on them once
they have all loaded</li>
<li>The core of the AMD module implementation is a function wrapper
around the module definition, which prevents global variable declaration
and allows for the loader library to control when to load modules</li>
<li>AMD allows you to speficy the string identifier for your module
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// definition for a module with id moduleA, moduleA depends on moduleB,</span></span><br><span class="line"><span class="comment">// which will be loaded asynchronously</span></span><br><span class="line">define(<span class="string">&quot;moduleA&quot;</span>, [<span class="string">&quot;moduleB&quot;</span>], <span class="function"><span class="keyword">function</span>(<span class="params">moduleB</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">      stuff: moduleB.doStuff();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>AMD also supports the require and exports objects, which allow for
construction of CommonJs style modules inside an AMD moduel factory
function</li>
</ul></li>
<li>Universal Module Definition (UMD)
<ul>
<li>The UMD module system was introduced to create module that could be
used by both the CommonJS and the AMD module systems</li>
<li>The UMD pattern defines module in a way that detects which module
system is being used upon startup, configures it as appropriate, and
wraps the whole thing in an immediately invoked function expression</li>
</ul></li>
<li>Module loader deprecation
<ul>
<li>The above module systems will become increasingly obsolete as
support broadens for the ECMAScript 6 module specification</li>
<li>The intense conflict between CommonJS and AMD cultivated the
ECMAScript 6 module specification that we now enjoy</li>
</ul></li>
</ul></li>
<li>Working with ES6 modules
<ul>
<li>ES6 module specification is simpler than its predecessor module
loaders, and native browser support means that loader libraries and
other preprocessing is not necessary</li>
<li>Module taggin and definition
<ul>
<li>Modules in ES6 exist as a monolithic chunk of JavaScript, a script
tage with type="module" will signal to the browser that the associate
code should be executed as a module, as apposed to execution as
traditional script <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// inline module</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span>&gt;</span> </span><br><span class="line"><span class="javascript">  <span class="comment">// module code goes here</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">// external module file</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./myModule.js&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>Downloading a module file begins immediately after the module script
tag is parsed, but execution is delayed until the document is completely
parsed</li>
<li>The order in which module script tag appears on the page is the
order in which it will be executed <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// executes 3rd</span></span><br><span class="line">&lt;script type=<span class="string">&quot;module&quot;</span> src=<span class="string">&quot;./myModule1.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"><span class="comment">// executes 4th</span></span><br><span class="line">&lt;script type=<span class="string">&quot;module&quot;</span> src=<span class="string">&quot;./myModule2.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"><span class="comment">// executes 1st</span></span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span> src=<span class="string">&quot;./jsFile1.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"><span class="comment">// executes 2nd</span></span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span> src=<span class="string">&quot;./jsFile2.js&quot;</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure></li>
<li>ES 6 modules associated with a
<code>&lt;script type="module"&gt;</code> tag are considered to be the
entry module for a module graph. There are no restrictions as how many
entry modules there can be on a page, and there is no limit to overlap
of modules. No matter how many times a module is loaded in a page,
irrespective of how that load occurs, it will only ever load a single
time</li>
</ul></li>
<li>Module loading
<ul>
<li>ES 6 modules are unique in theri ability to be loaded both natively
by the browser as well as in conjunction with third-party loaders and
build tools</li>
<li>A browser that supports ES6 modules will load the entire dependency
graph from a top-level module, and it will do so asynchronously</li>
</ul></li>
<li>Module behavior
<ul>
<li>Best features from CommonJS and AMD:
<ul>
<li>Module code is only executed when it is loaded</li>
<li>A moddule will only ever be loaded a single time</li>
<li>Modules are singletons</li>
<li>Module can define a public interface with which other modules can
observe and interact</li>
<li>Modules can request that other modules be loaded</li>
<li>Circular dependencies are supported</li>
</ul></li>
<li>New features introduced in ES6
<ul>
<li>Modules by default execute in strict mode</li>
<li>Modules do not share a global namespace</li>
<li>The value of <code>this</code> at top-level of a module is
undefined, as opposed to the <code>window</code> object in normal
scripts</li>
<li><code>var</code> declarations will not be added to the
<code>window</code> object</li>
<li>Modules are loaded and executed asynchronously</li>
</ul></li>
</ul></li>
<li>Module exports
<ul>
<li>Modules can use exports from other modules using the
<code>import</code> keyword, import must appear in the top level of a
module</li>
<li>A module identifier can be either the relative path to that module
file from the current module or the absolute path to that module file
form the base path</li>
<li>Imports are treated as read-only views to the module, effectively
the same as const-declared variables <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// moduleA.js</span></span><br><span class="line"><span class="keyword">const</span> foo = <span class="string">&quot;foo&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> bar = <span class="string">&quot;bar&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> baz = <span class="string">&quot;baz&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> &#123;foo, bar, baz&#125;;</span><br><span class="line"><span class="comment">// moduleB.js</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> Foo <span class="keyword">from</span> <span class="string">&quot;./moduleA&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(Foo.foo); <span class="comment">// &quot;foo&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(Foo.bar); <span class="comment">// &quot;bar&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(Foo.baz); <span class="comment">// &quot;baz&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// moduleC.js</span></span><br><span class="line"><span class="keyword">import</span>  &#123; foo, bar, baz <span class="keyword">as</span> myBaz&#125; <span class="keyword">from</span> <span class="string">&quot;./moduleA&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(foo); <span class="comment">// &quot;foo&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(bar); <span class="comment">// &quot;bar&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(myBaz); <span class="comment">// &quot;baz&quot;</span></span><br></pre></td></tr></table></figure></li>
<li>Module passthrough exports
<ul>
<li>Imported values can be piped directly through to an export
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// moduleA.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> foo = <span class="string">&quot;foo&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// moduleB.js</span></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./moduleA&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> foo = <span class="string">&quot;baz&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// moduleC.js</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> Foo <span class="keyword">from</span> <span class="string">&quot;./moduleB&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(Foo.foo); <span class="comment">// &quot;baz&quot;</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Worker modules: ES 6 modules are fully compatible with Worker
instances</li>
</ul></li>
</ul></li>
</ol>
<h1 id="workers">Workers</h1>
<ol type="1">
<li>Introduction to workers
<ul>
<li>A single JavaScript environment is essentially a virtualized
environment running inside the host operating system, each open page in
a browsers is allocated its own environment. Each page has its own
memory, event loop, DOM, and so on. The environments of differeng pageas
are in parallel</li>
<li>Using workers, browsers are able to allocate a second child
environment that is totally separated from the original page
environment. The child environment is prevented from interacting with
single-thread-dependent constructs such as the DOM, but is otherwise
free to execute code in parallel with the parent environment</li>
<li>Workers and threads
<ul>
<li>Similarities
<ul>
<li>Workers are implemented as actual threads</li>
<li>Workers execute in parallel</li>
<li>Workers can share some memory: workers are able to use a
SharedArrayBuffer to share memory between multiple environments</li>
</ul></li>
<li>Difference
<ul>
<li>Workers do not share all memory</li>
<li>Worker threads are not essentially part of the same process</li>
<li>Worker threads are more expensive to create</li>
</ul></li>
</ul></li>
<li>Types of workers
<ul>
<li>Dedicated web worker: aka dedicated worker, web worker, or just
worker, can only be accessed by the page that spawned it</li>
<li>Shared web worker: similar to a dedicated web worker, but can be
accessed across multiple contexts</li>
<li>Service worker: different from a dedicated web worker or a shared
web worker, the primary purpose of a service worker is to act as a
network request arbiter capable of intercepting, redirecting, and
modifying requests dispatched by the page</li>
</ul></li>
<li>The <code>WorkerGlobalScope</code>
<ul>
<li>On a web page, the window object exposes a suite of global
variables. Inside a worker, its global object is an instance of
WorkerGlobalScope, which can be accessed using the <code>self</code>
keyword</li>
<li>Properties and methods
<ul>
<li><code>navigator</code>: returns the <code>WorkerNavigator</code>
object</li>
<li><code>self</code>: returns the <code>WorkerGlobalScope</code>
object</li>
<li><code>location</code>: returns the <code>WorkerLocation</code>
object</li>
<li><code>performance</code>: returns a <code>Performance</code>
object</li>
<li><code>console</code>: returns the <code>Console</code> object</li>
<li><code>caches</code>: returns the <code>CacheStorage</code>
object</li>
<li><code>indexDb</code>: returns an <code>IDBFactory</code> object</li>
<li><code>isSecureContext</code>: returns a boolean indicating whether
the context of the window is secure</li>
<li><code>origin</code>: returns the origin of the
<code>WorkerGlobalScope</code> object</li>
<li>Methods with the same name and function on window:
<code>atob()</code>, <code>btoa()</code>, <code>clearInterval()</code>,
<code>clearTimeout</code>, <code>createImageBitmap()</code>,
<code>fetch()</code>, <code>setInterval()</code>,
<code>setTimeout()</code></li>
</ul></li>
<li>Subclasses
<ul>
<li>A dedicated worker uses a
<code>DedicatedWorkerGlobalScope</code></li>
<li>A shared worker uses a <code>SharedWorkerGlobalScope</code></li>
<li>A service worker uses a <code>ServiceWorkerGlobalScope</code></li>
</ul></li>
</ul></li>
</ul></li>
<li>Dedicated worker basics
<ul>
<li>Dedicated workers can be described as background scripts</li>
<li>Creating a dedicated worker (the worker itself exists in a separate
JavaScript environment) <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pass a javascript file to the worker constructor to </span></span><br><span class="line"><span class="comment">// let it load the script file in the background</span></span><br><span class="line"><span class="keyword">const</span> worker = <span class="keyword">new</span> Worker(<span class="string">&quot;./emptyWorker.js&quot;</span>);</span><br></pre></td></tr></table></figure></li>
<li>Worker security restrictions: worker script files can only be loaded
from the same origin as the parent page, otherwise an error is thrown
when attempting to construct the worker</li>
<li>Using the worker object
<ul>
<li>The <code>Worker</code> object returned from the constructor is used
as the single point of communication with the newly created dedicated
worker, it can be used to transmit information between the worker and
the parent context</li>
<li>Worker object event handlers
<ul>
<li><code>onerror</code> called when an error is thrown inside the
worker</li>
<li><code>onmessage</code>: called when the worker script sends a
message back to the parent context</li>
<li><code>onmessageerror</code>: called when a message is received that
cannot be deserialized</li>
</ul></li>
<li>Worker object methods
<ul>
<li><code>postMessage()</code>: used to send information to the worker
via asynchronous message events</li>
<li><code>terminate()</code>: used to immediately terminate the worker,
no opportunity for cleanup</li>
</ul></li>
</ul></li>
<li>The DedicatedWorkerGlobalScope
<ul>
<li>The global scope inside a dedicated worker is the
DedicatedWorkerGlobalScope, this inherits from WorkerGlobalScope</li>
<li>A worker is able to access this global scope using the
<code>self</code> keyword</li>
<li>Methods and properties for the DedicatedWorkerGlobalScope instance
<ul>
<li><code>name</code>: optional string identifier</li>
<li><code>postMessage()</code>: counterpart to the <code>Worker</code>
object's <code>postMessage()</code> method</li>
<li><code>close()</code>: counterpart to the <code>Worker</code>
object's <code>terminate()</code> method</li>
<li><code>importScripts()</code>: used to import an arbitrary number of
scripts into the worker</li>
</ul></li>
</ul></li>
<li>The dedicated worker lifecycle
<ul>
<li>The <code>Worker()</code> constructor is the beginning of life for a
dedicated worker</li>
<li>Once created, a dedicated worker will last the lifetime of the page
unless explicitly terminated either via self-termination
(<code>self.close()</code>) or external
termination(<code>worker.terminate()</code>)</li>
</ul></li>
<li>Worker data transfer
<ul>
<li>In languages that wupport traditional models of multithreading, you
can use locks, mutexes, and volatile variables to transfer data between
threads. In JavaScript, you have three ways: the structured clone
algorithm, transferable objects, and shared array buffers</li>
<li>Structured clone algorithm
<ul>
<li>This algorithm can be used to share a piece of data between two
separate execution contexts</li>
<li>This algorithm is implemented by the brwoser behind the scenes, but
it cannot be invoked explicitly</li>
<li>Common JavaScript data types are supported by this algorithm</li>
<li>Once copied, changes to data in the original context will not affect
the copied data</li>
<li>Attemptying to clone an Error object, a Function object, or a DOM
node will throw an error</li>
<li>Object property descriptors, getters, setters, prototype chains are
not cloned</li>
</ul></li>
<li>Transferable objects
<ul>
<li>It is possible to transfer ownership from one context to another
using transferable objects</li>
<li>This is useful when it is impratical to copy large amounts of data
between contexts</li>
<li>Transferable data types: <code>ArrayBuffer</code>,
<code>MessagePort</code>, <code>ImageBitmap</code>,
<code>OffscreenCanvas</code></li>
</ul></li>
<li>SharedArrayBuffer
<ul>
<li>When passing a SharedArrayBuffer inside postMessage(), the browser
only passes a reference to the same block of memory, each context is
free to modify the buffer as it would with a normal ArrayBuffer</li>
<li>Sharing memory blocks between parallel threads introduces a risk of
race condition</li>
</ul></li>
</ul></li>
<li>Worker pools: because starting a worker is quite expensive, there
are situations where it is more efficient to keep a fixed number of
workers alive and dispatch work to them as necessary</li>
</ul></li>
<li>Shared workers
<ul>
<li>Two different pages on the same origin can share a single worker to
reduce computational overheads</li>
<li>Shared worker basics
<ul>
<li>Creating a shared worker <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pass a javascript file to the worker constructor to </span></span><br><span class="line"><span class="comment">// let it load the script file in the background</span></span><br><span class="line"><span class="keyword">const</span> worker = <span class="keyword">new</span> SharedWorker(<span class="string">&quot;./emptyWorker.js&quot;</span>);</span><br></pre></td></tr></table></figure></li>
<li>Shared worker identity and single occupancy
<ul>
<li>The Worker() constructor always creates a new worker instance, the
SharedWorker() constructor will only create a new worker instance if one
with the same identity does not already exist</li>
<li>Shared worker identity is derived from the resolved script URL, the
worker name, and the document origin</li>
</ul></li>
<li>Using the SharedWorker object
<ul>
<li>The <code>SharedWorker</code> object returned from the constructor
is used as the single point of communication with the newly created
shared worker, it can be used to transmit information between the worker
and the parent context via a MessagePort, as well as catch error events
emitted from the worker</li>
<li>Related properties
<ul>
<li><code>onerror</code>: called when an error is thrown inside the
worker</li>
<li><code>posrt</code>: the MessagePort for communication with the
worker</li>
</ul></li>
</ul></li>
<li>The <code>SharedWorkerGlobalScope</code>
<ul>
<li>The global scope inside a shared worker is the
SharedWorkerGlobalScope, which can be accessed using the
<code>self</code> keyword</li>
<li>Properties and methods: <code>name</code>,
<code>importScripts()</code>, <code>close()</code>,
<code>onconnect</code></li>
</ul></li>
<li>The shared worker lifecycle
<ul>
<li>A shared worker's lifecycle has the same stages and features of a
dedicated woker</li>
<li>A dedicated woker is inextricably bound to a single page, a shared
worker will persist as long as a context remains connected to it</li>
</ul></li>
</ul></li>
</ul></li>
<li>Service workers
<ul>
<li>A service worker is a type of web worker that behaves like a proxy
server inside the browser, it allows you to intercept outgoing requests
and cache the response</li>
<li>The service worker allows a web page to work without network
connectivity, as some or all of the page can potentially be served from
the service worker cache</li>
<li>Multiple pages on a single domain will all interact with a single
service worker instance</li>
<li>Two primary tasks for a service worker
<ul>
<li>Act as a chahing layer for network requests</li>
<li>Enable push notifications</li>
</ul></li>
<li>Service worker basics
<ul>
<li>The <code>ServiceWorkerContainer</code>
<ul>
<li>Service workers have no global constructor, they are managed through
the <code>navigator.serviceWorker</code> object, which is a
<code>ServiceWorkerContainer</code> object</li>
</ul></li>
<li>Creating a service worker:
<code>navigator.serviceWorker.register(filePath)</code>, this returns a
<code>Promise</code> object that resolves to a
<code>ServiceWorkerRegistration</code> object</li>
<li>Using the <code>ServiceWorkerContainer</code> object
<ul>
<li>Event handlers:
<ul>
<li><code>oncontrollerchange</code>: called when a new activated
ServiceWorkerRegistration is required</li>
<li><code>onerror</code>: called when an error is thrown inside any
associated service worker</li>
<li><code>onmessage</code>: called when the service worker script sends
a message event back to the parent context</li>
</ul></li>
<li>Properties:
<ul>
<li><code>ready</code>: returns a <code>Promise</code> object that
resolves to a <code>ServiceWorkerRegistration</code> object when the
service worker is ready to receive messages, this promise will never
reject</li>
<li><code>controller</code>: returns the activated
<code>ServiceWorker</code> object associated with the current page, or
null if there is no active service worker</li>
</ul></li>
<li>Methods
<ul>
<li><code>register(url, options)</code>: creates or updates a
<code>ServiceWorkerRegistration</code> using the provided url and
options object</li>
<li><code>getRegistration()</code>: returns a promise, which will
resolve with a <code>ServiceWorkerRegistration</code> object that
matches the provided scope, or resolve with undefined if there is no
matching service worker</li>
<li><code>getRegistrations()</code>: returns a promise, which will
resolve with an array of all <code>ServiceWorkerRegistration</code>
objects that are associated with the
<code>ServiceWorkerContainer</code>, or an empty array if there are not
associated service workers</li>
<li><code>startMessage()</code>: starts the transmission of message
dispatches via Client</li>
</ul></li>
</ul></li>
<li>Using the <code>ServiceWorkerRegistration</code> object
<ul>
<li>Event handlers
<ul>
<li><code>onupdatefound</code>: called when a new version of this
service worker begins installation</li>
</ul></li>
<li>Properties
<ul>
<li><code>scope</code>: returns the full URL path of the service
worker's scope</li>
<li><code>navigatyionPreload</code>: returns the
<code>NavigationPreloadManager</code> instance associated with this
registration object</li>
<li><code>pushManager</code>: returns the PushManager instance
associated with this registration object</li>
<li><code>installing</code>: returns the service worker with a state of
installing if there is currently one, else null</li>
<li><code>waiting</code>: returns the service worker with a state of
waiting if there is currently one</li>
<li><code>active</code>: returns the service worker with a state of
activating or active if there is currently one, else null</li>
</ul></li>
<li>Methods
<ul>
<li><code>getNotifications()</code>: returns a promise, which resolves
with an array of Notification objects</li>
<li><code>showNotifications()</code>: displays a notification
configurable with a title and options arguments</li>
<li><code>update()</code>: re-requests the service worker script
directly from the service and initiates fresh installation if the new
script differs</li>
<li><code>unregister()</code>: attempts to un-register a service worker
registration, this allows service worker execution to complete before
performing the unregistration</li>
</ul></li>
</ul></li>
<li>Using the <code>ServiceWorker</code> object
<ul>
<li>Event handlers
<ul>
<li><code>onstatechange</code>: called when the service worker changes
state</li>
</ul></li>
<li>Properties
<ul>
<li><code>state</code>: returns the current state of the service worker,
one of <code>installing</code>, <code>installed</code>,
<code>activating</code>, <code>activated</code>,
<code>redundant</code></li>
<li><code>scriptURL</code>: returns the URL of the service worker
script</li>
</ul></li>
</ul></li>
</ul></li>
<li>The service worker cache
<ul>
<li>Before service workers, web pages lacked a roubust meahcnism for
progrmatically caching network requests</li>
<li>Some features of service workers
<ul>
<li>The service worker cache does not chache any request
automatically</li>
<li>The service worker cache has no concept of time-based
expiration</li>
<li>Service worker cache entries must by manually updated and
deleted</li>
<li>Caches nust by manually versioned</li>
<li>The only browser-enfored eviction policy is based on storage
available for the service worker cache to use</li>
</ul></li>
<li>The <code>CacheStorage</code> object
<ul>
<li>The CacheStorage object is a key-value store of string keys mapping
to Cache objects, the CacheStorage object features an API that assembles
an asynchronous Map</li>
<li>Get the CacheStorage object: use the global object
<code>caches</code></li>
<li>Get the cache for a given key: <code>caches.open(key)</code>,
non-string keys are converted to a string</li>
<li>Check if a cache exists in the cache storage:
<code>caches.has(key)</code></li>
<li>Delete a cache: <code>caches.delete(key)</code></li>
</ul></li>
<li>The <code>Cache</code> object
<ul>
<li>The Cache also resembles an asynchronous Map, Cache key can either
be a URL string or a Request object, these keys will map to Response
object values</li>
<li>The service worker cache is intended to only cache GET http
requests, because the response will not change over time</li>
<li>Methods
<ul>
<li><code>put(request, response)</code>: add the key-value pair to the
cache, the key can be a URL string or a Request object, the value should
be a Response object</li>
<li><code>add(request)</code>: used when you only have the key, this
method will dispatch a fetch() to the network and cache the response.
Returns a promise, which resolves when the cache entry is successfully
added</li>
<li><code>addAll(requests)</code>: used when you wish to perform an
all-or-nothing bulk addtion to the cache</li>
<li><code>matchAll(request, options)</code>: returns a promise, which
resolves to an array of matching cache Response objects</li>
<li><code>match(request, options)</code>: returns a promise, which
resolves to a matching cache Response object, or undefined if there are
no cache hits</li>
<li><code>cache.keys()</code>, cache.delete(key), etc.</li>
</ul></li>
</ul></li>
<li>Maximum cache storage
<ul>
<li>There is no uniform specification for maximum cache storage</li>
<li>The <code>navigator.storage.estimate()</code> returns the
approximate space available and how much is currently used in bytes</li>
</ul></li>
</ul></li>
<li>Service worker clients
<ul>
<li>A service worker tracks an association with a window, worker, or
service worker with a <code>Client</code> object, sertice workers can
access the Client objects via the <code>Clients</code> interface using
the <code>self.clients</code> property</li>
<li>Client object properties and methods
<ul>
<li><code>id</code>, <code>type</code> (window, worker, sharedWorker),
<code>url</code>, <code>postMessage(msg)</code> (send a targeted
messaging to a single client)</li>
<li><code>openWindow(url)</code>: allows you to open a new window at the
specified URL, effectively adding a new Client to the service
worker</li>
<li><code>claim()</code>: forcibly set the service worker to control all
clients in its scope</li>
</ul></li>
</ul></li>
<li>Service workers and consistency
<ul>
<li>In order to enable web pages to emulate native application behavior,
service workers should support versioning</li>
<li>Two primary form of consistency
<ul>
<li>Code consistency: since web pages commonly undergo incremental
upgrades, service workers should provide an encorcement mechanism to
ensuer that all concurrently running pages on the same origin are always
built from the assets from the same version</li>
<li>Data consistency: since web I/O format may change between different
versions, service workers consistency mechanism should also ensure that
web I/O behaves identically for all concurrently running pages on the
same origin</li>
</ul></li>
</ul></li>
<li>Service worker lifecycle
<ul>
<li>There are six states a service worker might exist in:
<code>parsed</code>, <code>installing</code>, <code>installed</code>,
<code>activating</code>, <code>activated</code>, <code>redundant</code>.
A full lifecycle for a service worker will always visit these states in
this order</li>
<li>A service worker that encounters an error during installation or
activation will skip to the redundant state</li>
<li>The <code>parsed</code> state
<ul>
<li>A newly created service worker is in the parsed state</li>
<li>This state has no event or <code>ServiceWorker.state</code>
value</li>
</ul></li>
<li>The <code>installing</code> state
<ul>
<li>This state is where all service worker setup tasks should be
performed</li>
<li>If a service worker reaches this state, the
<code>ServiceWorkerRegistration</code> object will fire the
<code>updatefound</code> event</li>
<li>This state is frequently used to populate the service worker's
cache</li>
<li>If there is no error thrown or promise rejected, the service worker
proceeds to the installed state</li>
</ul></li>
<li>The <code>installed</code> (<code>waiting</code>) state: this state
means the service worker has no additional setup tasks to perform and is
prepared to assume control of clients once it is allowed to do so</li>
<li>The <code>activating</code> state
<ul>
<li>This state indicates that the service worker has been selected by
the browsers to become the service worker that should control the
page</li>
<li>While in the activating state, no functional events such as
<code>fetch</code> or <code>push</code> will be fired until the service
worker reaches the <code>activated</code> state</li>
</ul></li>
<li>The <code>activated</code> state
<ul>
<li>This state indicates that the service worker is in control of one or
many clients</li>
<li>In this state, the service state will capture fetch() events inside
its scope as well as notification and push events</li>
</ul></li>
<li>The <code>redundant</code> state: this is the graveyard for a
service worker, no events will be passed to it, and the browser is free
to destroy it and free up its resources</li>
</ul></li>
<li>Intercepting a fetch event
<ul>
<li>The interception ability of service workers is not limited to the
fetch event, but can also intercept requests for JavaScript, CSS,
images,and HTML</li>
<li>Service workers use the <code>event.respondWith()</code> method to
decide how to handle a fetch event</li>
<li>Return a response from network: a passthrough for a fetch event.
This strategy is suitable for requests that need to reach the server
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">self.onfetch = <span class="function">(<span class="params">fetchEvent</span>) =&gt;</span> &#123;</span><br><span class="line">    fetchEvent.respondWith(</span><br><span class="line">        fetch(fetchEvent.request)</span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>Return from cache: a cache check. This strategy is suitable for
requests that are guaranteed to be in the cache <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">self.onfetch = <span class="function">(<span class="params">fetchEvent</span>) =&gt;</span> &#123;</span><br><span class="line">    fetchEvent.respondWith(</span><br><span class="line">        caches.match(fetchEvent.request)</span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>Return from network with cache fallback: gives prefernence to
up-to-date responses from the network but will return values in the
cache if they exist. This stragety is suitable for finding the most
up-to-date information ASAP <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">self.onfetch = <span class="function">(<span class="params">fetchEvent</span>) =&gt;</span> &#123;</span><br><span class="line">    fetchEvent.respondWith(</span><br><span class="line">        fetch(fetchEvent.request).catch(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> caches.match(fetchEvent.request);</span><br><span class="line">        &#125;)</span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>Generic fallback: this strategy accounts for scenarios where both
the cache and network fail to produce a resource <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">self.onfetch = <span class="function">(<span class="params">fetchEvent</span>) =&gt;</span> &#123;</span><br><span class="line">    fetchEvent.respondWith(</span><br><span class="line">        caches.match(fetchEvent.request).then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> response || fetch(fetchEvent.request);</span><br><span class="line">        &#125;)</span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Push notifications
<ul>
<li>A wqeb application should be able to support push notifications,
which means it should be able to receive a push event from a server and
display a notification on the device</li>
<li>In order for push notifications to work, the service workers should
be able to display notification, handler interactions with those
notifications, subscribe to server-event push notifications, handle push
messages even when the application is not in the foreground or open</li>
<li>Displaying notifications
<ul>
<li>Service workers have access to the Notification API via their
registration object</li>
<li>Use
<code>ServiceWorkerRegistration.showNotification(title, options)</code>
to display a notification</li>
<li>Handling notification events: handle the
<code>self.onnotificationclick</code> event and
<code>self.onnotificationclose</code> event</li>
</ul></li>
<li>Subscribing to push events
<ul>
<li>The subsctiption must happen via the service worker's PushManager
object</li>
<li>Use the
<code>ServiceWorkerRegistration.pushManager.subscribe(options)</code>
method to subscribe to push events</li>
</ul></li>
<li>Handling push events
<ul>
<li>Once subscribed, the service worker will receive push events each
time the service pushes a message</li>
</ul></li>
</ul></li>
</ul></li>
</ol>
<h1 id="best-practices">Best Practices</h1>
<ol type="1">
<li>Maintainability
<ul>
<li>What is maintainable code
<ul>
<li>Understandable: someone else can pick up the code without a
walk-through by the original developer</li>
<li>Intuitive: no matter how complex the operation is, things in the
code seem to make sense</li>
<li>Adaptable: the code is written in such a way that variation in data
does not require a complete rewrite</li>
<li>Extendable: the code allows for extension of the core functionality
in the future</li>
<li>Debuggable: the code gives you enough information to identify the
issue when something goes wrong</li>
</ul></li>
<li>Code conventions
<ul>
<li>Readibility
<ul>
<li>Indentation is usually done by using foure spaces instead of by
using the tab key</li>
<li>Make comments for functions and methods, large sections of code,
complex algorithms and hacks</li>
</ul></li>
<li>Variable and function naming
<ul>
<li>Variable names should be nouns, function names should begin with a
verb</li>
<li>Use logical names for variables and functions, without worrying
about the length</li>
<li>Variables, functions, and methods should begin with a lowercase
letter and camelCase</li>
<li>Be descriptive and sensible with names</li>
</ul></li>
<li>Variable type transparency
<ul>
<li>Variables are loosely typed in JavaScript, it is easy to lose track
of the type of data that a variable should contain</li>
<li>The first solution is through initialization: initialize a variable
with a value of the correct type after declaring it</li>
<li>The second solution is to use Hungarian notation: prepend one or
more characters to the beginning of a variable to indicate the data
type. o for objects, s for strings, i for integers, b for booleans, f
for floats, etc.</li>
</ul></li>
</ul></li>
<li>Loose coupling
<ul>
<li>Whenever parts of an application depend too closely on one another,
the code becomes too tightly coupled and hard to maintain, this usually
happens when objects refer directly to one another in such a way that a
change to one always requires a change to other</li>
<li>Decouple HTML/JavaScript
<ul>
<li>JavaScript that appears inline in HTML, either using a script tag
with inline code or using HTML attributes, is too tightly coupled</li>
<li>HTML and JavaScript are also closely coupled when HTML is contained
in JavaScript, this usually happends using innerHTML to insert HTML into
the page</li>
<li>When HTML and JavaScript are too tightly coupled, interpreting an
JavaScript error means first determining whether the error occured in
the HTML portion or in the JavaScript portion, which reduces the
readbility of the code</li>
</ul></li>
<li>Decouple CSS/JavaScript
<ul>
<li>The most common example of tight coupling is using JavaScript to
change individual styles</li>
<li>Modern web applications use JavaScreipt to change styles frequently,
so it is not possible to completely decouple CSS and JavaScript, the
coupling can be made looser by changeing element class attributes
instead of individual styles</li>
</ul></li>
<li>Decouple application logic/event handlers
<ul>
<li>Rules for loose coupling of application and business logic
<ul>
<li>Do not pass event object into other methods, pass only the data from
the event object *Every action that is possible in the application
should be possible without executing an event handler</li>
<li>Event handlers should process the event and then hand off processing
to application logic</li>
</ul></li>
<li>An example <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The application logic and event handler are highly coupled</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleKeyPress</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (event.keyCode === <span class="number">13</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> target = event.target;</span><br><span class="line">        <span class="keyword">let</span> value  = <span class="number">5</span> * <span class="built_in">parseInt</span>(target.value);</span><br><span class="line">        <span class="keyword">if</span> (value &gt; <span class="number">10</span>) &#123;</span><br><span class="line">            <span class="built_in">document</span>.getElementById(<span class="string">&quot;error-msg&quot;</span>).style.display = <span class="string">&quot;black&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Code after decoupling</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validateValue</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    value = <span class="number">5</span> * <span class="built_in">parseInt</span>(value);</span><br><span class="line">    <span class="keyword">if</span> (value &gt; <span class="number">10</span>) &#123;</span><br><span class="line">        <span class="built_in">document</span>.getElementById(<span class="string">&quot;error-msg&quot;</span>).style.display = <span class="string">&quot;black&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleKeyPress</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> target = event.target;</span><br><span class="line">    validateValue(target.value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul></li>
<li>Programming practices
<ul>
<li>Respect object ownership
<ul>
<li>If you are not responsible for the creation or maintenance of an
object, its constructor, or its methods, you shouldn't be making changes
to it</li>
<li>You can create a new object with the functionality you need, and
interact with the object of interest</li>
<li>You can create a custom type that inherits from the type you want to
modify, you can modify the custom type with additional
functionality</li>
</ul></li>
<li>Avoid globals
<ul>
<li>Avoid global variables and functions whenever possible</li>
</ul></li>
<li>Avoid null comparisons
<ul>
<li>JavaScript does not do any automatic type checking, it's the
developer's responsibility</li>
<li>Checking a value against null is overused, and frequently leads to
erros due to insufficient type checking, use typeof and instanceof for
type checking</li>
</ul></li>
<li>Use constants
<ul>
<li>The goal of relying on constants is to isolate data from application
logic in such a way that it can be changed without risking the
introduction of errors</li>
<li>Repeated values, user interface strings, URLs, and any value that
may change should be stored in a constant</li>
</ul></li>
</ul></li>
</ul></li>
<li>Performance
<ul>
<li>Be scope-aware
<ul>
<li>As the number of scopes in the scope chain increases, so does the
amount of time it takes to access variables outside of the current
scope</li>
<li>It is alwasys slow to access a global variable than it is to access
a local variable</li>
<li>Avoid global lookups, avoid with statements (a with statement
creates its own scope)</li>
</ul></li>
<li>Choose the right approach
<ul>
<li>Avoid uncessary property lookup</li>
<li>Optimize loops: simplify the terminal condition, simplify the loop
body, use postest loops</li>
</ul></li>
<li>Minimize statement count
<ul>
<li>A single statement can ocmplete multiple operations faster than
multiple statements each performing a single operation</li>
<li>Multiple variable declaration should be in one statement</li>
<li>Insert iterative values <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Before</span></span><br><span class="line"><span class="keyword">let</span> name = values[i];</span><br><span class="line">i++;</span><br><span class="line"><span class="comment">// After  </span></span><br><span class="line"><span class="keyword">let</span> name = values[i++];</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li>Optimize DOM interactions
<ul>
<li>Minimize live updates</li>
<li>User innerHTML: for large amounts of updates, using innerHTML is
faster than using the standard DOM methods (like the createElementById()
method)</li>
<li>Beware of HTMLCollection: anytime you access an HTMLCollection,
whether it be a property or a method, you are performing a query on the
document, an that querying is quite expensive<br>
</li>
</ul></li>
</ul></li>
<li>Deployment
<ul>
<li>Build process
<ul>
<li>You should not pass your untouhed code to a browser for test purpose
<ul>
<li>Intellectual property issues: post source code online let others to
figure what you are doing</li>
<li>File size: source with large amount of comments is good for
maintainability but bad for performance</li>
<li>Code organization: the way you organize code for maintainability is
not necessarily the best wasy to deliver it to the browser</li>
</ul></li>
<li>File structure: spearate JavaScript files in different files</li>
<li>Task runners: a task runner with automate tasks is a good idea</li>
<li>Tree shaking
<ul>
<li>Tree shaking is an effective strategy for reducing payload size</li>
<li>Tree shaking is capable of determining which parts of the codebase
are not needed at all, and remove them from the codebase to reduce
bundle size</li>
</ul></li>
<li>Module bundlers: used to identify the landscape of JavaScript
dependencies in an application, combine them into a monolithic
application, make decition about how the modules should be organized and
concatenated, and generate the output files that will be provided to the
browser</li>
</ul></li>
<li>Validation
<ul>
<li>Checking code in the browser suffers from several issues
<ul>
<li>The validation canot be easily automated or ported from system to
system</li>
<li>Aside from syntax errors, problems are encountered only when code is
executed, leaving it possible for errors to occur</li>
</ul></li>
<li>Several tools like JSLint and ESLint are popular JavaScript
debugging tools</li>
</ul></li>
<li>Compression
<ul>
<li>File comprression involves two aspects
<ul>
<li>Code size: the number of bytes that need to be parsed by the
browser</li>
<li>Wire weight: the number of bytes that are actually transmitted from
the server to the browser</li>
</ul></li>
<li>Code minification: remove extra white space, remove all comments,
shorten variable names, function names, and other identifiers</li>
<li>JavaScript compilation: remove unused code, transform parts of code
to use more concise syntax, global inlining of function calls, constants
and variables</li>
<li>JavaScript transpilation: transpilation will allow you to wield all
the newest syntactical specification features without having to worry
about backwards browser compatibility</li>
<li>HTTP compression
<ul>
<li>All major browsers support client-side decompression or resources
that they receive</li>
<li>The srever can compress JavaScript using sever-dependent
capabilities, and include a header indicating the compression
format</li>
</ul></li>
</ul></li>
</ul></li>
</ol>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>Yanxuanshaozhu
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="https://yanxuanshaozhu.github.io/2022/05/28/JavaScript-Review/" title="JavaScript Review">https://yanxuanshaozhu.github.io/2022/05/28/JavaScript-Review/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/JavaScript/" rel="tag"># JavaScript</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/02/26/%E5%B2%A9%E6%B3%A2%E8%AC%9B%E5%BA%A7-%E6%97%A5%E6%9C%AC%E6%AD%B7%E5%8F%B2/" rel="prev" title="岩波講座 日本歷史">
      <i class="fa fa-chevron-left"></i> 岩波講座 日本歷史
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/06/07/Driver%20License%20Preparation%20in%20MA/" rel="next" title="Driver License Preparation in MA">
      Driver License Preparation in MA <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#what-is-javascript"><span class="nav-number">1.</span> <span class="nav-text">What is JavaScript</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#javascript-in-html"><span class="nav-number">2.</span> <span class="nav-text">JavaScript in HTML</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#language-basics"><span class="nav-number">3.</span> <span class="nav-text">Language Basics</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#variables-scope-and-memory"><span class="nav-number">4.</span> <span class="nav-text">Variables, Scope, and Memory</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#basic-reference-types"><span class="nav-number">5.</span> <span class="nav-text">Basic Reference Types</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#collection-reference-types"><span class="nav-number">6.</span> <span class="nav-text">Collection Reference Types</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#iterators-and-generators"><span class="nav-number">7.</span> <span class="nav-text">Iterators and generators</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#objects-classes-and-objected-oriented-programming"><span class="nav-number">8.</span> <span class="nav-text">Objects,
Classes, and Objected-Oriented Programming</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#proxies-and-reflect"><span class="nav-number">9.</span> <span class="nav-text">Proxies and Reflect</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#functions"><span class="nav-number">10.</span> <span class="nav-text">Functions</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#promises-and-async-functions"><span class="nav-number">11.</span> <span class="nav-text">Promises and Async Functions</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#the-browser-object-model"><span class="nav-number">12.</span> <span class="nav-text">The Browser Object Model</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#client-detection"><span class="nav-number">13.</span> <span class="nav-text">Client Detection</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#the-document-object-model"><span class="nav-number">14.</span> <span class="nav-text">The Document Object Model</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#dom-extensions"><span class="nav-number">15.</span> <span class="nav-text">DOM Extensions</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#dom-levels-2-and-3"><span class="nav-number">16.</span> <span class="nav-text">DOM Levels 2 and 3</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#events"><span class="nav-number">17.</span> <span class="nav-text">Events</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#animation-and-graphics-with-canvas"><span class="nav-number">18.</span> <span class="nav-text">Animation and Graphics with
Canvas</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#scripting-forms"><span class="nav-number">19.</span> <span class="nav-text">Scripting Forms</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#javascript-api"><span class="nav-number">20.</span> <span class="nav-text">JavaScript API</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#error-handling-and-debugging"><span class="nav-number">21.</span> <span class="nav-text">Error handling and Debugging</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#xml-in-javascript"><span class="nav-number">22.</span> <span class="nav-text">XML in JavaScript</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#json"><span class="nav-number">23.</span> <span class="nav-text">JSON</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#network-requests-and-remove-resources"><span class="nav-number">24.</span> <span class="nav-text">Network Requests and
Remove Resources</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#client-side-storage"><span class="nav-number">25.</span> <span class="nav-text">Client-Side Storage</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#modules"><span class="nav-number">26.</span> <span class="nav-text">Modules</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#workers"><span class="nav-number">27.</span> <span class="nav-text">Workers</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#best-practices"><span class="nav-number">28.</span> <span class="nav-text">Best Practices</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Yanxuanshaozhu"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Yanxuanshaozhu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">59</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">54</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/yanxuanshaozhu" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yanxuanshaozhu" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:mrlixm.cn@gmail.com" title="E-Mail → mailto:mrlixm.cn@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2026</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yanxuanshaozhu</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="Symbols count total">1.8m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">26:42</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

</body>
</html>
